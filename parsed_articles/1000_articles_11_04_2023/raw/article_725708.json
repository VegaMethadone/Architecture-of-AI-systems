{
    "article_id": "725708",
    "article_name": "Сравнение рейтинговых систем Эло и RTTF (или шахматисты против теннисистов)",
    "content": "В Батуми, где я обитаю последние 2 года, очень популярен настольный теннис. Субтропический климат способствует тому, что теннисные столы стоят прямо на бульваре, являясь точкой привлечения как проходящих мимо туристов, так и местных.\nФото носит иллюстративный характер\nОднако у массовости и популярности есть своя отрицательная сторона: в итоге становится сложно найти себе соперника «по руке», чтоб обоим было интересно играть. Мы пробовали разные способы: описывали свои навыки, использовали разные системы оценок, характеризуя свой уровень… Увы, начинающие склонны себя перехваливать, а опытные игроки – недооценивать.\nВы же помните про эффект Даннинга-Крюгера?\nВ итоге возникла идея создания \nрейтингового бота\n, благо API Telegram предоставляет широкие возможности для этого.\nВ этой статье я не буду рассказывать про особенности технической реализации. Если появится интерес, потом могу отдельно расписать. Хочу рассказать про то, как пытался вначале «натянуть на глобус» \nрейтинговую систему \nRTTF\n \n(она же \nTTW\n, с минимальными отличиями), а в итоге взял на вооружение \nсистему Эло\n, которая используется в шахматах.\nПостановка задачи\nЦель для бота была простая: сделать \nвозможность расчёта рейтинга при регистрации обычных уличных игр\n, а не только официальных турниров. Т.е. договорился с кем-нибудь поиграть на рейтинг, зарегистрировал результат игры – получил рейтинг.\nПервые попытки\nВначале не было сомнений в том, чтоб использовать популярные и проверенные временем формулы. \nФормула RTTF\n среди остальных вариантов (TTW, \nФНТР\n) показалась самой продуманной, поэтому именно её начал обкатывать на тестовых сценариях. И буквально сразу столкнулся с определённым сложностями, после которых едва не опустил руки:\nФормула RTTF подразумевает \nтурнирный формат\n. Т.е. серия матчей до 2-3 побед. Ничьей быть не может. В то время как «на улице» играют, как придётся. Могут и сериями, а могут и 15:3 выдать. Или ничью.\nНачальный рейтинг новичкам выставляется \nвручную\n организатором турнира. Нам же \nнужна полная автономность\n.\nФормула RTTF хорошо работает только для игроков \nпримерно одного уровня\n. Если разница в рейтинге победителя и проигравшего составляет более 100 очков (один спортивный разряд), то рейтинг не меняется. В результате, если игроки разных уровней играют вместе, рейтинг может застрять на одном уровне.\nВ итоге пришлось отказаться от классического варианта и искать что-то другое. А именно -- \nрейтинг Эло\n, который давно и относительно успешно используется в шахматах. \nОтносительно – потому что там тоже пришлось использовать определённые костыли для борьбы с накруткой.\n Тем не менее этот рейтинг больше приспособлен для расчёта рейтинга по парным встречам, нежели рейтинги RTTF-подобной формулы.\nНиже я приведу основные тестовые сценарии для понимания разницы между этими рейтинговыми системами. Если кто готов поверить мне на слово, можете сразу перейти к \n\"Окончательному выводу\"\n в конце статьи.\nСценарий: Ничья\nВ турнире такая ситуация невозможна, на улице же встречается нередко (когда играют, ограничиваясь доступным временем, или когда при почти равной игре предлагают сыграть «самую последнюю, самую решающую партию»).\nЕсли бы мы использовали рейтинг RTTF, то разумнее всего было бы вернуть 0 прироста рейтинга, потому что эта формула вообще не учитывает подобные варианты. В то время как Эло легко справляется с подобными случаями без всяких дополнительных костылей.\nИгрок 1, рейтинг 1400 (соответствует 3-му разряду)\nИгрок 2, рейтинг 1800 (соответствует 1-му разряду)\nСчёт 1:1\nРезультат:\nИгрок 1, рейтинг 1416 [+16]\nИгрок 2, рейтинг 1784 [-16]\nАнализ\nОбратите внимание на момент, который всегда возмущал (и будет возмущать) игроков, привыкших к RTTF-подобной рейтинговой системе: два игрока сыграли с \nравным \nрезультатом, однако один из них в итоге \nпотерял\n очки рейтинга. \nХуже того, забегая вперёд, скажу, что потерять очки рейтинга можно, даже выиграв. :)\nнаглядные страдания КМС\nТем не менее в этом есть логика: если перворазрядник не смог \nуверенно\n обыграть третьеразрядника, то действительно ли он на своём месте в рейтинге? Эло корректирует рейтинг обоих игроков \nв зависимости от результата игры\n. За счёт этого рейтинг по Эло можно считать гораздо более точным, нежели RTTF-подобный рейтинг, где неважно, как именно ты выиграл, главное, что выиграл.\nВывод\nНа «улице» ничья – нередкий результат дружеских встреч. В отличие от Эло, \nRTTF такие результаты считать\n \nне умеет\n.\nСценарий: Одиночные игры, разница в 1 разряд\nПроверять будем на игроках с рейтингом 1600 Эло (соответствует 450 RTTF) и 1400 Эло (350 RTTF). Это как раз границы третьего разряда, т.е. \nиграет начинающий второй разряд с начинающим третьим\n.\nСчёт\nЭло\nRTTF\nКомментарий\n1:0\n1602 (+2) : 1398 (-2)\n450 (0) : 350 (0)\n \n2:0\n1605 (+5) : 1395 (-5)\n450 (0) : 350 (0)\n \n3:0\n1607 (+7) : 1393 (-7)\n450 (0) : 350 (0)\n \n4:0\n1609 (+9) : 1391 (-9)\n450 (0) : 350 (0)\n \n5:0\n1612 (+12) : 1388 (-12)\n450 (0) : 350 (0)\n \n3:1\n1600 (0) : 1400 (0)\n450 (0) : 350 (0)\nЭло: ожидаемый результат встречи, нет изменения рейтинга\n3:2\n1592 (-8) : 1408 (+8)\n450 (0) : 350 (0)\nЭло: слабый игрок взял больше сетов, чем прогнозировалось – прирост рейтинга\nАнализ\nВ RTTF всё просто: разница между игроками составляет 100 очков, \nприроста рейтинга нет.\n К слову сказать, при 99 очках разницы никакого заметного изменения рейтинга тоже не будет.\nВ Эло, как можно видеть, есть изменение рейтинга в зависимости от счёта. Нужно ещё отметить два любопытных момента:\nпри счёте 3:1 изменения рейтинга нет, потому что это \nожидаемый результат встречи\n игроков с такой разницей уровня;\nпри счёте 3:2 более сильный игрок, несмотря на итоговую победу, \nтеряет рейтинг\n. Потому что либо он играл хуже, чем ожидалось, либо его соперник играл лучше, чем ожидалось от его уровня.\nВывод\nПри игре с заведомо сильным или слабым соперником RTTF-подобный рейтинг меняться не будет. Для него нужны игроки примерно равного уровня, что реально при организации турниров, но слабо применимо в обычных встречах.\nВ то же время как Эло не только откорректирует рейтинг по результатам встречи, но ещё и \nзаставит более сильного игрока играть всерьёз\n, чтоб не потерять рейтинг из‑за самоуверенности в случае слива случайного сета.\nмастер спорта может много рассказать о том, почему не стоит давать фору при игре на рейтинг\nСценарий: Одиночные игры, разница в ½ разряда\nУчитывая особенности RTTF формулы, попробуем сравнить игроков в пределах одного разряда. Пусть это будет рейтингом 1500 Эло (соответствует 400 RTTF) и 1400 Эло (350 RTTF), \nсильный третий разряд с начинающим третьим разрядом\n.\nСчёт\nЭло\nRTTF\nКомментарий\n1:0\n1504 (+4) : 1396 (-4)\n401,2 (+1,2) : 349,4 (-0,6)\n \n2:0\n1507 (+7) : 1393 (-7)\n401,5 (+1,5) : 349,25 (-0,75)\n \n3:0\n1511 (+11) : 1389 (-11)\n401,8 (+1,8) : 349,1 (-0,9)\nМаксимальный прирост относительно разряда: 1,8% RTTF, 5,5% Эло\n4:0\n1514 (+14) : 1386 (-14)\n401,8 (+1,8) : 349,1 (-0,9)\n \n5:0\n1517 (+17) : 1383 (-17)\n401,8 (+1,8) : 349,1 (-0,9)\n \n3:1\n1504 (+4) : 1396 (-4)\n401,5 (+1,5) : 349,25 (-0,75)\n \n3:2\n1498 (-2) : 1402 (+2)\n401,2 (+1,2) : 349,4 (-0,6)\n \n0:1\n1494 (-6) : 1406 (+6)\n398,2 (-1,8) : 353,6 (+3,6)\n \n0:2\n1487 (-13) : 1413 (+13)\n397,75 (-2,25) : 354,5 (+4,5)\n \n0:3\n1481 (-19) : 1419 (+19)\n397,3 (-2,7) : 355,4 (+5,4)\nМаксимальный прирост относительно разряда: 5,4% RTTF, 9,5% Эло\nАнализ\nПреимущество RTTF формулы над ФНТР или TTW в том, что она учитывает разницу в сетах, что заметно по первым трём играм в таблице. Однако дальше рост не идёт, подразумевается, что вместо 4:0 должны регистрироваться две игры со счётом 2:0, 2:0. Как правильно сделать такое разбиение при регистрации «уличного» счёта – непонятно. К примеру, счёт 4:2 ведь можно разложить как 2:1, 2:1, так и 2:0, 2:0, 0:2.\nЕщё можно отметить более активное изменение рейтинга Эло. Впрочем, непонятно, хорошо это или плохо, в любом случае это легко можно откорректировать коэффициентами.\nВывод\nСказать, что какая-то формула тут проявила себя лучше, нельзя. Каждая по-своему хороша.\nСценарий: Читер против обычного игрока\nПришла пора перейти к анализу ситуаций с возможным читерством. От этого никуда не деться и, хотя бот сейчас отказывается работать в чатах, где меньше 20 участников, тем не менее вполне реально возникновение игрока, который на фейковых аккаунтах накрутит себе рейтинг уровня мастера спорта.\nочень хотел вставить эту картинку хоть куда-нибудь в статью\nДавайте проверим, что такой игрок сможет продемонстрировать при встрече с реальным соперником, который его обыграет со счётом, скажем, 3:0. Пусть у читера будет рейтинг 2000 Эло (750 RTTF), а у обычного игрока рейтинг 1200 (250).\nКоличество встреч\nЭло\nRTTF\n1\n1955 (-45) : 1249 (+49)\n737,4 (-12,6) : 275,2 (+25,2)\n2\n1910 (-90) : 1298 (+98)\n725,2 (-24,8) : 298,6 (+48,6)\n3\n1865 (-135) : 1346 (+146)\n713,9 (-36,1) : 320,1 (+70,1)\n5\n1776 (-224) : 1437 (+237)\n692,3 (-57,7) : 359,4 (+109,4)\n10\n1613 (-387) : 1600 (+400)\n650 (-100) : 437 (+187)\nАналогично посмотрим на результаты встреч с таким же уровнем: «КМС» против настоящего КМС.\nКоличество встреч\nЭло\nRTTF\n1\n1985 (-15) : 2015 (+15)\n747,6 (-2,4) : 754,8 (+4,8)\n2\n1972 (-28) : 2028 (+28)\n744,8 (-5,2) : 758,5 (+3,5)\n3\n1960 (-40) : 2040 (+40)\n741,9 (-8,1) : 762,1 (+12,1)\n5\n1938 (-62) : 2062 (+62)\n737,2 (-12,8) : 768,6 (+18,6)\n10\n1896 (-104) : 2104 (+104)\n727,8 (-22,2) : 780,4 (+30,4)\nАнализ\nВ обоих случаях результаты почти идентичны. Да, Эло быстрее скорректировала рейтинг, но это легко меняется соответствующими коэффициентами.\nВывод\nОбе формулы хорошо отработали варианты встречи читера и обычного игрока. Сколько бы фейковых побед ты не зарегистрировал, встреча с живыми игроками быстро всё поставит на место, буквально за один турнир.\nОкончательный вывод\nПри одинаковых уровнях (в пределах одного спортивного разряда) обе формулы ведут себя хорошо, показывают схожие результаты. Однако дальше у RTTF начинаются минусы:\n1.       \nСтрогая привязка к турнирному формату\n – необходимо место, время, люди.\n2.       \nБесполезность при игре разных уровней\n (отличающихся на разряд и больше).\n3.       Затруднительно автоматически выставить \nначальный рейтинг\n (посев).\n4.       Сложности с пересчётом рейтинга по \nпроизвольному счёту, включая ничью\n (3:12, 5:5).\nВердикт: \nшахматисты победили теннисистов\n. :) \nЧерез 3 месяца использования. А сколько критики было поначалу...\nP. S.\n Бот для настольного тенниса: \n@tt_rating_bot\n, аббревиатура рейтинга \nTTAR\n. За короткое время существования (меньше года в разработке) и без какого‑либо внятного продвижения в нём уже зарегистрировано больше 4000 игр.\nБот для тенниса (большого): \n@TennisRatingBot\n (\nTAR\n), пока им никто не пользуется.\nБот для шахматного рейтинга: \n@chess_rating_bot\n. Необходимость сомнительна, делал по просьбе одного гроссмейстера.\n \n ",
    "tags": [
        "рейтинговая система",
        "боты",
        "telegram",
        "эло",
        "elo",
        "RTTF"
    ]
}