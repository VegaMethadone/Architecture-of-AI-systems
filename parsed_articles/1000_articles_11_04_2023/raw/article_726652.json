{
    "article_id": "726652",
    "article_name": "–°–æ–∑–¥–∞–µ–º —á–∞—Ç-–±–æ—Ç –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ MobileNetV2",
    "content": "–ê–≤—Ç–æ—Ä —Å—Ç–∞—Ç—å–∏: –í–∏–∫—Ç–æ—Ä–∏—è –õ—è–ª–∏–∫–æ–≤–∞\n–í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! –°–µ–≥–æ–¥–Ω—è —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ä–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–æ–π –∫–ª–∞—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞—Ç–∞—Å–µ—Ç–∞ –æ–≤–æ—â–µ–π –∏ —Ñ—Ä—É–∫—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é —Å–≤–µ—Ä—Ç–æ—á–Ω–æ–π –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã MobileNetV2. –ê –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –µ—â–µ —Å–æ–∑–¥–∞–¥–∏–º —á–∞—Ç-–±–æ—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.\n–°–µ–≥–æ–¥–Ω—è —É–∂–µ –Ω–∏–∫–æ–≥–æ –Ω–µ —É–¥–∏–≤–∏—à—å —á–∞—Ç-–±–æ—Ç–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –≤–µ—Å—Ç–∏ –¥–∏–∞–ª–æ–≥–∏ –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —è–∑—ã–∫–µ. –í –Ω–∞—à–∏ –¥–Ω–∏ —É–∂–µ –¥–∞–∂–µ —à–∫–æ–ª—å–Ω–∏–∫–æ–≤ —É—á–∞—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–∏—Ö —á–∞—Ç –±–æ—Ç–æ–≤. –ê –ø–æ—á–µ–º—É –±—ã —Ç–æ–≥–¥–∞ –Ω–µ —Å–æ–∑–¥–∞—Ç—å –±–æ—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–∫–∞ —Å–∞–º–æ–≥–æ –ø—Ä–æ—Å—Ç–æ–≥–æ¬† –±–æ—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ñ–æ—Ç–æ –∏ –æ—Ç–≤–µ—á–∞—Ç—å, —á—Ç–æ –Ω–∞ –Ω–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–æ.¬†\n–ü–æ—Å–ª–µ –ø–æ–∏—Å–∫–æ–≤ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (—Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ü–≤–µ—Ç–æ–≤, –∂–∏–≤–æ—Ç–Ω—ã—Ö, —Ç–∏–ø–∞ —Ä–∞–∫–æ–≤—ã—Ö –æ–ø—É—Ö–æ–ª–µ–π –∏ —Ç.–¥.), —è –æ—Å—Ç–∞–Ω–æ–≤–∏–ª–∞ —Å–≤–æ–π –≤—ã–±–æ—Ä –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç–µ, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ñ—Ä—É–∫—Ç–æ–≤ –∏ –æ–≤–æ—â–µ–π, —Å–æ—Å—Ç–æ—è—â–∏–π –∏–∑ 36 –∫–ª–∞—Å—Å–æ–≤. –ü—Ä–∏ –¥–∞–ª—å–Ω–µ–π—à–µ–π –¥–æ—Ä–∞–±–æ—Ç–∫–µ, —Ç–∞–∫–æ–≥–æ –±–æ—Ç–∞ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ä–µ—Ü–µ–ø—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.\n–î–∞—Ç–∞—Å–µ—Ç ‚ÄúFruits and Vegetables Image Recognition‚Äù –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ \nKaggle.com\n –∏ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 3825 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–∞–∫–∏—Ö —Ñ—Ä—É–∫—Ç–æ–≤ –∏ –æ–≤–æ—â–µ–π –∫–∞–∫ –±–∞–Ω–∞–Ω, —è–±–ª–æ–∫–æ, –≥—Ä—É—à–∞, –≤–∏–Ω–æ–≥—Ä–∞–¥, –∞–ø–µ–ª—å—Å–∏–Ω, –∫–∏–≤–∏, –∞—Ä–±—É–∑, –≥—Ä–∞–Ω–∞—Ç, –∞–Ω–∞–Ω–∞—Å, –º–∞–Ω–≥–æ, –æ–≥—É—Ä—Ü—ã, –º–æ—Ä–∫–æ–≤—å, —Å—Ç—Ä—É—á–∫–æ–≤—ã–π –ø–µ—Ä–µ—Ü, –ª—É–∫, –∫–∞—Ä—Ç–æ—Ñ–µ–ª—å, –ª–∏–º–æ–Ω, –ø–æ–º–∏–¥–æ—Ä—ã, —Ä–µ–¥—å–∫–∞, —Å–≤–µ–∫–ª–∞, –∫–∞–ø—É—Å—Ç–∞, —Å–∞–ª–∞—Ç, —à–ø–∏–Ω–∞—Ç, —Å–æ–µ–≤—ã–µ –±–æ–±—ã, —Ü–≤–µ—Ç–Ω–∞—è –∫–∞–ø—É—Å—Ç–∞, –±–æ–ª–≥–∞—Ä—Å–∫–∏–π –ø–µ—Ä–µ—Ü, –ø–µ—Ä–µ—Ü —á–∏–ª–∏, —Ä–µ–ø–∞, –∫—É–∫—É—Ä—É–∑–∞, —Å–ª–∞–¥–∫–∞—è –∫—É–∫—É—Ä—É–∑–∞, —Å–ª–∞–¥–∫–∏–π –∫–∞—Ä—Ç–æ—Ñ–µ–ª—å, –ø–∞–ø—Ä–∏–∫–∞, —Ö–∞–ª–∞–ø–µ–Ω—å–æ, –∏–º–±–∏—Ä—å, —á–µ—Å–Ω–æ–∫, –≥–æ—Ä–æ—Ö, –±–∞–∫–ª–∞–∂–∞–Ω. –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –ø–æ 100 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, –ø–æ 10 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ –ø–æ 10 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –ø–∞–ø–∫–∞—Ö –Ω–µ–º–Ω–æ–≥–æ –º–µ–Ω—å—à–µ).\n–ü—Ä–∏—Å—Ç—É–ø–∞–µ–º –∫ —Ä–µ—à–µ–Ω–∏—é –∑–∞–¥–∞—á–∏ –º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏. –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏,¬† –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—É—Ç–∏ –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.\nimport cv2\nimport pathlib\nimport tensorflow as tf\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom tensorflow.keras.layers import Dense\nfrom tensorflow.keras.models import Model\nfrom tensorflow.keras.callbacks import Callback, ModelCheckpoint,EarlyStopping, ReduceLROnPlateau\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator\nfrom keras.applications.mobilenet_v2 import MobileNetV2\nfrom tensorflow.keras.applications import mobilenet_v2\nfrom tensorflow.keras import layers\n\n# –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –æ–±—É—á–µ–Ω–∏—è\ntrain_dir = pathlib.Path(\"***/datasets/fruits1/train/\")\n# –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è\ntest_dir = pathlib.Path(\"***/datasets/fruits1/test/\")\n# –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏\nval_dir = pathlib.Path(\"***/datasets/fruits1/validation/\")\nimg_height = 224\nimg_weigth = 224\n–ó–∞–≥—Ä—É–∂–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –±—É–¥–µ–º —Å –ø–æ–º–æ—â—å—é –ø–æ–ª–µ–∑–Ω–æ–π —É—Ç–∏–ª–∏—Ç—ã \nimage_dataset_from_directory\n –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ \nkeras.preprocessing\n (–≤–µ—Ä–Ω–µ—Ç \ntf.data.Dataset\n), –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–∞–∫–µ—Ç—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ –ø–æ–¥–∫–∞—Ç–∞–ª–æ–≥–æ–≤ –≤–º–µ—Å—Ç–µ —Å –º–µ—Ç–∫–∞–º–∏ –∫–ª–∞—Å—Å–æ–≤. –°–æ—Ö—Ä–∞–Ω–∏–º –≤—Å–µ –∫–ª–∞—Å—Å—ã –æ–≤–æ—â–µ–π –∏ —Ñ—Ä—É–∫—Ç–æ–≤ –≤ —Å–ø–∏—Å–∫–µ \nclass_names\n.\ntrain_ds = tf.keras.utils.image_dataset_from_directory(train_dir)\ntest_ds = tf.keras.utils.image_dataset_from_directory(test_dir)\nval_ds = tf.keras.utils.image_dataset_from_directory(val_dir)\nclass_names = dict(zip(train_ds.class_names, range(len(train_ds.class_names))))\nnum_classes = len(class_names)\n–í—Å–µ–≥–æ 36 –∫–ª–∞—Å—Å–æ–≤. –ü–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è\n–î–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–æ –ø–æ–¥—Ö–æ–¥—è—Ç —Å–≤–µ—Ä—Ç–æ—á–Ω—ã–µ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏, –ø–æ—ç—Ç–æ–º—É –∑–∞ –æ—Å–Ω–æ–≤—É –≤–æ–∑—å–º–µ–º MobilenetV2, –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—É—é –Ω–∞ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ –±–∞–∑—ã ImageNet. MobileNetV2 —è–≤–ª—è–µ—Ç—Å—è –æ–±–ª–µ–≥—á–µ–Ω–Ω–æ–π –≥–ª—É–±–æ–∫–æ–π –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç—å—é, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–≤–µ—Ä—Ç–æ—á–Ω—ã–µ –±–ª–æ–∫–∏ –≥–ª—É–±–∏–Ω–æ–π 53 —Å–ª–æ—è.\n–°–µ—Ç—å –∏–º–µ–µ—Ç 2 —Ç–∏–ø–∞ –±–ª–æ–∫–æ–≤: –æ–¥–∏–Ω –æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π –±–ª–æ–∫ —Å —à–∞–≥–æ–º 1 (–Ω–∞ —Ä–∏—Å—É–Ω–∫–µ —Å–ª–µ–≤–∞), –¥—Ä—É–≥–æ–π –±–ª–æ–∫ —Å —à–∞–≥–æ–º 2 –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ (–Ω–∞ —Ä–∏—Å—É–Ω–∫–µ —Å–ø—Ä–∞–≤–∞).¬†\n–ö–∞–∂–¥—ã–π –±–ª–æ–∫ –∏–º–µ–µ—Ç 3 —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–ª–æ—è:\n–°–≤–µ—Ä—Ç–∫–∞ 1—Ö1 –∏–º–µ–µ—Ç –∞–∫—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é Relu6 (f(s)=max(0,6))\n–ì–ª—É–±–∏–Ω–Ω–∞—è —Å–≤–µ—Ä—Ç–∫–∞\n–°–≤–µ—Ä—Ç–∫–∞ 1—Ö1 –±–µ–∑ –ª–∏–Ω–µ–π–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏\n–ü–µ—Ä–µ–¥ —Ç–µ–º, –∫–∞–∫ –∑–∞–≥—Ä—É–∂–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –Ω–∞—à—É –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—É—é –Ω–µ–π—Ä–æ–Ω–Ω—É—é —Å–µ—Ç—å, –∏—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–∞—à–∞ –º–æ–¥–µ–ª—å, —Ç–æ –µ—Å—Ç—å –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –≤ —Ç–µ–Ω–∑–æ—Ä—ã —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π, –∞ –∑–∞—Ç–µ–º –ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –æ—Ç 0 –¥–æ 255 –∫ –∏–Ω—Ç–µ—Ä–≤–∞–ª—É –æ—Ç 0 –¥–æ 1.–≠—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–ª–∞—Å—Å–∞ ImageDataGenerator. –î–∞–Ω–Ω—ã–π –∫–ª–∞—Å—Å —É–¥–æ–±–µ–Ω –∏ –ø–æ–ª–µ–∑–µ–Ω —Ç–µ–º, —á—Ç–æ –±–µ—Ä–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä—è–º–æ –∏–∑ –ø–∞–ø–æ–∫, –∞ —Ç–∞–∫–∂–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞—Å—à–∏—Ä–∏—Ç—å –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∑–∞ —Å—á–µ—Ç —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–ø–∏–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –∏–∑–º–µ–Ω—è—è —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (—Å–º–µ—â–µ–Ω–∏–µ, –ø–æ–≤–æ—Ä–æ—Ç, —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –∏ —Ç.–¥.). –¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏ –ª—É—á—à–µ –æ–±–æ–±—â–∞—Ç—å –∏ –∏–∑–≤–ª–µ–∫–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏. –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—É –∫–ª–∞—Å—Å–∞ –Ω–∞–±–æ—Ä —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –Ω–∞–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –æ–±–æ –≤—Å–µ–º –æ–Ω –ø–æ–∑–∞–±–æ—Ç–∏—Ç—Å—è —Å–∞–º.\ntrain_generator = ImageDataGenerator(\npreprocessing_function = mobilenet_v2.preprocess_input,\nrotation_range = 32,\nzoom_range = 0.2,\nwidth_shift_range = 0.2,\nheight_shift_range = 0.2,\nshear_range = 0.2,\nhorizontal_flip = True,\nfill_mode = \"nearest\")\n–¢–∞–∫ –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–∞—è –Ω–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å, —Ç–æ–≥–¥–∞ –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ —Ç–µ–Ω–∑–æ—Ä—ã —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–æ—Ç–æ–≤—ã–π –º–µ—Ç–æ–¥ \nmobilenet_v2.preprocess_input\n–¢–µ–ø–µ—Ä—å –≤–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è –º–µ—Ç–æ–¥–æ–º \n.flow_from_directory\n –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∫ –Ω–∞—à–∏–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º –∏–∑ –æ–±—É—á–∞—é—â–µ–≥–æ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö.¬†\ntrain = train_generator.flow_from_directory(train_dir,\ntarget_size = (img_height,img_width),\n# –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–º–µ–µ—Ç 3 —Ü–≤–µ—Ç–æ–≤—ã—Ö –∫–∞–Ω–∞–ª–∞\ncolor_mode = \"rgb\",\n# —Å–æ–∑–¥–∞–µ–º –±–∏–Ω–∞—Ä–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –º–µ—Ç–æ–∫ –∫–ª–∞—Å—Å–∞ \nclass_mode = \"categorical\",\nbatch_size = 32,\nshuffle = True,\nseed = 123)\n\nvalidation = train_generator.flow_from_directory(val_dir,\ntarget_size = (img_height,img_width),\n# –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–º–µ–µ—Ç 3 —Ü–≤–µ—Ç–æ–≤—ã—Ö –∫–∞–Ω–∞–ª–∞\ncolor_mode = \"rgb\",\n# —Å–æ–∑–¥–∞–µ–º –±–∏–Ω–∞—Ä–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –º–µ—Ç–æ–∫ –∫–ª–∞—Å—Å–∞ \nclass_mode = \"categorical\",\nbatch_size = 32,\nshuffle = True,\nseed = 123)\n–ó–¥–µ—Å—å –º–æ–∂–Ω–æ –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —É–∫–∞–∑–∞–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä shuffle = True, —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ —Ç–æ–º, —á—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤ –Ω–µ –±—É–¥—É—Ç –ø–µ—Ä–µ–º–µ—à–∏–≤–∞—Ç—å—Å—è. –°–Ω–∞—á–∞–ª–∞ –±—É–¥—É—Ç –ø–æ—Å—Ç—É–ø–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ –ø–µ—Ä–≤–æ–π –ø–∞–ø–∫–∏, –ø–æ—Ç–æ–º –∏–∑ –≤—Ç–æ—Ä–æ–π –∏ —Ç.–¥, –∞ –∑–∞—Ç–µ–º –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–π. –≠—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, —á—Ç–æ–±—ã –º—ã –º–æ–≥–ª–∏ –ø–æ—Ç–æ–º –ª–µ–≥–∫–æ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –º–µ—Ç–∫–∞–º –∫–ª–∞—Å—Å–∞.¬†\n–ü–µ—Ä–µ–π–¥–µ–º –∫ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—é –º–æ–¥–µ–ª–∏. –ó–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é —Å–µ—Ç–∏ —Å —Ä–∞–∑–º–µ—Ä–æ–º –≤—Ö–æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (224, 224, 3) —Å –≤–µ—Å–∞–º–∏ ‚Äúimagenet‚Äù.\nmobilenet_ = MobileNetV2(\ninput_shape = (img_height,img_width,3),\ninclude_top = False,\nweights = 'imagenet',\npooling = 'avg')\n–ë–ª–æ–∫–∏—Ä—É–µ–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –∏ –æ—Å—Ç–∞–≤–ª—è–µ–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±—É—á–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–º —Å–ª–æ—è–º –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏.\nmobilenet_.trainable = False\n–°–æ–∑–¥–∞–µ–º 2 –æ–±—ã—á–Ω—ã—Ö —Å–ª–æ—è —Å 128 –Ω–µ–π—Ä–æ–Ω–∞–º–∏ –∏ –æ–¥–∏–Ω –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–ª–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –Ω–µ–π—Ä–æ–Ω–æ–≤ —Ä–∞–≤–Ω—ã—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –Ω–∞–º –∫–ª–∞—Å—Å–æ–≤ –∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π \nsoftmax\ninputs = mobilenet_.input\nx = Dense(128, activation = 'relu')(mobilenet_.output)\nx = Dense(128, activation = 'relu')(x)\noutputs = Dense(num_classes , activation = 'softmax')(x)\n–°–æ–±–∏—Ä–∞–µ–º –º–æ–¥–µ–ª—å —Å–µ—Ç–∏,—Å–æ—Å—Ç–æ—è—â—É—é –∏–∑ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –Ω–æ–≤—ã—Ö —Å–ª–æ–µ–≤.\nmobilenet = Model(inputs = inputs, outputs = outputs)\n–ò—Å–ø–æ–ª—å–∑—É–µ–º –º–µ—Ç–æ–¥ \nModelCheckpoint\n –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–∏, –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ –ø–æ—Ç–µ—Ä—è—Ö –Ω–∞ —ç—Ç–∞–ø–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –º–µ—Ç–æ–¥ EarlyStopping –¥–ª—è —Ä–∞–Ω–Ω–µ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –æ–±—É—á–µ–Ω–∏—è\nearly_stopping = EarlyStopping(\n\tmonitor='val_loss',\n\tmode='min',\n\tpatience = 2,\n\tverbose=1,\n\trestore_best_weights=True,\n)\ncheckpoint =ModelCheckpoint('***/fruit224mobile.h5',\n                        \tmonitor = 'val_loss',\n                        \tmode = 'min',\n                       \tsave_best_only = True)\n\ncallbacks = [early_stopping, checkpoint]\n–ö–æ–º–ø–∏–ª–∏—Ä—É–µ–º –∏ –ø–æ–¥–≥–æ–Ω—è–µ–º –º–æ–¥–µ–ª—å, –∏—Å–ø–æ–ª—å–∑—É—è –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä –ê–¥–∞–º–∞ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—É—é –ø–µ—Ä–µ–∫—Ä–µ—Å—Ç–Ω—É—é —ç–Ω—Ç—Ä–æ–ø–∏—é.\nmobilenet.compile(optimizer=‚Äô‚Äô, loss ='categorical_crossentropy',metrics = ['accuracy'])\n\nhistory = mobilenet.fit(\ntrain, validation_data = validation,\nbatch_size = 32,\nepochs = 20,\ncallbacks = callbacks)\n–û—Ü–µ–Ω–∏–º –º–æ–¥–µ–ª—å –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É—è –º–µ—Ç–æ–¥ ‚Äúevaluate‚Äù\n(eval_loss, eval_accuracy) = mobilenet.evaluate(test)\n–ü–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Ç–æ—á–Ω–æ—Å—Ç—å –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö\n# –ø–æ–ª—É—á–∞–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –æ—Ç —Ç–µ—Å—Ç–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π\npred = mobilenet.predict(test)\n# –ø–æ–ª—É—á–∞–µ–º –Ω–æ–º–µ—Ä –∫–ª–∞—Å—Å–∞ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –≤–µ—Å–æ–º\npred = np.argmax(pred,axis=1)\n# —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å—ã\nlabels = (train.class_indices)\nlabels = dict((v,k) for k,v in labels.items())\npred = [labels[k] for k in pred]\n# –ø–æ–ª—É—á–∞–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã\ny_test = [labels[k] for k in test.classes]\n# –æ—Ü–µ–Ω–∏–≤–∞–µ–º —Ç–æ—á–Ω–æ—Å—Ç—å\nfrom sklearn.metrics import accuracy_score\nacc = accuracy_score(y_test, pred)\nprint(f'Accuracy on the test set: {100*acc:.2f}%')\n–û—Ç–ª–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, —Ç–æ –µ—Å—Ç—å —Ç–µ–ø–µ—Ä—å –º–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞, –≤–µ—Å–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã.¬†\n–ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Ä–∞–±–æ—Ç–µ —Å —á–∞—Ç-–±–æ—Ç–æ–º. –ü—Ä–µ–∂–¥–µ —á–µ–º –Ω–∞—á–∏–Ω–∞—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É, –±–æ—Ç–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –∏ –ø–æ–ª—É—á–∏—Ç—å –µ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π id. –ü—Ä–∏ —ç—Ç–æ–º –≤–ª–∞–¥–µ–ª—å—Ü–µ–º –±–æ—Ç–∞ –±—É–¥–µ—Ç —Ç–æ—Ç, —Å —á—å–µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ –æ–Ω —Å–æ–∑–¥–∞–≤–∞–ª—Å—è.¬† –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–≤–æ–µ–≥–æ –±–æ—Ç–∞ –≤ Telegram –µ—Å—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –±–æ—Ç-\n@BotFather\n. –ù–∞—Ö–æ–¥–∏–º –µ–≥–æ –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ–º –Ω–∞—á–∞–ª–æ –¥–∏–∞–ª–æ–≥–∞, –Ω–∞–±—Ä–∞–≤ –∫–æ–º–∞–Ω–¥—É \n/start.\n¬†\n–î–∞–ª–µ–µ –≤–≤–æ–¥–∏–º –∫–æ–º–∞–Ω–¥—É \n/newbot\n, –≤–≤–æ–¥–∏–º –∏–º—è –±–æ—Ç–∞ (MyTestbot) –∏ username –±–æ—Ç–∞ (RecFood_bot). Username –¥–æ–ª–∂–µ–Ω –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∑–∞–∫–∞–Ω—á–∏–≤–∞—Ç—å—Å—è –Ω–∞ bot –∏ –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º.\n–î–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–æ—Ç–æ–º –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É aiogram. –û–Ω–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —É–¥–æ–±–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–æ—Ç–æ–º, –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π, —Ä–∞–±–æ—Ç—ã —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞–º–∏, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –¥—Ä—É–≥–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏ –∏ —Ç.–¥. –£—Å—Ç–∞–Ω–æ–≤–∏–º –µ–µ\npip install aiogram\n–î–∞–ª–µ–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–æ—Ç–æ–º –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –¢–æ–∫–µ–Ω –±–æ—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è –µ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º, –µ–≥–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç BotFather –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –±–æ—Ç–∞.\n–¢–∞–∫–∂–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–æ—Ç–æ–º –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è –∫–ª–∞—Å—Å—ã Bot, Dispatcher, executor, types.\nBot - —ç—Ç–æ –∫–ª–∞—Å—Å, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –º–µ—Ç–æ–¥—ã –±–æ—Ç–∞ –∏ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ç—Ä–∏–±—É—Ç–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —Ç–æ–∫–µ–Ω –±–æ—Ç–∞, Dispatcher - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞—à–∏—Ö –±—É–¥—É—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π, –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ —Ç.–¥, –∞ executor –Ω–µ–æ–±—Ö–æ–¥–∏–º –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–∞—à–µ–≥–æ –±–æ—Ç–∞.¬†\n–ß—Ç–æ–±—ã –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –∫–∞–∫ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π —É–¥–æ–±–Ω–µ–µ –≤—Å–µ–≥–æ –Ω–∞–≤–µ—Å–∏—Ç—å –Ω–∞ –Ω–µ–µ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä. –í Aiogram –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–≤ \nmessage_handler\n–°–æ–∑–¥–∞–¥–∏–º —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ Bot, –ø–µ—Ä–µ–¥–∞–≤ –≤ –Ω–µ–≥–æ —Ç–æ–∫–µ–Ω, –æ–±—ä–µ–∫—Ç Disptcher –∏ –≤ –Ω–µ–≥–æ –ø–µ—Ä–µ–¥–∞–¥–∏–º –Ω–∞—à–µ–≥–æ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –±–æ—Ç–∞ –∏ –Ω–∞–ø–∏—à–µ–º 2 –ø—Ä–æ—Å—Ç—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–æ–º–∞–Ω–¥—ã start –∏ help. –î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∑–∞—Å—Ç–∞–≤–∏—Ç—å –±–æ—Ç–∞ —Ä–∞–±–æ—Ç–∞—Ç—å, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤ –∫–æ–Ω—Ü–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –≤—ã–∑–≤–∞—Ç—å –º–µ—Ç–æ–¥ \nstart_polling\n –∫–ª–∞—Å—Å–∞ \nexecutor\n, –ø–µ—Ä–µ–¥–∞–≤ —Ç—É–¥–∞ –Ω–∞—à –æ–±—ä–µ–∫—Ç Dispatcher.\nimport logging\nimport os\nfrom aiogram import Bot, Dispatcher, executor, types\nfrom keras.models import load_model\nfrom keras_preprocessing import image\nfrom keras_preprocessing.image import img_to_array\nimport numpy as np\nimport tensorflow as tf\nimport cv2\n#–≤–∫–ª—é—á–∞–µ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ\nlogging.basicConfig(level=logging.INFO)\n#–æ–±—ä–µ–∫—Ç –±–æ—Ç–∞\nbot = Bot(token=API_TOKEN)\n#–¥–∏—Å–ø–µ—Ç—á–µ—Ä\ndp = Dispatcher(bot)\n#–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥—ã —Å—Ç–∞—Ä—Ç\n@dp.message_handler(commands=['start'])\nasync def echo(message: types.Message):\n  await message.reply('–ü—Ä–∏–≤–µ—Ç! –Ø –±–æ—Ç, —Ä–∞—Å–ø–æ–∑–Ω–∞—é—â–∏–π –æ–≤–æ—â–∏ –∏ —Ñ—Ä—É–∫—Ç—ã')\n# –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥—ã help\n@dp.message_handler(commands=['help'])\nasync def echo(message: types.Message):\n  await message.reply('–ü—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –º–Ω–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–≤–æ—â –∏–ª–∏ —Ñ—Ä—É–∫—Ç')\n\nif __name__ == '__main__':\n#–∑–∞–ø—É—Å–∫ –ø—É–ª–ª–∏–Ω–≥–∞\n  executor.start_polling(dp, skip_updates=True)\n–¢–µ–ø–µ—Ä—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–ø–∏—Å–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é, –ø—Ä–∏—Å–ª–∞–Ω–Ω—É—é –±–æ—Ç—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∏ –≤—ã–¥–∞–µ—Ç –æ—Ç–≤–µ—Ç, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, —á—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–æ –Ω–∞ —Ñ–æ—Ç–æ.¬†\n@dp.message_handler(content_types=[types.ContentType.PHOTO])\nasync def download_photo(message: types.Message):\n# –∑–∞–≥—Ä—É–∂–∞–µ–º —Ñ–æ—Ç–æ –≤ –ø–∞–ø–∫—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é\n   await message.photo[-1].download()\n# –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—É—Ç—å –∫ —Ñ–æ—Ç–æ\n   img_path = (await bot.get_file(message.photo[-1].file_id)).file_path\n# –ø–æ–ª—É—á–∞–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ\n   pred = predictions(img_path)\n# –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é\n   await message.answer(f\"–Ø –¥—É–º–∞—é, —á—Ç–æ —ç—Ç–æ {temp}üòä\")\n–¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–¥–∏–º —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è —Å –ø–æ–º–æ—â—å—é —É—Ç–∏–ª–∏—Ç—ã \nload_img\n –∏–∑ –ø–∞–∫–µ—Ç–∞ \nkeras.preprocessing.image\n –±—É–¥–µ—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å –≤—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ —Ç–µ–Ω–∑–æ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∑–∞–¥–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞.\ndef get_img_array(img_path, size):\n   img = tf.keras.preprocessing.image.load_img(img_path, target_size=size)\n   array = tf.keras.preprocessing.image.img_to_array(img)\n   # —Ä–∞—Å—à–∏—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –º–∞—Å—Å–∏–≤–∞ –≤ –ø–∞–∫–µ—Ç—ã\n   array = np.expand_dims(array, axis=0)\n   return array\n–ò —Å–æ–∑–¥–∞–¥–∏–º –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ. –°–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—à—É –º–æ–¥–µ–ª—å –∏–∑ —Ñ–∞–π–ª–∞ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ \nload_model\n –∏–∑ –ø–∞–∫–µ—Ç–∞ \nkeras\n. –û–ø—Ä–µ–¥–µ–ª—è–µ–º –º–∞—Å—Å–∏–≤ –º–µ—Ç–æ–∫ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏. –ò—Å–ø–æ–ª—å–∑—É–µ–º –º–µ—Ç–æ–¥ \nmobilenet_v2.preprocess_input\n –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –≤—Ö–æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç, –ø–æ–¥—Ö–æ–¥—è—â–∏–π –¥–ª—è –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏. –í—ã–ø–æ–ª–Ω—è–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ \ndef predictions(img_path):\n   img_size = (224, 224)\n   classifier = load_model(\"****/fruit224mobile.h5\")\nclass_labels = ['–Ø–±–ª–æ–∫–æ', '–ë–∞–Ω–∞–Ω', '–°–≤–µ–∫–ª–∞', '–ë–æ–ª–≥–∞—Ä—Å–∫–∏–π –ø–µ—Ä–µ—Ü', '–ö–∞–ø—É—Å—Ç–∞', '–°—Ç—Ä—É—á–∫–æ–≤—ã–π –ø–µ—Ä–µ—Ü', '–ú–æ—Ä–∫–æ–≤—å', '–¶–≤–µ—Ç–Ω–∞—è –∫–∞–ø—É—Å—Ç–∞',\n               '–ü–µ—Ä–µ—Ü —á–∏–ª–∏', '–ö—É–∫—É—Ä—É–∑–∞', '–û–≥—É—Ä–µ—Ü', '–ë–∞–∫–ª–∞–∂–∞–Ω', '–ß–µ—Å–Ω–æ–∫', '–ò–º–±–∏—Ä—å', '–í–∏–Ω–æ–≥—Ä–∞–¥', '–•–∞–ª–∞–ø–µ–Ω—å–æ', '–ö–∏–≤–∏',\n               '–õ–∏–º–æ–Ω', '–õ–∞—Ç—É–∫', '–ú–∞–Ω–≥–æ', '–õ—É–∫', '–ê–ø–µ–ª—å—Å–∏–Ω', '–ü–∞–ø—Ä–∏–∫–∞', '–ì—Ä—É—à–∞', '–ì–æ—Ä–æ—Ö', '–ê–Ω–∞–Ω–∞—Å', '–ì—Ä–∞–Ω–∞—Ç',\n               '–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å', '–†–µ–¥—å–∫–∞', '–°–æ–µ–≤—ã–µ –±–æ–±—ã', '–®–ø–∏–Ω–∞—Ç', '–°–ª–∞–¥–∫–∞—è –∫—É–∫—É—Ä—É–∑–∞', '–ë–∞—Ç–∞—Ç', '–ü–æ–º–∏–¥–æ—Ä', '–†–µ–ø–∞', '–ê—Ä–±—É–∑']\n\ntry:\n   preprocess_input = tf.keras.applications.mobilenet_v2.preprocess_input\n   img_array = preprocess_input(get_img_array(img_path, size=img_size))\n   pred = np.argmax(classifier.predict(img_array), axis=1)\n   predictions = class_labels[pred[0]]\n   return predictions\nexcept Exception:\n   return \"–ü—Ä–æ–±–ª–µ–º—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º\"\n–í—Å–µ, –±–æ—Ç –≥–æ—Ç–æ–≤! –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º –µ–≥–æ —Å–Ω–∞—á–∞–ª–∞ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö\n–ò –Ω–∞ —Å–≤–æ–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö. –ó–¥–µ—Å—å —Å–∫—Ä–∏–Ω—à–æ—Ç—ã —Å–¥–µ–ª–∞–Ω—ã –≤ –≤–µ—Ä—Å–∏–∏ Telegram Desktop.\n–ü–æ-–º–æ–µ–º—É –±–æ—Ç –æ—Ç–ª–∏—á–Ω–æ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–æ —Å–≤–æ–µ–π –∑–∞–¥–∞—á–µ–π! –ë–ª–∞–≥–æ–¥–∞—Ä—è –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–æ–π –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ MobileNetV2 –º—ã –±—ã—Å—Ç—Ä–æ –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏ –∏ –æ–±—É—á–∏–ª–∏ —Å–µ—Ç—å, –∞ –∑–∞—Ç–µ–º —Å–æ–∑–¥–∞–ª–∏ –ø—Ä–æ—Å—Ç–æ–≥–æ –±–æ—Ç–∞, —Ä–∞—Å–ø–æ–∑–Ω–∞—é—â–µ–≥–æ –æ–≤–æ—â–∏ –∏ —Ñ—Ä—É–∫—Ç—ã.\n–ù–∞ —ç—Ç–æ–º –≤—Å–µ. –í –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ö–æ—á—É –ø–æ—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å \n–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –≤–µ–±–∏–Ω–∞—Ä\n, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º —ç–∫—Å–ø–µ—Ä—Ç—ã OTUS —Ä–∞—Å—Å–∫–∞–∂—É—Ç –∫–∞–∫–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –¥–∞—é—Ç –ë–∞–π–µ—Å–æ–≤—Å–∫–∏–µ A/B —Ç–µ—Å—Ç—ã –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –æ–±—ã—á–Ω—ã–º–∏ (–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å, —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –¥—Ä—É–≥–∏–µ), –∫–∞–∫ –ø—Ä–æ–≤–æ–¥–∏—Ç—å –ë–∞–π–µ—Å–æ–≤—Å–∫–∏–µ A/B —Ç–µ—Å—Ç—ã –∏ –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ë–∞–π–µ—Å–æ–≤—Å–∫–º–∏ –º–æ–¥–µ–ª—è–º–∏ –≤ PyMC3.\n–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –≤–µ–±–∏–Ω–∞—Ä\n \n ",
    "tags": [
        "mobilenetv2",
        "–º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ",
        "–∏—Å—Å–∫—É—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç",
        "—á–∞—Ç-–±–æ—Ç"
    ]
}