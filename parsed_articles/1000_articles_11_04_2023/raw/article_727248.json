{
    "article_id": "727248",
    "article_name": "–ì—É–≥–ª —Ç–∞–±–ª–∏—Ü–∞ –∫–∞–∫ –ë–î –¥–ª—è —Ç–µ–ª–µ–≥—Ä–∞–º –±–æ—Ç–∞ (–∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü—É)",
    "content": "–í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! –°–ø–∞—Å–∏–±–æ –∑–∞ –∏–Ω—Ç–µ—Ä–µ—Å –∫ –ø—Ä–µ–¥—ã–¥—É—â–∏–º –ø–æ—Å—Ç–∞–º (\n—Ä–∞–∑ \n–∏ \n–¥–≤–∞\n), –∞ —Å–µ–≥–æ–¥–Ω—è –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –¥–æ–ø–æ–ª–Ω—è—Ç—å –Ω–∞—à–µ–≥–æ –±–æ—Ç–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º. –°–æ—Ö—Ä–∞–Ω–∏–º –æ—Ç–≤–µ—Ç—ã –∏–∑ —Ç–µ–ª–µ–≥—Ä–∞–º–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –≥—É–≥–ª —Ç–∞–±–ª–∏—Ü—É.\n–ü–æ–ª–µ–∑–Ω–æ–µ –æ—Ç—Å—Ç—É–ø–ª–µ–Ω–∏–µ\n–°–Ω–∞—á–∞–ª–∞ —è –±—ã —Ö–æ—Ç–µ–ª–∞ —Å–¥–µ–ª–∞—Ç—å –ø–æ–ª —à–∞–≥–∞ –Ω–∞–∑–∞–¥ –∏ –ø–æ–∫–∞–∑–∞—Ç—å, –≤ –∫–∞–∫–æ–º –≤–∏–¥–µ –º—ã –ø–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ —Ç–µ–ª–µ–≥—Ä–∞–º–∞, –∫–æ–≥–¥–∞ –º—ã –∫–ª–∏–∫–∞–µ–º –ø–æ –∫–Ω–æ–ø–∫–µ, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç—É –∏–ª–∏ –ª—é–±–æ–µ –¥—Ä—É–≥–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ. –õ—é–±–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –≤–∏–¥–µ json –ø–∞–∫–µ—Ç–∞.\n–ù–∞–ø—Ä–∏–º–µ—Ä, –º–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ \n/start\n –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç  HTTP \nPOST\n –∑–∞–ø—Ä–æ—Å –∫ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é (–≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —ç—Ç–æ –Ω–∞—à —Å–∫—Ä–∏–ø—Ç). –°–∫—Ä–∏–ø—Ç, –≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å, —Å –ø–æ–º–æ—â—å—é Simple trigger\n doPost(e)\n –≤–µ—Ä–Ω–µ—Ç –ø–∞–∫–µ—Ç –∫–∞–∫ –≤ —Å–Ω–∏–ø–µ—Ç–µ –Ω–∏–∂–µ.\n{\n  update_id=2.96528127E8, \n  message={\n    text=/start, \n    entities=[Ljava.lang.Object;@73afdadb, \n    message_id=116.0, \n    from={\n      first_name=Nadya, \n      language_code=ru, \n      is_bot=false, \n      username=brainwashed_from_rock, \n      id=3.11157431E8\n    }, \n    date=1.680698505E9, \n    chat={\n      username=brainwashed_from_rock, \n      first_name=Nadya, \n      type=private, \n      id=3.11157431E8\n    }\n  }\n}\ne\n –≤ \ndoPost(e)\n –æ–∑–Ω–∞—á–∞–µ—Ç event. –î–∞–ª–µ–µ –æ–±—Ä–∞—â–∞–µ–º—Å—è –∫ \n–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏\n –∏ –∏–∑—É—á–∞–µ–º –º–µ—Ç–æ–¥—ã –¥–ª—è event. –ù–∞—Ö–æ–¥–∏–º \ne.postData.contents\n –∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ json-–ø–∞–∫–µ—Ç–∞. –§—É–Ω–∫—Ü–∏—è –ø–∞—Ä—Å–∏–Ω–≥–∞ —É –Ω–∞—Å —É–∂–µ –µ—Å—Ç—å:\nfunction doPost(e) {\n  const update = JSON.parse(e.postData.contents);\n  let msgData = {}\n  if (update.hasOwnProperty('message')) {\n    msgData = {\n      id         : update.message.message_id,\n      chat_id    : update.message.chat.id,\n      user_name  : update.message.from.username,\n      text       : update.message.text,\n      is_msg     : true\n    };\n  }\n  sendQuestions(msgData.chat_id);\n}\n–í —Ñ—É–Ω–∫—Ü–∏–∏ —è –æ–±—ä—è–≤–ª—è—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é update, –≤ –∫–æ—Ç–æ—Ä—É—é –∑–∞–ø–∏—Å—ã–≤–∞—é —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–∞. –î–∞–ª–µ–µ –æ–±—ä—è–≤–ª—è—é –æ–±—ä–µ–∫—Ç \nmsgData\n, –ø—Ä–æ–≤–µ—Ä—è—é –µ—Å—Ç—å –ª–∏ —É –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π update —Å–≤–æ–π—Å—Ç–≤–æ '\nmessage\n' –∏ –∑–∞–ø–∏—Å—ã–≤–∞—é –≤ \nmsgData\n –Ω—É–∂–Ω—ã–µ –º–Ω–µ –∑–Ω–∞—á–µ–Ω–∏—è.\n–ü–æ–º–∏–º–æ —Å–≤–æ–π—Å—Ç–≤–∞ \nmessage\n –º–æ–≥—É—Ç –±—ã—Ç—å \ncallback_data, edited_message, forwarded_message\n –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ. –ü—Ä–∏ —ç—Ç–æ–º –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–π –ø–∞–∫–µ—Ç –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –∫–ª—é—á–∏ –∏ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å –∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –≤ –ø–∞—Ä—Å–∏–Ω–≥–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–µ–¥—É—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –≤—Å–µ –∫–µ–π—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É—é—Ç.\n–£ –Ω–∞—Å –µ—Å—Ç—å –∫–µ–π—Å —Å –∫–Ω–æ–ø–∫–∞–º–∏, –Ω–∞–∂–∞—Ç–∏–µ –Ω–∞ –∫–∞–∫—É—é-–ª–∏–±–æ –∏–∑ –Ω–∏—Ö –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–∞–∫–µ—Ç –≤–∏–¥–∞\n{\n  update_id=2.96528133E8, \n  callback_query={\n    id=1336410990935140117, \n    chat_instance=-2700514822492676651, \n    message={\n      text=Say my name..., \n      chat={\n        type=private, \n        username=brainwashed_from_rock, \n        id=3.11157431E8, \n        first_name=Nadya\n      }, \n      message_id=121.0, \n      date=1.680698507E9, \n      from={\n        is_bot=true, \n        username=Testforpost_Bot, \n        id=2.077040493E9, \n        first_name=Test for post\n      }, \n      reply_markup={\n        inline_keyboard=[Ljava.lang.Object;@39c491d8\n      }\n    }, \n    data=–§–∏–Ω–Ω –ø–∞—Ä–Ω–∏—à–∫–∞, \n    from={\n      username=brainwashed_from_rock, \n      language_code=ru, \n      first_name=Nadya, \n      is_bot=false, \n      id=3.11157431E8\n    }\n  }\n}\n–û—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ –ø–∞–∫–µ—Ç—ã —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è –∏ –ø–æ—Ä—è–¥–æ–∫ –ø–∞—Ä—Å–∏–Ω–≥–∞ —Ç–æ–∂–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è. –î–æ–ø–æ–ª–Ω–∏–º —Ñ—É–Ω–∫—Ü–∏—é \ndoPost(e)\n –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏:\nfunction doPost(e) {\n  const update = JSON.parse(e.postData.contents);\n  let msgData = {}\n  if (update.hasOwnProperty('message')) {\n    msgData = {\n      id         : update.message.message_id,\n      chat_id    : update.message.chat.id,\n      user_name  : update.message.from.username,\n      text       : update.message.text,\n      date       : (update.message.date/86400)+25569.125,\n      is_msg     : true\n    };\n  }\n\n  else if (update.hasOwnProperty('callback_query')) {\n    msgData = {\n      id         : update.callback_query.message.message_id,\n      chat_id    : update.callback_query.message.chat.id,\n      user_name  : update.callback_query.from.username,\n      first_name : update.callback_query.from.first_name,\n      text       : update.callback_query.message.text,\n      data       : update.callback_query.data,\n      is_button  : true\n    }\n  \n  //sendQuestions(msgData.chat_id);\n}\n–°–∞–º –æ–±—ä–µ–∫—Ç \nmsgData\n –º–æ–∂–Ω–æ –¥–æ–ø–æ–ª–Ω—è—Ç—å –ª—é–±—ã–º–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ –≤–∞–º –∑–Ω–∞—á–µ–Ω–∏—è–º–∏. –í –º–æ–µ–º –ø—Ä–∏–º–µ—Ä–µ, –ø–æ–º–∏–º–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ø–∞–∫–µ—Ç–∞, —è –¥–æ–±–∞–≤–∏–ª–∞ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã \nis_msg\n –∏ \nis_button\n.\n–ù–∞–¥–µ—é—Å—å, —á—Ç–æ –≤ —ç—Ç–æ–π —á–∞—Å—Ç–∏ —è –ø—Ä–∏–≤–µ–ª–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–µ –≤–≤–æ–¥–Ω—ã–µ –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ø–∞–∫–µ—Ç–∞–º–∏ –∏ –ø–∞—Ä—Å–∏–Ω–≥–æ–º.\n–ü–ª–∞–Ω –º–∏–Ω–∏–º—É–º\n–§—É–Ω–∫—Ü–∏—é \ndoPost(e)\n —è –æ—Å—Ç–∞–≤–ª—é —Ç–æ–ª—å–∫–æ –¥–ª—è¬†–ø–∞—Ä—Å–∏–Ω–≥–∞ –∏ –≤—ã–∑–æ–≤—É –≤¬†–Ω–µ–π –≤¬†–ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç—Ä–æ–∫–µ –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é \ndataHandler(msgData)\n. –û–±–æ–∑–Ω–∞—á–∏–º –µ–µ –ø–æ–∫–∞ –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ, –ø—Ä–æ–≤–µ—Ä–∏–≤ –∫–∞–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ (event) –≤–µ—Ä–Ω—É–ª–æ—Å—å¬†‚Äî —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–ª–∏¬†–∫–Ω–æ–ø–∫–∞.\nfunction dataHandler(msgData) {\n  if (msgData.is_msg) {\n    sendQuestions(msgData.chat_id);\n  } else if (msgData.is_button) {\n    saveData(msgData) \n  }\n}\n–ï—Å–ª–∏ –±–æ—Ç –ø–æ–ª—É—á–∏–ª —Å–æ–æ–±—â–µ–Ω–∏–µ, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤–æ–ø—Ä–æ—Å—ã, –µ—Å–ª–∏ –∫–Ω–æ–ø–∫—É, —Å–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ç–≤–µ—Ç—ã. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–æ–≤ —Å–ª–µ–¥—É—é—â–∞—è:\n–§—É–Ω–∫—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–æ–≤ \nsaveData(msgData)\n:\nfunction saveData(msgData)¬† {\n  const vals = [msgData.chat_id, msgData.user_name, msgData.text, msgData.data, msgData.date]\n  usersSheet.appendRow(vals)\n}\n\n–í –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é \nvals\n —è –∑–∞–ø–∏—Å—ã–≤–∞—é —Å–æ—Ö—Ä–∞–Ω—è–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ç–æ–º –ø–æ—Ä—è–¥–∫–µ, –≤ –∫–æ—Ç–æ—Ä–æ–º –æ–Ω–∏ –±—É–¥—É—Ç –≤—ã–≤–µ–¥–µ–Ω—ã –≤ —Ç–∞–±–ª–∏—Ü–µ. –ù–∞ –ª–∏—Å—Ç \nusersSheet\n –≤—Å—Ç–∞–≤–ª—è—é –Ω–æ–≤—É—é —Å—Ç—Ä–æ–∫—É —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ \nappendRow()\n –∏ —É–∫–∞–∑–∞–Ω–∏–µ–º –≤—Å—Ç–∞–≤–ª—è–µ–º–æ–≥–æ –º–∞—Å—Å–∏–≤–∞. –†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∏–≤–µ–¥–µ–Ω –Ω–∞ —Å–∫—Ä–∏–Ω–µ –≤—ã—à–µ –≤–æ –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∫–µ —Ç–∞–±–ª–∏—Ü—ã.\n–î–∞–ª–µ–µ –±—É–¥–µ–º –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–æ–≤ –∏ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –ó–¥–µ—Å—å –Ω–∞–º –Ω—É–∂–Ω–æ —Å–æ–ø–æ—Å—Ç–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –≤–æ–ø—Ä–æ—Å–æ–º –∏–∑ —Ç–∞–±–ª–∏—Ü—ã, –∑–∞—Ç–µ–º –≤–æ–ø—Ä–æ—Å –∏–∑ —Ç–∞–±–ª–∏—Ü—ã - —Å –æ—Ç–≤–µ—Ç–∞–º–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã \nAnswers\n –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π –∏–∑ 4 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ—Ç–≤–µ—Ç –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å. \n–ó–¥–µ—Å—å —è –±—ã —Ö–æ—Ç–µ–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ —Ç–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞, –∞ –µ–≥–æ –∏–¥. –ü–æ–º–µ–Ω—è—é —Ç–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞ —Ç–∞–∫, —á—Ç–æ –≤ –Ω–∞—á–∞–ª–µ –≤–æ–ø—Ä–æ—Å–∞ –±—É–¥–µ—Ç –µ–≥–æ –∏–¥.\n–í —Ñ—É–Ω–∫—Ü–∏–∏ \nsendQuestions(chat_id)\n –≤–º–µ—Å—Ç–æ —Å—Ç—Ä–æ–∫–∏ \nsend(e[1], chat_id, keyboard)\n–Ω–∞–ø–∏—à—É –¥–≤–µ —Å–ª–µ–¥—É—é—â–∏–µ:\nconst question = e[0]+'/'+questionsArr.length+': '+e[1]\nsend(question, chat_id, keyboard)\n–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –≤ –æ–±—ä–µ–∫—Ç–µ \nmsgData\n –ø–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏ –º—ã –º–æ–∂–µ–º —Å–ø–∞—Ä—Å–∏—Ç—å –∏–¥ –≤–æ–ø—Ä–æ—Å–∞ –∏ –∑–∞–ø–∏—Å–∞—Ç—å –µ–≥–æ –≤ —Ç–∞–±–ª–∏—Ü—É —Å –æ—Ç–≤–µ—Ç–∞–º–∏, –∏–∑–º–µ–Ω–∏–≤ —Ñ—É–Ω–∫—Ü–∏—é \nsaveData(msgData)\n:\nfunction saveData(msgData)¬† {\n  const vals = [msgData.chat_id, msgData.user_name, msgData.text[0], msgData.data, msgData.date]\n  usersSheet.appendRow(vals)\n}\n–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ, –∏–∑ —Ç–µ–∫—Å—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –º—ã —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π —Å–∏–º–≤–æ–ª, —á—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∏–¥ –≤–æ–ø—Ä–æ—Å–∞. –ö–∞–∫ —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ.\n*–ï—Å–ª–∏ –¥–∞—Ç–∞ –∑–∞–ø–∏—Å–∞–Ω–∞ –≤ –≤–∏–¥–µ –º–∞–≥–∏—á–µ—Å–∫–∏—Ö —á–∏—Å–µ–ª, –∏–∑–º–µ–Ω–∏—Ç–µ —Ñ–æ—Ä–º–∞—Ç —è—á–µ–µ–∫ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –∫–æ–ª–æ–Ω–∫–µ.\n–¢–µ–ø–µ—Ä—å –¥–æ–±–∞–≤–∏–º –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –Ω–∞—à–µ–º—É –±–æ—Ç—É –∏ –¥–∞–¥–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø–æ–Ω—è—Ç—å, –≤–µ—Ä–Ω—ã–π –ª–∏ –æ–Ω –¥–∞–ª –æ—Ç–≤–µ—Ç –∏–ª–∏ –Ω–µ—Ç. –ü—Ä–∏–º–µ—Ä –Ω–∏–∂–µ\n–ü–æ—Å–ª–µ –æ—Ç–≤–µ—Ç–∞ –±–æ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–æ–≤ –≤ —Ç–µ–∫—Å—Ç–µ –∫–Ω–æ–ø–æ–∫, –∞ –≤ —Ç–µ–∫—Å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤—ã–≤–æ–¥–∏—Ç –æ—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞.\n–î–ª—è –Ω–∞—á–∞–ª–∞ –æ–±–æ–∑–Ω–∞—á–∏–º —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç —É–∂–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:\nfunction editMsg(msg, chat_id, msg_id, keyboard) {\n  const payload = {\n    'method': 'editMessageText',\n    'chat_id': String(chat_id),\n    'message_id': String(msg_id),\n    'text': msg,\n    'parse_mode': 'HTML'\n  }\n  if (keyboard) payload.reply_markup = JSON.stringify(keyboard)\n  \n  const data = {\n    'method': 'post',\n    'payload': payload,\n    'muteHttpExceptions': true\n}\n–§—É–Ω–∫—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ—Ç–æ–¥ \neditMessageText\n, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —è–≤–ª—è—é—Ç—Å—è \ntext\n, \nchat_id\n –∏ \nmessage_id\n. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –º—ã –º–æ–∂–µ–º —É–∫–∞–∑–∞—Ç—å –¥—Ä—É–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –≤ —Ç–æ–º —á–∏—Å–ª–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É.\n*–ß—Ç–æ–±—ã –Ω–µ –∑–∞–ø—É—Ç–∞—Ç—å—Å—è, —Ö—Ä–∞–Ω–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ —Ä–∞–∑–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö, —Ä–∞–∑–¥–µ–ª–∏–≤ –∏—Ö –ø–æ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏—é. –ù–∞–ø—Ä–∏–º–µ—Ä, —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–µ–ª–µ–≥—Ä–∞–º, –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —Ñ—É–Ω–∫—Ü–∏—è –ø–∞—Ä—Å–∏–Ω–≥–∞ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã —É –º–µ–Ω—è –≤ —Ä–∞–∑–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö.\n–î–∞–ª–µ–µ —Å–æ–∑–¥–∞–º –µ—â–µ –æ–¥–Ω—É —Ñ—É–Ω–∫—Ü–∏—é \neditMessage(msgData)\n, –≤ –∫–æ—Ç–æ—Ä–æ–π –Ω–∞–º –Ω—É–∂–Ω–æ —Å—Ä–∞–≤–Ω–∏—Ç—å –æ—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –æ—Ç–≤–µ—Ç–æ–≤ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã, –∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ –æ—Ç–≤–µ—Ç–∞ –≤–Ω–µ—Å—Ç–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–∞–≤–∫–∏ –≤ —Ç–µ–∫—Å—Ç.\n–ù–∞—á–Ω–µ–º —Å –æ—Ç–≤–µ—Ç–æ–≤ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã, –∑–∞–ø–∏—Å–∞–≤ –∏—Ö –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é \nanswersArr,\n —á—Ç–æ –º—ã —É–∂–µ –¥–µ–ª–∞–ª–∏ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤–æ–ø—Ä–æ—Å–æ–≤.\nfunction editMessage(msgData) {\n  const answersArr = answersSheet.getDataRange().getValues()\n}\n–í–æ—Å–ø–æ–ª—å–∑—É—é—Å—å –º–µ—Ç–æ–¥–æ–º –º–∞—Å—Å–∏–≤–∞ \n.filter()\n, –æ—Å—Ç–∞–≤–∏–≤ –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞:\nconst answersArr = answersSheet.getDataRange().getValues().filter(e => e[0] == msgData.text[0]);\n–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —è —Å—Ä–∞–≤–Ω–∏–≤–∞—é –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞ \nanswersArr\n —Å –ø–µ—Ä–≤—ã–º —Å–∏–º–≤–æ–ª–æ–º –≤ —Å—Ç—Ä–æ–∫–µ —Ç–µ–∫—Å—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏—è, —Ç–æ –µ—Å—Ç—å —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è—é –∏–¥ –≤–æ–ø—Ä–æ—Å–∞ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã —Å –æ—Ç–≤–µ—Ç–∞–º–∏ —Å –∏–¥ –≤–æ–ø—Ä–æ—Å–∞ –∏–∑ —Ç–µ–∫—Å—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏—è.\n–°–æ—Ö—Ä–∞–Ω–∏–º –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é \ncurAnswerArr\n —Å—Ç—Ä–æ–∫—É –∏–∑ —Ç–∞–±–ª–∏—Ü—ã —Å –æ—Ç–≤–µ—Ç–∞–º–∏, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –¥–∞–Ω–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –æ—Ç–≤–µ—Ç—É:\nconst curAnswerArr = answersArr.find(e => e[1] == msgData.data);\n–ó–¥–µ—Å—å –≤ —É–∂–µ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω–æ–º –º–∞—Å—Å–∏–≤–µ –∏–∑ 4—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ—Ç–≤–µ—Ç–æ–≤ —è –≤—ã–±–∏—Ä–∞—é –æ–¥–∏–Ω, —Ç–µ–∫—Å—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ —Ä–∞–≤–µ–Ω —Ç–µ–∫—Å—Ç—É –≤ –∫–Ω–æ–ø–∫–µ.\n–î–∞–ª–µ–µ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É—é —Å–∞–º —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ, –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –±—ã–ª –æ—Ç–≤–µ—Ç –∏–ª–∏ –Ω–µ—Ç:\nlet newText = new String();\nif (curAnswerArr[2]) newText = msgData.text + '\\n\\n‚úÖWow\\n–¢–≤–æ–π –æ—Ç–≤–µ—Ç: '+msgData.data;\nelse newText = msgData.text + '\\n\\n‚ùåNope\\n–¢–≤–æ–π –æ—Ç–≤–µ—Ç: '+msgData.data;\n–ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –æ—Ç–≤–µ—Ç –∏–º–µ–µ—Ç –ø–ª–∞—à–∫—É TRUE, —Ç–æ –≤ —Ç–µ–∫—Å—Ç –¥–æ–±–∞–≤–ª—è—é –≥–∞–ª–æ—á–∫—É, –∏–ª–∏ –∫—Ä–µ—Å—Ç–∏–∫ –≤ –æ–±—Ä–∞—Ç–Ω–æ–º —Å–ª—É—á–∞–µ.\n–ò –Ω–∞–∫–æ–Ω–µ—Ü –ø—Ä–æ–ø–∏—Å—ã–≤–∞–µ–º —Å—Ç—Ä–æ–∫—É —Å –≤—ã–∑–æ–≤–æ–º —Ñ—É–Ω–∫—Ü–∏–∏ \neditMsg()\n –∏ –ø–µ—Ä–µ–¥–∞–µ–º –Ω–æ–≤—ã–π —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è, –∏–¥ —á–∞—Ç–∞, –∏–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ null –¥–ª—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã.\neditMsg(newText,msgData.chat_id,msgData.id,null);\n–í—Å—è —Ñ—É–Ω–∫—Ü–∏—è \nsaveData(msgData)\n¬†–ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –Ω–∏–∂–µ:\nfunction editMessage(msgData) {\n  const answersArr = answersSheet.getDataRange().getValues().filter(e => e[0] == msgData.text[0]);\n  const curAnswerArr = answersArr.find(e => e[1] == msgData.data);\n\n  let newText = new String();\n  if (curAnswerArr[2]) newText = msgData.text + '\\n\\n‚úÖWow\\n–¢–≤–æ–π –æ—Ç–≤–µ—Ç: '+msgData.data;\n  else newText = msgData.text + '\\n\\n‚ùåNope\\n–¢–≤–æ–π –æ—Ç–≤–µ—Ç: '+msgData.data;\n\n  editMsg(newText,msgData.chat_id,msgData.id, null);\n}\n–ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –¥–µ–ø–ª–æ–∏–º –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:\n–ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –ø–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏–µ–º –ø—Ä–æ–ø–∞–ª–∞, —Ç.–∫. –≤ \neditMsg\n –≤–º–µ—Å—Ç–æ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –º—ã –ø–µ—Ä–µ–¥–∞–ª–∏ null.\n–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –æ—Å—Ç–∞–≤–ª—é —á–∏—Ç–∞—Ç–µ–ª—é –¥–ª—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–≥–æ –∏–∑—É—á–µ–Ω–∏—è. –ú–æ–∂–µ—Ç –æ–¥–∏–Ω –∏–∑ –º–æ–∏—Ö —Å—Ç–∞—Ä—ã—Ö –ø–æ—Å—Ç–æ–≤ –ø–æ–º–æ–∂–µ—Ç üòâ \n–ü–ª–∞–Ω –º–∞–∫—Å–∏–º—É–º (advanced)\n–ü–µ—Ä–µ–π–¥–µ–º –∫ –≤–æ–ø—Ä–æ—Å–∞–º –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ö:\n–∫–∞–∫ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤–æ–ø—Ä–æ—Å—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ (—Å–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å –ø–æ—Å–ª–µ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π);\n–∫–∞–∫ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–≤–æ–π –æ—Ç–≤–µ—Ç.\n–í–æ–ø—Ä–æ—Å—ã, –∫—Å—Ç–∞—Ç–∏, –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∞–Ω—ã, –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ª—é–±–æ–π –∏–∑ –ª–æ–≥–∏–∫ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞–µ—Ç—Å—è —Ç–µ–º, —á—Ç–æ –º—ã –¥–æ–ª–∂–Ω—ã –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –∫–≤–∏–∑–∞. –ì–æ!\n*–Ø –Ω–µ –±—É–¥—É –ø–æ–≥—Ä—É–∂–∞—Ç—å—Å—è –≤ –¥–µ—Ç–∞–ª–∏, –∫–∞–∫ –¥–µ–ª–∞–ª–∞ –¥–æ —ç—Ç–æ–≥–æ, –∏–Ω–∞—á–µ —á—Ç–∏–≤–æ –∑–∞—Ç—è–Ω–µ—Ç—Å—è –Ω–∞ —á–∞—Å—ã. –ü—Ä–æ—à—É –ø–æ–Ω—è—Ç—å –∏ –ø—Ä–∏–Ω—è—Ç—å, —á—Ç–æ —ç—Ç–∞ —á–∞—Å—Ç—å —Å–∫–æ—Ä–µ–µ –ø—Ä–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∏—á–∏.\n–î–æ —Å–∏—Ö –ø–æ—Ä –º—ã –∑–∞–ø–∏—Å—ã–≤–∞–ª–∏ –≤—Å–µ –∫–ª–∏–∫–∏ –≤ —Ç–∞–±–ª–∏—Ü—É, –∏ –º–æ—è —Ç–∞–±–ª–∏—Ü–∞ –ø–æ—Å–ª–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –æ—Ç–≤–µ—Ç–æ–≤ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:\n–°–¥–µ–ª–∞–µ–º —Ç–∞–∫, —á—Ç–æ–±—ã –∫–∞–∂–¥–æ–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –∫–≤–∏–∑–∞ –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –æ—Ç—Ä–∞–∂–∞–ª–æ—Å—å –≤ —Ç–∞–±–ª–∏—Ü–µ, –Ω–æ –∫–∞–∂–¥–∞—è –ø–æ–ø—ã—Ç–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±—ã–ª–∞ –≤ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ.\n–¢–æ–≥–¥–∞ –º–æ–∂–Ω–æ –≤—ã–Ω–µ—Å—Ç–∏ –∏–¥ –≤–æ–ø—Ä–æ—Å–æ–≤ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏. –ò–∑–º–µ–Ω—é —Ç–∞–±–ª–∏—Ü—É Users —Ç–∞–∫, —á—Ç–æ–±—ã –∫–æ–ª–æ–Ω–∫–∞ C —Å—Ç–∞–ª–∞ –∫–æ–ª–æ–Ω–∫–æ–π \nprogress, \n—á—Ç–æ –æ—Ç—Ä–∞–∂–∞–µ—Ç –Ω–∞ –∫–∞–∫–æ–º —ç—Ç–∞–ø–µ –∫–≤–∏–∑–∞ –¥–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å. –ù–∞–∑–≤–∞–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫ \nE-H\n —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –∏–¥ –≤–æ–ø—Ä–æ—Å–æ–≤.\n*\n–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é Transpose –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–∞–∑–≤–∞–Ω–∏–π –∫–æ–ª–æ–Ω–æ–∫.\n–û—Ç–ø—Ä–∞–≤–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ\n–í–µ—Ä–Ω–µ–º—Å—è –∫ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤–æ–ø—Ä–æ—Å–æ–≤, —Å–∫–æ–ø–∏—Ä—É–µ–º –µ–µ –∏ –ø–µ—Ä–µ–∏–º–µ–Ω—É–µ–º –∫–æ–ø–∏—é –≤ \nsendQuestion, \n–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤–∞–º –µ—â–µ –º–æ–∂–µ—Ç –ø—Ä–∏–≥–æ–¥–∏—Ç—å—Å—è. –¢–∞–∫–∂–µ —è –≤—ã–Ω–µ—Å—É —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é \ncreateKeyboard() \n–∏ –ø–æ–ª—É—á—É —Å–ª–µ–¥—É—é—â–µ–µ:\nfunction sendQuestion(msgData) {\n  const questionsArr = questionsSheet.getDataRange().getValues();\n\n  const questionArr = questionsArr.find(e => e[0] == '–∏–¥ –≤–æ–ø—Ä–æ—Å–∞').flat();\n  const question = questionArr[0]+'/'+questionsArr.length+': '  +questionArr[1];\n  const keyboard = createKeyboard(questionArr);\n  send(question, msgData.chat_id, keyboard)\n\n  //const vals = [msgData.chat_id, msgData.user_name, 1, msgData.date]\n  //usersSheet.appendRow(vals);\n}\n\nfunction createKeyboard(questionArr) {\n  const answersArr = answersSheet.getDataRange().getValues();\n\n  let arr = answersArr.filter(el => el[0] == questionArr[0])\n  arr = arr.map(el => [{\"text\":el[1], \"callback_data\":el[1]}])\n\n  const keyboard = {\n    \"inline_keyboard\": arr\n  }\n\n  return keyboard\n}\n–û–ø—Ä–µ–¥–µ–ª–∏–º, –∫–∞–∫–æ–π –∏–º–µ–Ω–Ω–æ –≤–æ–ø—Ä–æ—Å —è–≤–ª—è–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–º –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –µ–≥–æ —Ç–µ–∫—É—â–µ–π –ø–æ–ø—ã—Ç–∫–∏. –ü–µ—Ä–µ–¥–∞–¥–∏–º \nnextState \n(–ø–æ–∫–∞ –æ–±–æ–∑–Ω–∞—á–∏–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —É—Å–ª–æ–≤–Ω–æ) –≤ —Ñ—É–Ω–∫—Ü–∏—é \nsendQuestion(msgData, nextState) \n–∏ –ø—Ä–æ–≤–µ—Ä–∏–º –ø–æ—Å–ª–µ–¥–Ω–∏–π –ª–∏ —ç—Ç–æ –≤–æ–ø—Ä–æ—Å –∏–∑ –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∏–ª–∏ –Ω–µ—Ç\nfunction sendQuestion(msgData, nextState) {\n  const questionsArr = questionsSheet.getDataRange().getValues();\n\n  if (nextState <= questionsArr.length) {\n    const questionArr = questionsArr.find(e => e[0] == nextState).flat();\n    const question = questionArr[0]+'/'+questionsArr.length+': '  +questionArr[1];\n    const keyboard = createKeyboard(questionArr);\n    send(question, msgData.chat_id, keyboard)\n  } else {\n    const msg = '–ü–æ–∑–¥—Ä–∞–≤–ª—è—é! –ö–≤–∏–∑ –ø—Ä–æ–π–¥–µ–Ω'\n    send(msg, msgData.chat_id, null)\n  }\n}\n–ï—Å–ª–∏ –≤–æ–ø—Ä–æ—Å –±—ã–ª –ø–æ—Å–ª–µ–¥–Ω–∏–º, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–æ–∑–¥—Ä–∞–≤–∏—Ç–µ–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ.\n–†–∞–∑–±–∏—Ä–∞–µ–º—Å—è —Å —ç—Ç–∏–º \nnextState. \n–¢–∞–∫ –∫–∞–∫ –≤—Å–µ –∏–¥ –ø—Ä–æ—Å—Ç–æ —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç—Å—è –Ω–∞ 1, —Ç–æ —Å–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å —ç—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –∏–¥ + 1. –ê —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–ª–∏ \nprogress,\n –Ω—É–∂–Ω–æ –∑–∞–±—Ä–∞—Ç—å –∏–∑ —Ç–∞–±–ª–∏—Ü—ã, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª –Ω–∞ –∫–Ω–æ–ø–∫—É.\n–î–æ–±–∞–≤–ª—é —Ñ—É–Ω–∫—Ü–∏—é \ngetRow(chat_id),\n –∫–æ—Ç–æ—Ä–∞—è –ø–æ —á–∞—Ç –∏–¥ –Ω–∞—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ–¥–Ω—é—é –ø–æ–ø—ã—Ç–∫—É –Ω–∞ –≤–∫–ª–∞–¥–∫–µ usersSheet.\nfunction getRow(chat_id) {\n  const usersArr = usersSheet.getDataRange().getValues();\n  const ind = usersArr.findIndex(e => e[0] == chat_id);\n\n  if (ind < 0) return null\n  else {\n    const rowArr = usersArr[ind]\n    const rowMap = new Map();\n    rowMap.set('ind', rowInd)\n    \n    return rowMap;\n  }\n}\n–Ø —Ä–µ—à–∏–ª–∞ —Å–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç \nMap\n –∏ –≤–Ω–µ—Å—Ç–∏ —Ç—É–¥–∞ –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –≤ –≤–∏–¥–µ –∫–ª—é—á - –∑–Ω–∞—á–µ–Ω–∏–µ, —á—Ç–æ —Ç–∞–∫–∂–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —ç—Ç–∏—Ö –ø–∞—Ä.\n–í \nrowMap\n —è –≤–Ω–µ—Å—É –≤—Å–µ –∫–ª—é—á–∏ –∏ –ø—Ä–∏—Å–≤–æ—é –∏–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è. –¢–∞–∫–∂–µ –Ω–∞–º –Ω—É–∂–Ω–æ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –º–∞—Å—Å–∏–≤ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–µ —Å –Ω–∞—á–∞–ª–∞, –∞ —Å –∫–æ–Ω—Ü–∞, —Ç.–∫. —Å–∞–º—ã–π \"—Å–≤–µ–∂–∏–π\" —Å—Ç–∞—Ä—Ç –∫–≤–∏–∑–∞ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ –∫–æ–Ω–µ—Ü —Ç–∞–±–ª–∏—Ü—ã, –ø–æ—ç—Ç–æ–º—É –≤–æ—Å–ø–æ–ª—å–∑—É—é—Å—å –º–µ—Ç–æ–¥–æ–º –º–∞—Å—Å–∏–≤–∞ .reverse().\nfunction getRow(chat_id) {\n  const usersArr = usersSheet.getDataRange().getValues();\n  const headerUsersArr = usersArr.shift().flat();\n  usersArr.reverse();\n  const ind = usersArr.findIndex(e => e[0] == chat_id);\n\n  if (ind < 0) return null\n  else {\n    const rowInd = usersArr.length - ind;\n    const rowArr = usersArr[ind]\n    const rowMap = new Map();\n    rowMap.set('ind', rowInd)\n    rowArr.forEach((e,i) => rowMap.set(headerUsersArr[i], e));\n\n    return rowMap;\n  }\n}\nheaderUsersArr \n—ç—Ç–æ —à–∞–ø–∫–∞ —Ç–∞–±–ª–∏—Ü—ã, —Ç–æ –µ—Å—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫. –í \nrowMap\n –ø—Ä–∏ —ç—Ç–æ–º –∑–∞–ø–∏—à—É—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏—è –≤ —É—Å–ª–æ–≤–Ω–æ–º –≤–∏–¥–µ: {username=\"brainwashed_from_rock\", progress=1,....}. –¢–µ–ø–µ—Ä—å –∏–∑ —ç—Ç–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –º–æ–∂–Ω–æ –¥–æ—Å—Ç–∞—Ç—å —Ç–µ–∫—É—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å:\nfunction getNextState(rowMap) {\n  const currentState = rowMap.get(\"progress\");\n  const nextState = Number(currentState) + 1;\n\n  return nextState\n}\n–§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–æ–∫–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ. –Ø –∑–∞–ø–∏—Å—ã–≤–∞—é —é–∑–µ—Ä–Ω–µ–π–º (—Ç.–∫. –º–æ–∂–µ—Ç –º–µ–Ω—è—Ç—Å—è), –æ—Ç–≤–µ—Ç –Ω–∞ —Ç–µ–∫—É—â–∏–π –≤–æ–ø—Ä–æ—Å, –∏–¥ —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞, –¥–∞—Ç—É.\nfunction setChatsVals(msgData, progress, rowMap) {\n  rowMap.set(\"username\", msgData.user_name);\n  rowMap.set(rowMap.get(\"progress\"), msgData.data);\n  rowMap.set(\"progress\", progress);\n  rowMap.set(\"date\", msgData.date);\n  \n  const rowArr = new Array();\n  const iterator = rowMap.values();\n  rowMap.forEach(() => rowArr.push(iterator.next().value));\n\n  const ind = rowArr.shift();\n  usersSheet.getRange(ind+1,1,1,rowArr.length).setValues([rowArr]);\n}\n–ò –Ω–∞–∫–æ–Ω–µ—Ü –∑–∞–ø–∏—Å—ã–≤–∞—é –≤ –Ω—É–∂–Ω—É—é —Å—Ç—Ä–æ–∫—É –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–π –∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤ –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç \nMap.\n–¢–µ–ø–µ—Ä—å –∏–∑–º–µ–Ω–∏–º \ndataHandler(msgData)\n –ø–æ–¥ –Ω–æ–≤—É—é –ª–æ–≥–∏–∫—É:\nfunction dataHandler(msgData) {\n  if (msgData.is_msg) {\n    if (msgData.text == '/start') {\n      saveData(msgData);\n      sendQuestion(msgData,nextState=1);\n    }\n  } else if (msgData.is_button) {\n    editMessage(msgData)\n    const rowMap = getRow(msgData.chat_id);\n    const nextState = getNextState(msgData, rowMap);\n    sendQuestion(msgData, nextState);\n    setChatsVals(msgData, nextState, rowMap);\n  }\n}\n–ë–æ—Ç –±—É–¥–µ—Ç —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∫–æ–º–∞–Ω–¥–æ–π \n/start\n –∏–ª–∏ –∫–Ω–æ–ø–∫–∏. –ï—Å–ª–∏ —ç—Ç–æ —Å—Ç–∞—Ä—Ç, —Ç–æ —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é —Å—Ç—Ä–æ–∫—É —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å.\n–ò –µ—Å–ª–∏ –∫–Ω–æ–ø–∫–∞, —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è, –∑–∞–±–∏—Ä–∞–µ–º –∞–∫—Ç—É–∞–ª—å–Ω—É—é —Å—Ç—Ä–æ–∫—É –∏–∑ —Ç–∞–±–ª–∏—Ü—ã Users, –æ–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –µ–≥–æ. –ò –∫–æ–Ω–µ—á–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ç–≤–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü—É.\n–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–≤–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞\n–¢–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º –¥–æ–±–∞–≤–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–∞–≤–∞—Ç—å —Å–≤–æ–±–æ–¥–Ω—ã–π –æ—Ç–≤–µ—Ç. –ü—Ä–∏–º–µ—Ä —á–∞—Ç–∞ –∏ —Ç–∞–±–ª–∏—Ü—ã –Ω–∏–∂–µ.\n–ò–∑–º–µ–Ω–∏–º \nsetChatsVals(msgData, progress, rowMap, flag)\n:\nfunction setChatsVals(msgData, progress, rowMap, flag) {\n  flag == 'is_button' ? rowMap.set(rowMap.get(\"progress\"), msgData.data) : rowMap.set(rowMap.get(\"progress\"), msgData.text);\n\n  rowMap.set(\"username\", msgData.user_name);\n  rowMap.set(\"progress\", progress);\n  rowMap.set(\"date\", msgData.date);\n  \n  const rowArr = new Array()\n  const iterator = rowMap.values()\n  rowMap.forEach(() => rowArr.push(iterator.next().value))\n\n  const ind = rowArr.shift();\n  usersSheet.getRange(ind+1,1,1,rowArr.length).setValues([rowArr])\n}\n–í –ø–µ—Ä–≤—É—é —Å—Ç—Ä–æ–∫—É —è –¥–æ–±–∞–≤–∏–ª–∞ –ø—Ä–æ–≤–µ—Ä–∫—É —Ñ–ª–∞–≥–∞ –Ω–∞ \nis_button. \n–ï—Å–ª–∏ –¥–∞, –∑–∞–ø–∏—Å—ã–≤–∞–µ–º –≤ —Ç–∞–±–ª–∏—Ü—É –∑–Ω–∞—á–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏, –µ—Å–ª–∏ –Ω–µ—Ç, —Ç–æ —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è.\n–ò –Ω–µ–º–Ω–æ–≥–æ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º \ndataHandler(msgData)\n:\nfunction dataHandler(msgData) {\n  const rowMap = getRow(msgData.chat_id);\n  if (msgData.is_msg) {\n    if (msgData.text == '/start') {\n      saveData(msgData);\n      sendQuestion(msgData,nextState=1);\n    } else {\n      const nextState = getNextState(rowMap);\n      sendQuestion(msgData, nextState);\n      setChatsVals(msgData, nextState, rowMap, 'is_msg');\n    }\n  } else if (msgData.is_button) {\n    editMessage(msgData)\n    const nextState = getNextState(rowMap);\n    sendQuestion(msgData, nextState);\n    setChatsVals(msgData, nextState, rowMap, 'is_button');\n  }\n}\n–ó–¥–µ—Å—å –≤ —É—Å–ª–æ–≤–∏–∏ \nis_msg \n —è –ø—Ä–æ–ø–∏—Å–∞–ª–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –∏ –≤–∫–ª—é—á–∏–ª–∞ —Ç—É–¥–∞ —Ç—É –∂–µ —Å–∞–º—É—é –ª–æ–≥–∏–∫—É, –∫–∞–∫ –∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏. –ù–∞ —ç—Ç–æ–º –≤—Å–µ!\n–ó–∞–∫–ª—é—á–µ–Ω–∏–µ\n–û—Å–Ω–æ–≤–Ω–∞—è –∑–∞–¥–∞—á–∞, –∫–æ—Ç–æ—Ä—É—é —è —Å—Ç–∞–≤–∏–ª–∞ –≤ —Å–∞–º–æ–º –ø–µ—Ä–≤–æ–º –ø–æ—Å—Ç–µ, –∞ –∏–º–µ–Ω–Ω–æ \"–ì—É–≥–ª —Ç–∞–±–ª–∏—Ü–∞ –∫–∞–∫ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö\", –Ω–∞ –º–æ–π –≤–∑–≥–ª—è–¥, –≤—ã–ø–æ–ª–Ω–µ–Ω–∞. –ú—ã –º–æ–∂–µ–º –ø–µ—Ä–µ–∫–∏–¥–∞–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ –≥—É–≥–ª —Ç–∞–±–ª–∏—Ü—ã –≤ —Ç–µ–ª–µ–≥—Ä–∞–º —á–∞—Ç –∏ –∏–∑ —á–∞—Ç–∞ –≤ –≥—É–≥–ª —Ç–∞–±–ª–∏—Ü—É.\n–î–æ—Ä–∞–±–æ—Ç–∞—Ç—å –º–æ–∂–Ω–æ –µ—â–µ –º–Ω–æ–≥–æ —á–µ–≥–æ –Ω–∞ –≤–∞—à –≤–∫—É—Å –∏ —Ü–≤–µ—Ç, –≤–Ω–µ—Å—Ç–∏ –≤—Å—è–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –ø—Ä–æ—á–µ–µ. \n–°—Å—ã–ª–∫–∞ \n–Ω–∞ –º–æ–π –±–æ—Ç, –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –∫–≤–∏–∑–∞. –ß–µ—Ä–µ–∑ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è –≤—ã–ª–æ–∂—É –≤–µ—Å—å –∫–æ–¥ —Å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∫–Ω–æ–ø–æ–∫.\n \n ",
    "tags": [
        "spreadsheet",
        "spreadsheets",
        "telegram",
        "telegrambot",
        "telegram bot",
        "telegram bots",
        "telegram api",
        "javascript",
        "api",
        "json"
    ]
}