{
    "article_id": "726718",
    "article_name": "Будни техпода. Поднимаем VPN на VDS сервере",
    "content": "\r\nВ последнее время достаточно сильно выросла популярность различных VPN сервисов, и думаю, почти каждый, так или иначе, сталкивался с необходимостью получить доступ к тому или иному ресурсу, который по какой-либо причине недоступен на территории РФ. Да, есть множество бесплатных решений, которые позволяют спрятать свой IP адрес или получить доступ к нужному ресурсу, но, как говорится, «бесплатный сыр только в мышеловке», и такие сервисы, для обеспечения своего существования спокойно могут продавать всю информацию, содержащуюся в вашем трафике.\n\r\n\n\r\nВ связи с этим нам в поддержке также не удалось избежать вопросов о возможности поднятия своего VPN на наших серверах. Выделить хотел бы два вопроса: 1. IP-адрес будет принадлежать только мне, и другие пользователи не смогут его использовать? 2. Возможно ли с помощью VPN настроить доступ к корпоративной информации компании. Чтобы доступ был лишь с определённых IP? На оба вопроса ответ положительный. Одной из особенностей VDS сервера является то, что серверу присваивается статический IP-адрес, и на протяжении всего использования, он меняться не будет. Адрес может быть присвоен только одному серверу, так что другие пользователи, пока существует ваш сервер, не смогут им воспользоваться. То есть, и VPN настроенный на вашем VDS сервере всегда будет иметь один и тот же IP адрес.\n\r\n\n\r\n\nДругие статьи серии «Будни техпода»\n\r\n\n\r\n\nПробрасываем USB наĸопитель через RDP соединение\n\r\n\nРазворачиваем Android на Hyper-V\n\r\n\nПодготовка сервера с Linux для работы по RDP\n\r\n\nРазворачиваем сайт из конструктора на vds за 130 рублей\n\r\n\nРазмещение игрового сервера на VDS\n\r\n\nПоднимаем VPN на VDS сервере\n ← Вы здесь\n\r\n\n\r\nПри желании можете рассмотреть вариант ручной настройки, например, OpenVPN на linux, подробная инструкция об этом есть в нашем \nсправочнике\n, но мы для удобства подготовили два готовых шаблона с предустановленными VPN (L2TP на Windows Server 2019 и StrongSwan IKEv2/IPSec на Debian 11), чтобы упростить процесс настройки и позволить даже самым неопытным пользователям получить свой личный VPN-сервер. Больше всего вопросов приходят от пользователей MacOS и Windows, поэтому настройку на этих системах рассмотрим в первую очередь. Также рассмотрим установку на Android и IOS.\n\r\n\n\r\n\nЗаказ сервера на основе шаблона VPN L2TP\n\r\nДля начала нам необходим сам VDS-сервер. Создать его можно через \nконфигуратор\n на нашем сайте, после регистрации и авторизации, нажав на кнопку «\nЗаказать\n».\n\r\n\n\r\n\n\r\nВ первую очередь нам необходимо выбрать расположение сервера (в моём случае это дата-центр \nTelehouse, Франкфурт\n). Далее выбираем саму конфигурацию (минимальной конфигурации: 1 CPU, 1 RAM и 20гб HDD, как правило, достаточно для работы VPN). В качестве операционной системы выбираем шаблон сервера — \nVPN L2TP — Windows Server 2019\n. Выбираем срок аренды сервера и жмём «оплатить» (вы можете также воспользоваться нашим промокодом \nHABR15\n, чтобы получить дополнительную \nскидку в 15%\n, которая суммируется со всеми остальными скидками).\n\r\n\n\r\n\n\r\nДожидаемся завершения установки сервера и переходим во вкладку «\nМои серверы\n», где мы сможем увидеть сам сервер, а также посмотреть данные для подключения к нему. Нас интересуют IP адрес сервера, логин и пароль.\n\r\n\n\r\n\n\r\n\n▍ Настройка и подключение к VPN L2TP в Windows\n\r\nВ случае с Windows (Windows 10 / Windows 11), настройка производится во вкладке \n«Параметры» — «Сеть и Интернет» — «VPN»\n.\n\r\n\n\r\n\n\r\nВыбираем пункт «\nДобавить VPN\n».\n\r\n\n\r\n\n\r\nВ открывшемся окне нам необходимо указать параметры VPN, а также данные для подключения: \nИмя подключения — Имя нашего VPN\n, \nИмя или адрес сервера — IP-адрес нашего VDS сервера\n, \nТип VPN — «L2TP/IPsec с общим ключом». Общий ключ — «\nvpn\n». Данные для входа — логин и пароль от нашего VDS сервера\n. Жмём «\nСохранить\n».\n\r\n\n\r\n\n\r\nГотово. VPN добавлен и теперь к нему можно подключиться. Сделать это можно через трей, находящийся в правом нижнем углу. Открываем его и выбираем «\nВиртуальная сеть (VPN)\n».\n\r\n\n\r\n\n\r\nВыбираем нужный нам VPN и жмём кнопку «\nПодключиться\n».\n\r\n\n\r\n\n\r\n\n▍ Настройка и подключение к VPN L2TP на MacOS\n\r\nВ случае с MacOS настройка VPN подключения происходит в настройках. Переходим в раздел VPN, жмём кнопку \n«Добавить конфигурацию VPN»\n и в выпадающем меню выбираем \n«L2TP через IPsec»\n.\n\r\n\n\r\n\n\r\nВ открывшемся окне указываем следующие данные: \nОтображаемое имя — имя VPN подключения, Адрес сервера — IP-адрес нашего VDS сервера, Логин и пароль от нашего сервера, а также аутентификация компьютера через Общий ключ — «\nvpn\n»\n. Заполняем все данные и жмём кнопку «\nСоздать\n».\n\r\n\n\r\n\n\r\nVPN успешно настроен и теперь к нему можно подключиться.\n\r\n\n\r\n\n\r\nТакже VPN-подключение можно вынести в пункт управления, для более быстрого доступа. Для этого переходим в \n«Настройки» — «Пункт управления»\n, находим «\nVPN\n» и выбираем \n«Показывать в строке меню»\n.\n\r\n\n\r\n\n\r\nТеперь VPN отображается в верхней части экрана, и к нему можно быстро подключиться.\n\r\n\n\r\n\n\r\n\n▍ Настройка VPN L2TP на IOS\n\r\nВ случае с IOS процедура настройки VPN схожа с MacOS, и производится также через меню «Настройки». Переходим в \n«Настройки» — «Основные» — «VPN и управление устройством»\n.\n\r\n\n\r\n\n\r\nВ открывшемся меню выбираем \n«Добавить конфигурацию VPN»\n.\n\r\n\n\r\n\n\r\nВводим следующие данные: \nТип — «L2TP», Описание — имя нашего VPN подключения, Сервер — IP-адрес нашего VDS сервера, логин и пароль от сервера, а также общий ключ — «\nvpn\n»\n. Жмём «\nГотово\n».\n\r\n\n\r\n\n\r\nПодключение успешно создано. Выбираем его и жмём на кнопку включения.\n\r\n\n\r\n\n\r\n\n▍ Настройка VPN L2TP на Android\n\r\nВ случае с Android расположение настроек VPN может немного отличаться, в зависимости от модели телефона. В этом примере будет использоваться «Huawei Nova 3». Открываем «\nНастройки\n» и находим пункт «\nБеспроводные сети\n».\n\r\n\n\r\n\n\r\nВ открывшемся меню выбираем пункт «\nVPN\n», а затем жмём «\nДобавить сеть VPN\n».\n\r\n\n\r\n\n\r\nВо вкладке \n«Изменение сети VPN»\n нам необходимо указать следующие ключевые параметры: \nТип — «L2TP/IPSec PSK», Сервер — IP-адрес нашего VDS сервера, Общий ключ IPSec — «\nvpn\n»\n. Жмём «\nСохранить\n».\n\r\n\n\r\n\n\r\nВыбираем созданное нами подключение в списке, и в открывшемся окне вводим логин и пароль от нашего vds сервера. Сохраняем и подключаемся к серверу.\n\r\n\n\r\n\n\r\nГотово. VPN успешно настроен и им можно пользоваться.\n\r\n\n\r\n\nЗаказ сервера на основе шаблона StrongSwan IKEv2/IPSec\n\r\nТеперь рассмотрим второй, предоставляемый нами вариант с VPN. По аналогии VPN L2TP, заказываем сервер через \nконфигуратор\n, а в качестве операционной системы выбираем шаблон сервера «\nStrongSwan IKEv2/IPSec — Debian 11\n».\n\r\n\n\r\n\n\r\nДожидаемся завершения установки сервера и переходим во вкладку «\nМои серверы\n», где мы сможем посмотреть IP адрес нашего сервера, а также логин с паролем.\n\r\n\n\r\n\n\r\nДля дальнейшей настройки нам необходимо в адресную строку браузера ввести следующий адрес (необходимо указать IP, который отображается во вкладке «\nМои серверы\n»):\n\r\n\n\r\n\nhttps://IP_VDS_сервера:5000\n\r\n\n\r\nВ открывшемся окне авторизации вводим логин и пароль от сервера, которые также доступны во вкладке «\nМои серверы\n».\n\r\n\n\r\n\n\r\nПосле ввода данных авторизации откроется окно настроек. Нажимаем на «произвести инициализацию» чтобы сервер автоматически применил все необходимые настройки и сгенерировал сертификаты.\n\r\n\n\r\n\n\r\nПосле завершения всех этапов настройки у нас появится доступ к файлам конфигурации, необходимым для настройки VPN, а также логин и пароль. В случае с Windows нам необходимо скачать только \n«корневой сертификат crt»\n.\n\r\n\n\r\n\n\r\n\n▍ Настройка и подключение к VPN IKEv2 в Windows\n\r\nПеред началом настройки VPN нам необходимо установить сертификат. Запускаем ранее скачанный файл, и в открывшемся окне нажимаем \n«Установить сертификат»\n\r\n\n\r\n\n\r\nВ открывшемся окне \n«Мастер импорта сертификатов»\n нам необходимо выбрать \nРасположение хранилища — локальный компьютер.\n\r\n\n\r\n\n\r\nЗатем необходимо нажать кнопку «Обзор» и вручную указать хранилище — \n«Доверенные корневые центры сертификации»\n.\n\r\n\n\r\n\n\r\nСоглашаемся с последующими шагами, нажимая «Далее» и затем «Готово». Теперь можно приступить к настройке самого VPN. Аналогично прошлому методу, настройка производится через меню \n«Сеть и Интернет» — «VPN»\n. Жмём кнопку «\nДобавить VPN\n».\n\r\n\n\r\n\n\r\nВ открывшемся окне указываем: \nИмя подключения — Имя нашего VPN, Имя или адрес сервера — IP-адрес нашего VDS, Тип VPN — «IKEv2», а также логин и пароль\n. Сохраняем и готово.\n\r\n\n\r\n\n\r\n\n▍ Настройка и подключение к VPN IKEv2 на MacOS\n\r\nВ случае с MacOS, для настройки VPN нам необходимо скачать профиль конфигурации «\nmobileconfig\n».\n\r\n\n\r\n\n\r\nЗапускаем данный файл, а затем переходим в \n«Настройки» — «Конфиденциальность и безопасность» — «Профили»\n.\n\r\n\n\r\n\n\r\nВыбираем появившийся в данной вкладке профиль и устанавливаем его.\n\r\n\n\r\n\n\r\nГотово, vpn подключение успешно создано. В момент написания этой статьи я обратил внимание, что в некоторых последних версиях MacOS, у VPN могут возникать ошибки с подключением, при использовании сертификата для авторизации. В этом случае можно немного изменить настройки VPN подключения, и для авторизации использовать данные, которые были сгенерированы при инициализации. Для этого переходим в \n«Настройки» — «VPN»\n и выбираем наше VPN подключение. В настройках этого VPN подключения меняем пункт «\nАутентификация\n» на «\nИмя пользователя\n» и вводим логин и пароль.\n\r\n\n\r\n\n\r\nТеперь проблем возникать не должно. Если потребуется удалить это подключение, тогда вновь переходим во вкладку «\nПрофили\n» и удаляем установленный ранее профиль.\n\r\n\n\r\n\n▍ Настройка VPN IKEv2 на IOS\n\r\nНастройка на IOS очень схожа с настройкой на MacOS. Нам потребуется тот же профиль конфигурации.\n\r\n\n\r\n\n\r\nСкачиваем его и переходим в \n«Настройки» — «Основные» — «VPN и управление устройством»\n. Здесь нам необходимо найти загруженный нами профиль.\n\r\n\n\r\n\n\r\nВыбираем его и жмём «\nУстановить\n». Нас попросят ввести \n«Имя пользователя для профиля»\n и «\nПароль\n». Это логин и пароль со страницы настроек. Вводим их и жмём «\nГотово\n».\n\r\n\n\r\n\n\r\nПодключение успешно создано и теперь перейдя в \n«Настройки» — «VPN»\n, мы сможем увидеть его и подключиться к нему.\n\r\n\n\r\n\n\r\n\n▍ Настройка VPN IKEv2 на Android\n\r\nДля настройки \nVPN IKEv2\n на Android, нам необходимо скачать \nVPN-клиент Strongswan\n, а также файл с профилем конфигурации для данного клиента. Сделать это можно, перейдя по соответствующим ссылкам на странице настроек.\n\r\n\n\r\n\n\r\nСкачиваем и устанавливаем приложение \n«strongSwan VPN Client»\n.\n\r\n\n\r\n\n\r\nТеперь нам необходим сам файл с профилем конфигурации. Выбираем его и в окне \n«открыть с помощью»\n выбираем скаченный VPN клиент.\n\r\n\n\r\n\n\r\nВ открывшемся окне импорта vpn профиля указываем логин и пароль от сервера, и жмём кнопку «\nIMPORT\n».\n\r\n\n\r\n\n\r\nГотово. Профиль добавлен и теперь можно его выбрать из списка и подключиться к нему.\n\r\n\n\r\n\n\r\n\n▍ Пара слов в заключение\n\r\nКак мы смогли увидеть, в настройке своего личного VPN сервера нет ничего сложного, а подключиться к нему возможно практически с любого устройства. В ситуациях, когда важно сохранить конфиденциальность передаваемой информации, или иметь VPN со статическим IP адресом, который будет принадлежать именно вам, личный VPN сервер будет намного удобнее и безопаснее, чем его аналоги.\n\r\n\n\r\n\nTelegram-канал с розыгрышами призов, новостями IT и постами о ретроиграх 🕹️\n \n ",
    "tags": [
        "ruvds_статьи",
        "будни_техпода",
        "vds",
        "vpn",
        "l2tp",
        "strongswan",
        "ruvds",
        "openvpn"
    ]
}