{
    "article_id": "728138",
    "article_name": "Мы тоже отправили сотрудникам компании фишинговое письмо",
    "content": "\"No system is safe\" –\nCommand & Conquer: Generals (2003)\nКак говорили китайские юниты в С&С: Generals \"No system is safe\" – все системы уязвимы. И люди уязвимы не меньше. Про фишинг вроде бы все знают, но он по-прежнему остаётся самым популярным и результативным методом получения доступов и данных. В частности в сезоны праздников или распродаж, когда атакующие особенно активны. \nКомпании нередко рассказывают на Хабре истории об отправке «учебных» фишинговых писем клиентам или сотрудникам. Мы тоже поделимся деталями предновогодней атаки на собственных сотрудников, о которой не знала даже команда реагирования безопасности (SOC). В статье вас ждёт процесс подготовки, схема атаки, а также поминутная хроника событий.\nДисклеймер\n:\n \nместами в тексте намеренно опущены детали и точные цифры/данные, чтобы не упрощать жизнь злоумышленникам. Мы знаем, что детали важны читателям Хабра и приводим интерпретированные данные, но всё же безопасность в первую очередь.\n   \nРешаем проверить уязвимость\nОдна из задач команды Application Security — поиск уязвимостей в продуктах компании. В ноябре 2022 года мы как раз нашли простую и эффективную для внешней атаки уязвимость. Сообщили о ней команде разработчиков, и заодно решили проверить потенциальные риски. \nДля атаки решили выбрать не классический вариант фишингового письма, а APT-атаку (Advanced Persistent Threat) – вид таргетированной кибератаки на конкретную компанию. Руководитель департамента безопасности согласился с идеей, но попросил сначала напомнить коллегам о существовании почтового фишинга как такового. Поэтому мы подготовили и раскатили на сотрудников обучающий курс по антифишингу в дополнение к существующим процедурам обучения согласно PCI DSS регламентам. \nВ итоге идея с фишинговым письмом позволила бы нам не только оценить масштаб уязвимости и её критичность, но заодно и:\nНапомнить коллегам, как распознать подозрительное письмо и что с ним делать.\nОценить эффективность обучения.\nПонять, насколько быстро мы узнаем об атаке и сможем устранить её последствия. \nУлучшить внутренние процессы реагирования.\nЗапускаем обучающий курс для сотрудников\nМатериал для курса по Антифишингу команда Application Security написала за день. Коллеги из Training & Development перенесли материалы на платформу обучения iSpring и раскатили их на сотрудников. Людям пришло письмо с просьбой пройти пятнадцатиминутный курс: в нём 15 слайдов и короткий интерактивный тест. До обозначенного дедлайна была неделя. \nКурс был назначен для 700 сотрудников, из них 35% прошли его до конца.\nВнутри курса мы рассказали как распознать фишинговое письмо и акцентировали внимание на том, что делать при его получении\nГотовим атаку\nПока сотрудники знакомились с материалами курса, мы готовили атаку. О ней в компании знали всего несколько человек: \nКоманда Application Security. \nIT Head департамента Security & Risk Management.\nCEO. \nКоманды реагирования, которым предстояло защищаться от атаки и расследовать её, о плане с фишинговым письмом ничего не знали. \nОдни из самых успешных APT-атак требовали и требуют не только хорошей технической подготовки, но и социально-инженерной. В идеале таргет (то есть атакуемый) должен ожидать похожее по смыслу письмо, и оно должно легко вписываться в его картину мира. \nВо время нашего эксперимента на дворе как раз был «высокий сезон» для атак: сотрудники должны были пройти курс по фишинговым письмам до 8 декабря. Отсюда появилось содержание письма: компания запускает внутренний магазин, а пока он в разработке, сотрудник может выбрать себе новогодний подарок. \nЦелью атаки была проверка уязвимости, параллельно сохранялась часть вводимых данных и cookies. Для чистоты эксперимента никакая внутренняя информация в подготовке не использовались: атакующие собрали информацию по внешним источникам, как это могли бы сделать настоящие злоумышленники. Команда Application Security не обращалась к корпоративным дизайнерам и не использовала корпоративный шаблон для писем. \nЧтобы сделать фишинговую атаку на сотрудников максимально таргетированной, понадобились:\nДизайн и текст для нескольких писем: разные группы людей получили одинаковые по смыслу, но чуть разные по содержанию письма.\nНесколько новых доменов и их поддоменов. Разным группам получателей письма приходили с разных доменов и от разных адресатов. Мы использовали привычные корпоративные слова, такие как info или hr. \nНесколько landing (посадочных) страниц, на которые вели ссылки из писем. На каждой из страниц была форма авторизации для сбора логинов и паролей. \nСвоя инфраструктура и сервис, который сохранял вводимые логины и пароли. При переадресации мы использовали найденную ранее уязвимость в продукте и собирали cookie. \nДашборд, который в режиме реального времени показывал, кто открыл письмо, кто перешёл по ссылке, кто ввёл данные. \nВот как выглядела схема атаки:\nКоманда Application Security:\nРазвернула фреймворк \nGophish\n на VPS-сервере.\nЗарегистрировала домен, созвучный с названием компании.\nСгенерировала SSL-сертификат и настроила SSL-соединение.\nСоздала разные фишинговые страницы в зависимости от «типа» пользователя.\nПриготовила всё необходимое для старта рассылки.\nОтправляем письмо и следим за ситуацией\nДнём атаки стало 8 декабря. Вот как развивались события.\n11:13. \nСотрудникам начинают приходить фишинговые письма. \n11:17.\n Первый человек пишет в публичный канал команды безопасности.\nЭто критически важный момент. Время от начала атаки до того, как о ней узнаёт команда безопасности, — это одна из основных метрик, Mean Time to Detect (MTTD). Не зная об атаке или инциденте, трудно среагировать на ситуацию и начать эффективное расследование.\nНа сокращение этой метрики направлены многие внутренние активности Security-команд. Мы создали для сотрудников понятный канал связи и безопасную среду без осуждения. У нас нет практики штрафов, напротив, мы максимально продвигаем решение делиться всем подозрительным как единственно верное.\n11:17.\n Дежурный инженер SOC сразу тегает свою команду, чтобы коллеги обратили внимание на ситуацию. Он также просит сотрудника, сообщившего о подозрительном письме, прислать его вложением в [специальное место].\n11:18.\n Ещё несколько сотрудников отписываются в треде, что получили похожее письмо, и пересылают примеры, в которых видны различные отправители. \n11:19.\n Команда SOC спрашивает в треде всех сотрудников, ответственных за коммуникации в компании, их ли это активность. В течение пары минут все отписываются, что нет, это не наше.\nПараллельно с этим ещё несколько сотрудников сообщают, что открыли письма и перешли по ссылке, но не вводили данные. Они просят изменить их пользовательские учетные данные (пароль). \n11:20.\n Инженер SOC присылает первую инструкцию в том же треде: всем убедиться, что на устройстве установлен корпоративный антивирус, установить его, если нет, и самостоятельно сменить пароль к корпоративной учётке по указанной ссылке. \nВажно! В этот момент количество открытий письма и переходов по ссылке заметно упало.  \n11:21.\n Представитель SOC пишет в общий чат компании, где есть все сотрудники, сообщение о подозрительном письме с инструкцией не переходить по ссылкам и немедленно сменить пароль от корпоративной учетной записи, если вдруг по ссылке перешли. Аналогичное сообщение отправляется всем на корпоративные почты на случай, если человек пропустит уведомление в Slack.\n17:12.\n Внутренние коммуникации отправляют в общий чат сообщение о том, что атака была тренировочной, и напоминанием пройти курс по распознаванию фишинговых писем.  \nАнализируем результаты\nМы планировали отправить все письма за 3-5 минут, но из-за публичного сервера-посредника время доставки чуть растянулось. Поэтому финальные цифры по эксперименту будут не совсем релевантными: часть сотрудников сначала увидела сообщения SOC, а только потом фишинговое письмо. Конечно, ни на какие ссылки они при этом не кликали и никакие учетные данные не оставляли. \nВ статье мы можем привести только интерпретированные данные: \nМы отправили 666 писем.\n2/3 сотрудников перешли по ссылке из фишингового письма и ввели свои учетные данные.\nНесколько человек попробовали ввести другие логины и пароли (вероятно, предыдущие или от других сервисов), когда не получилось авторизоваться в форме на посадочной странице.\nНикто из сотрудников, прошедших курс, свои данные не вводил.\nИ, конечно, уязвимость в продукте мы исправили. \nКраткие выводы\nОбучение сыграло свою важную роль: команда SOC узнала о подозрительном письме спустя 5 минуты от его отправки и начала действовать. \nКоммуникации действительно помогают. После появления первого сообщения и инструкций в общих чатах произошёл «иммунологический ответ»: резкий спад количества кликов и попыток авторизоваться на лендинге. \nПосле такого публичного кейса сотрудники стали чаще сообщать о своих подозрениях насчет писем на почте. \nКонтролируемая атака позволила нам найти несколько слабых мест в процессах реагирования и улучшить их.  \nОбучение оказало позитивное влияние на сотрудников. Часть коллег, которые не проходили курс по фишингу до тренировочной APT-атаки, завершили его после. \nЛюди, которые прошли обучение, смогли своим примером показать важность прохождения курса, создавая критическую массу влияния в момент атаки. \nНапомним о дисклеймере ещё раз:\n местами в тексте намеренно опущены детали и точные цифры/данные, чтобы не упрощать жизнь злоумышленникам. Мы знаем, что детали важны читателям Хабра и приводим интерпретированные данные, но всё же безопасность в первую очередь.   \n \n ",
    "tags": [
        "безопасность в сети",
        "безопасность данных",
        "безопасность",
        "фишинг",
        "фишинговые атаки",
        "фишинговые письма"
    ]
}