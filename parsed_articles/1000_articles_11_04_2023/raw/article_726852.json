{
    "article_id": "726852",
    "article_name": "Получаем бесплатные бесконечные сессии TeamViewer",
    "content": "\r\nМногие знают о существовании такого ПО, как TeamViewer, но не все в курсе о нестандартных сценариях его использования. Знали ли вы, что можете легально использовать сессии, неограниченные во времени? Это осуществимо благодаря возможности TeamViewer подключаться не только с использованием уникального ID, но и по IP-адресу.\n\r\n\n\r\n\nРассуждения, что лучше использовать что-то другое, а не TeamViewer, оставим за бортом, здесь просто рассматриваются возможности TeamViewer. Насколько имеет смысл практического применения изложенных методов, каждый пусть решит сам.\n\r\n\nМы всячески предостерегаем вас от включения данной опции на компьютерах, имеющих «белый» IP-адрес. Во всяком случае, если вам очень захочется это сделать, позаботьтесь о защите подключения сложным паролем и ограничении источников с помощью файрвола.\n\r\n\n\r\nВключается такая возможность следующим образом: нужно перейти в настройки и разрешить входящие подключения по локальной сети. General → Network settings → Incoming LAN Connections: accept / Основное → Настройки сети → Входящие соединения (локальная сеть): принять. Мы также можем разрешить только такие подключения (accept exclusively / принимать исключительно).\n\r\n \n\r\n\nРис. 1: Разрешаем подключения по локальной сети\n\r\n\n\r\nTeamViewer даже покажет локальные адреса, но только вместо TeamViewer ID, если разрешить исключительно подключения по локальной сети.\n\r\n \n\r\n\nРис. 2: Список локальных адресов\n\r\n\n\r\nКонечно, это можно использовать, если компьютеры находятся в одной локальной сети. А что же делать, если это не так? Можно объединить компьютеры в виртуальную локальную сеть. Мы воспользуемся технологией ZeroTier. Для демонстрации закажем пару серверов на Windows и сервер, который будет служить контроллером сети. Заказывать будем у \nхостера RUVDS\n, потому что у них есть готовый образ ZeroTier Network Controller, а за лицензию Windows доплачивать к стоимости сервера не нужно. Можно, конечно, использовать ZeroTier Central, но мы будем использовать преимущества собственного контроллера.\n\r\n \n\r\n\nРис. 3: Готовый образ ZeroTier Network Controller\n\r\n\n\r\nОдин сервер будем использовать как компьютер, которым мы хотим управлять (назовём его «server»), а другой (назовём его «admin-ws») — как компьютер, с которого мы будем управлять вышеуказанным. Можно, конечно, подключить к виртуальной сети свой домашний компьютер, но пусть у нас будет выделенная тестовая среда.\n\r\n \n\r\n\nРис. 4: Вид на серверы из личного кабинета\n\r\n\n\r\nПервоначальная настройка контроллера описана в данной статье, поэтому заострять внимание на ней не будем и перейдём к присоединению клиентов к сети.\n\r\n\n\r\nНа каждом компьютере установим TeamViewer и клиент ZeroTier. После установки увидим в трее жёлто-оранжевый значок ZeroTier, по клику откроется меню, в котором нам нужно выбрать Join New Network…\n\r\n \n\r\n\nРис. 5: Меню клиента ZeroTier\n\r\n\n\r\nЕсли однажды подключиться к сети, компьютер будет подключаться к ней всегда. За подключение отвечает служба ZeroTierOneService с автоматическим запуском. Пункты меню прозрачно говорят о том, что при выходе мы закроем UI, а не завершим работу клиента. По умолчанию приложение ZeroTier Desktop UI после входа в систему автоматически не запускается.\n\r\n\n\r\nТакже вид значка никак не отображает статус подключения. Мы всё же рекомендуем включить автоматический запуск данного интерфейса, чтобы не забыть, что у нас установлен клиент ZeroTier и что компьютер может быть подключён к какой-либо сети.\n\r\n\n\r\nВ открывшемся окошке вводим ID созданной нами сети и нажимаем Join.\n\r\n \n\r\n\nРис. 6: Ввод идентификатора сети\n\r\n\n\r\nВ веб-интерфейсе контроллера в списке участников появятся наши устройства. Чтобы разрешить подключение, нужно отметить чекбокс Authorized. Для удобства можно задать устройствам имена.\n\r\n \n\r\n\nРис. 7: Список устройств\n\r\n\n\r\nОстаётся разрешить локальные подключения в TeamViewer на стороне сервера (компьютер «server») (см. рис.1). Теперь на клиентской машине («admin-ws») вводим локальный адрес устройства «server» и подключаемся.\n\r\n \n\r\n\nРис. 8: Подключение к устройству\n\r\n\n\r\nПосле ввода учётных данных получаем доступ к управлению устройством.\n\r\n \n\r\n\nРис. 9: Успешно подключились\n\r\n\n\r\nЗдесь мы использовали Windows-авторизацию при подключении. Это также включается в настройках (Security → Rules for connection to this computer → Windows Logon: Allowed for administrators only, Allowed for all users / Безопасность → Правила для подключения к этому компьютеру → Вход в Windows: Разрешено только для администраторов, Разрешено для всех пользователей). В том же разделе в пункте Random password (for spontaneous access) / Случайный пароль (для произвольного доступа) можно изменить сложность автоматически генерируемого пароля для TeamViewer-авторизации с помощью настройки Password strength / сложность пароля. Есть варианты 6, 8, 10 символов и Disabled (no random password) / Отключено (без случайного пароля). \n\r\n \n\r\n\nРис. 10: Включение авторизации Windows\n\r\n\n\r\nЕщё можно задать постоянный пароль для авторизации TeamViewer в расширенных настройках (Advanced → Personal password / Дополнительно → Личный пароль).\n\r\n \n\r\n\nРис. 11: Постоянный пароль для TeamViewer-авторизации\n\r\n\n\r\n\n▍ Приложение А. Немного о полезных функциях TeamViewer\n\r\nКто хоть раз пользовался TeamViewer, знает, что при подключении на клиентском устройстве скрывается фон рабочего стола. Делается это, скорее всего, ради экономии трафика. Если вы хотите вернуть его обратно, можно сделать это через верхнее меню, убрав соответствующую «галочку» (View → Hide wallpaper / Просмотр → Скрыть обои). Но при следующем подключении фон опять скроется.\n\r\n \n\r\n\nРис. 12: Разовая настройка скрытия фона\n\r\n\n\r\nЧтобы фон никогда не скрывался, нужно на стороне клиента убрать отключение фона (Remote control → Display → Remove remote wallpaper / Удалённое управление → Отобразить → Скрыть обои на удалённой машине).\n\r\n \n\r\n\nРис. 13: Постоянная настройка скрытия фона\n\r\n\n\r\nКогда мы отключаемся, удалённый компьютер блокируется, если был заблокирован, и не блокируется, если не был заблокирован. Можно отключиться, явно выбрав, нужно ли блокировать удалённое устройство (Actions → End Session → End session and lock remote computer / Действия → Окончание сеанса → Завершить сеанс и заблокировать удалённый компьютер).\n\r\n \n\r\n\nРис. 14: Выбор блокировки при отключении\n\r\n\n\r\nТакже можно однократно задать, что произойдёт при отключении (Actions → Lock → Lock on session end / Действия → Включить блокировку → Включить блокировку по завершении сеанса).\n\r\n \n\r\n\nРис. 15: Разовая настройка блокировки при отключении\n\r\n\n\r\nПерманентно поведение при отключении можно задать в расширенных настройках (Advanced → Advanced settings for connections to other computers: Always, Never / Дополнительно → Дополнительные настройки для подключения к другим компьютерам / Включить блокировку удалённого компьютера: Всегда, Никогда).\n\r\n \n\r\n\nРис. 16: Постоянная настройка блокировки при отключении\n\r\n\n\r\nВ разделе действий можно посмотреть информацию об удалённой системе (Actions → Remote system info… / Действия → Информация об удалённой системе). Тут нам покажут модель процессора, объём ОЗУ, дисков и основные параметры сетевых адаптеров.\n\r\n \n\r\n\nРис. 17: Информация об удалённой системе\n\r\n\n\r\nПользователи TeamViewer знают, что с его помощью можно передавать файлы (Files & Extras → Open file transfer / Файлы и дополнительные возможности → Открыть передачу файлов).\n\r\n \n\r\n\nРис. 18: Открытие диалога передачи файлов\n\r\n\n\r\nОднако открыть диалог передачи файлов можно, не подключаясь к экрану удалённого устройства. Для этого в главном окне нужно выбрать соответствующий пункт из выпадающего списка (Remote control, File transfer / Удалённое управление, Передача файлов).\n\r\n \n\r\n\nРис. 19: Подключение только для передачи файлов\n\r\n\n\r\n\n▍ Приложение Б. TeamViewer и перенаправление портов\n\r\nДля входящих подключений TeamViewer слушает TCP-порт 5938. Мы можем перенаправить трафик с порта X устройства A на порт 5938 устройства B. Притом порт X может отличаться от порта 5938. В таком случае при подключении нужно будет указать адрес устройства X и порт обычным способом — через двоеточие.\n\r\n \n\r\n\nРис. 20: Указание порта при подключении к устройству\n\r\n\n\r\nТаким образом мы можем перенаправить несколько портов на несколько устройств и сможем подключаться к каждому устройству, указывая один и тот же адрес, но разный порт.\n\r\n \n\r\n\nРис. 21: Пример проброса портов\n\r\n\n\r\nTeamViewer также использует во время соединения протокол UDP. Этот вопрос никак не изучался и порты UDP не пробрасывались, проблем при использовании соединения только по протоколу TCP выявлено не было.\n\r\n\n\r\n\nTelegram-канал с розыгрышами призов, новостями IT и постами о ретроиграх 🕹️\n \n ",
    "tags": [
        "ruvds_статьи",
        "teamviewer",
        "удалённый доступ",
        "бесконечные сессии"
    ]
}