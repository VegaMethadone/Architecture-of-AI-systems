{
    "article_id": "727916",
    "article_name": "Цель есть, пришло время подумать о том, какой софт поставить на NAS",
    "content": "В данной статье мы попробуем исследовать альтернативные варианты использования \nNAS\n.\nТакже мы попытаемся составить расширенный план тестирования на первых NAS, собранных на китайских процессорах \nRK3588\n и на основе \nх86\n архитектуры. \nМы уже приняли решение, что базовым софтом для нашего NAS будет \nOMV\n на \nArmbian\n. На этом стеке мы будем проводить тесты и замерять бенчмарки. Его мы будем оптимизировать под наше железо. Для него же в первую очередь будут составляться мануалы. \nНо ресурсов нашего устройства хватит не только на организацию сетевого хранилища, но и на \nмедиасервер\n, запускалку докеров, контроллер умного дома, VPN и прочее. \nМедиасервер\nНесмотря на относительно невысокую стоимость стриминговых сервисов и огромное количество сайтов с пиратским контентом, доступным онлайн, собственный медиасервер так и не потерял актуальность. Он позволяет не только смотреть кино и сериалы в 4К, комфортной озвучке и без рекламы, но и устраивать просмотр своего контента, хранящегося на NAS. Да и возможность сэкономить несколько сотен рублей в месяц на подписке - приятный бонус.\nМы планируем проверить работоспособность наиболее популярных бесплатных решений: \nKodi\n, \nPlex\n, \nEmby\n. Особенно интересно, как подробная нагрузка отразится на целевых функциях нашего девайса, и сколько пользователей смогут одновременно пользоваться медиа-сервером.\nОтдельной задачей стоит автоматическое перекодирование загруженного медиа (привет тем, кто высылает в Телеграмме двухминутные 4К ролики, размером в гигабайт).\nЕсть сервисы с уклоном в управление фотографиями, например \nPhotopPrism\n. Программа заботливо упакована в плагин для OMV. Но сложности могут возникнуть на этапе использования AI функций, вроде распознавания лиц и автоматической группировки фотографий по темам. Не ясно, будет ли эта функциональность работать на GPU \"из коробки\". Но приложение действительно интересное, и, в случае неполадок, нужно будет отдельно с ним поработать.\nСвоё облако\nНа мой взгляд, \nNextCloud\n или \nOwnCloud\n являются главными альтернативами OMV на нашем устройстве (хоть я и не очень понимаю текущий статус проекта OwnCloud). Это отличное решение как для дома, так и для небольшой организации. Оба продукта предлагают широкий набор инструментов не только для обмена файлами, но и для удобной совместной работы. Они предлагают почту, календарь, пакет офисных программ, чаты и звонки. Кроме этого есть приложения для Android и IOS.\nНас интересует в первую очередь два аспекта:\nЗапустится ли Cloud на нашем устройстве? Потребуется ли что-то портировать?\nКакое количество пользователей смогут комфортно работать, без тормозов и падений?\nПо первому пункту мы не ожидаем серьезных сложностей, так как в \nсписке устройств\n, которые предлагает NextCloud, есть устройства на ARM, есть проект \nNextCloudPi\n, гуглятся инструкции по запуску OwnCloud на Raspberry Pi и других одноплатниках. \nСложнее со вторым пунктом. Синтетические тесты дают искажённое представление о возможностях устройства. А реалистичные нагрузочные тесты - это непростая задача. Не хотелось бы пообещать комфортную работу команды из двадцати человек и сесть в лужу.\nБаза знаний, таск трекер, хостинг кода\nВ продолжении идеи \"NAS для малого бизнеса\" мы бы хотели проверить и обкатать другие инструменты для организации работы небольшой команды. Интересно, получится ли поселить \nGitlab\n или \nGitea\n рядом с OMV. Будет ли это работать для команды хотя бы из пяти человек? Наша команда как раз использует Gitlab. Мы могли бы перевести один из наших внутренних проектов на тестовый прототип и через месяц-другой собрать реальные отзывы. Поставить эксперимент на живых людях, так сказать. \nНо не обязательно ориентироваться на универсальный инструмент для работы команды. Я давно хочу завести себе self hosted записную книжку, вроде Evernote. Одно время пристально смотрел на \nJoplin\n, но руки так и не дошли. Заметных ресурсов он не потребляет, выглядит приятно, имеет приложения для Android и IPhone, синхронизацию можно настроить через WebDav.\nЛибо можно развернуть полноценную wiki. Какой конкретно инструмент взять для тестов пока что не ясно. Слишком прочно мы сидели на Confluence или Gitlab последнее время, и совершенно не в курсе, как сейчас носят системы хранения знаний. При быстром гуглении глаз зацепился за \nBookStack\n. С него и начнём.\nОсобое место в моём сердце занимает \nDraw.IO\n, который можно использовать не только в виде плагина для Confluence, но и развернуть на собственном сервере. Инструмент невероятно полезный, особенно в умелых руках. А ещё у сервиса есть интеграция с NextCloud.\nМикросервер-запускалка докеров\nСегодня фраза \"сервер на ARM\" уже не звучит странно. Контейнеры позволяют избежать ада с зависимостями. И хотя вычислительные мощности NAS вряд ли сравнятся с HP Microserver, Raspberry Pi 4 заменить мы сможем. Но в этом пункте нас интересует не только возможность запускать Docker-контейнеры, но и наличие удобных инструментов для управления и мониторинга, а также возможность этих сервисов \"уживаться\" с OMV. Мой взгляд упал на \nPortainer\n, как на наиболее интересное, и при этом достаточно простое решение. Он не привязан к Kubernetes, как Gefyra, open source и довольно активно развивается. Хотя, признаться, я в управлении контейнерами не очень силён. Наверняка есть и более простые решения.\nVPN\nВыставить свою домашнюю инфраструктуру голыми портами в дикий Интернет - не самая разумная идея. Невозможно уследить за актуальным списком уязвимостей всех своих сервисов, регулярно менять пароли и мониторить открытые порты, если это не основная работа. Не говорю уже о высокой вероятности допустить ошибку. Проще и надёжнее сделать домашние сервисы доступными только внутри VPN. \nOpenVPN\n, и \nWireGuard\n легковесны и не должны заметно грузить систему. А решения вроде \nNetBird\n помогут упростить конфигурацию.\nПоднимать VPN сервер на NAS кажется мне не очень оптимальной затеей. Разумнее запустить VPN на VPS, а подключение к VPN будет производить роутер. При корректной настройке маршрутизации все устройства в доме становятся доступны внутри приватной сети и не смотрят в Интернет напрямую. Это достаточно удобно и безопасно, но требует затраты на VPS и не самый простой роутер. VPN сервер на домашнем NAS обходится дешевле и может быть сильно проще в настройке при небольшом количестве девайсов дома. Именно для подобного использования мы собираемся произвести тесты и составить подробные инструкции с использованием наиболее популярного софта.\nКонтроллер умного дома\nА почему бы и нет? NAS, с большой долей вероятности, работает 24/7. Там бежит Linux и есть свободные USB порты. Вероятнее всего устройство подключено через UPS (тем более что у нас есть \nчто предложить\n). А большего от контроллера умного дома и не требуется. Осталось убедиться в работоспособности решения и изучить возможные побочки.\nTahoe\nЭтот вариант я упоминаю в последнюю очередь, но он отнюдь не последний по значению. Для нашей команды \nTahoe\n является одной из наиболее интересных альтернатив OMV. Некоторые участники проекта согласились присоединиться только при условии работы с Tahoe. Поэтому адаптация и тестирование распределённого файлового хранилища на нашем устройстве будет идти практически параллельно с работами по OMV. В комментариях к нашим предыдущим статьям я сталкивался со следующим тезисом: \"Некорректно называть собственный NAS заменой облачному хранилищу. Само устройство могут украсть, оно может сгореть при пожаре, утонуть при потопе, быть раздавленным при землетрясением и прочее. И никакой RAID от этого не спасет. Важные данные должны храниться и локально, и в облаке!\". Так вот, с помощью Tahoe-LAFS можно восстановить потерянные файлы даже после потери своего устройства. Tahoe позволяет объединить несколько NAS в единую сеть.  Каждый из участников сети дублирует данные других.  Могут быть различные конфигурации построения сети: от простого зеркалирования до конфигурации схожей с RAID5/6.  Tahoe это своего рода распределённый мета-RAID.  При достаточном количестве участников сети мы кратно повышаем сохранность данных.  Вторым, важным свойством Tahoe является то, что все данные всегда хранятся шифрованными.  Это позволяет хранить любые данные в сети без опаски, что их могут скомпрометировать, подменить или изменить. Решение децентрализовано, а значит нет зависимости от конкретного вендора и его ценовой политики. Хотя заплатить за распределённость всё таки придётся. Но подробнее об этом мы расскажем в следующих статьях.\nИтог\nВ конце хочется отметить, что мы ни в коем случае не собираемся распыляться и превращать NAS в универсальный комбайн, который плохо решает широкий спектр задач. Фокус всегда будет оставаться на хранении данных. Дополнительные сервисы неизбежно будут грузить железо, привносить новые уязвимости и конфликтовать с главной задачей нашего продукта. И использование NAS исключительно в качестве места для безопасного хранения данных кажется нам наиболее разумным решением.\nНо не в последнюю очередь этот проект существует ради фана. А что может быть лучше, чем провести пару вечеров в попытках скрестить бульдога с носорогом, а затем заставить товарищей использовать получившегося франкенштейна \"на благо общего дела\"? А помимо удовольствия эта деятельность принесёт более чёткое видение продукта и расширит кругозор.\nP. S.\nИнтересно было бы почитать про опыт использования перечисленного софта параллельно с OMV. Особенно на Raspberry Pi или Orange Pi.\nP. P. S.\nУ нашего проекта NAS канал в Телеграмме: \nhttps://t.me/UberNasNews\n. Приходите!\n \n ",
    "tags": [
        "nas",
        "ubernas",
        "openmediavault",
        "wireguard",
        "vpn",
        "armbian",
        "nas своими руками",
        "tahoe"
    ]
}