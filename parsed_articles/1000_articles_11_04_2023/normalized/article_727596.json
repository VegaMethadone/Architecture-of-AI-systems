{
    "article_id": "727596",
    "article_name": "SQL Server 2022: что можно сделать с VLF?",
    "content": "виртуальный файл журнал virtual log files  vlf  это внутренний разбиение реальный физический файл который создавать database engine sql server работа журнал транзакция vlf четко определенный размер количество физический файл являться фиксировать vlf создаваться компонент database engine время создание расширение файл журнал размер vlf рассчитываться динамически основа размер существующий журнал новый файл приращение vlf однако числиться дурной слава который заключаться слишком большой количество vlf вызывать ряд проблема среди который выделять существенный снижение скорость запуск база данные операция резервный копирование восстановление журнал vlf сгененрировать долго процесс восстановление база данные приводить превышение время ожидание ошибка связанный память целый ряд другой проблема оптимальный разделение vlf sql server 2022 виртуальный файл журнал vlf являться способ взаимодействие физический журнал транзакция sql server предыдущий версия файл журнал увеличиваться мало 18 текущий размер покрывать весь объем приращение создаваться vlf приращение оказываться создаваться несколько vlf зависимость размер приращение однако sql server 2022 внедрять новый подход приращение журнал маленький равный 64 мб создаваться vlf который покрывать целиком приращение 64 мб 1 гб создаваться 8 виртуальный файл увеличение 1 гб создаваться 16 виртуальный файл охват объем новый информация новый метод призывать оптимизировать создание vlf повышать производительность база данные мониторинг vlf пример ниже продемонстрировать sqlкод который использовать получение информация количество виртуальный файл журнал vlf база данные use yourdatabasename go dbcc loginfo этот команда выводить информация количество статус vlf текущий база данные выходной данные строка каждый vlf такой столбец fileid fileoffset status столбец status указывать являться vlf активный 2 неактивный 0 частично использовать vlf 1 также отслеживание количество vlf течение время использовать следующий sqlкод select name log_reuse_wait_desc database_id log_reuse_wait log_size_in_bytes10241024 as log_size_mb log_size_in_bytes10241024log_file_count as avg_vlf_size_mb  log_file_count from sysdm_db_log_space_usage запрос вернуть информация файл журнал использовать каждый база данные сервер включая количество vlf средний размер каждый vlf столбец log_reuse_wait_desc указывать почему файл журнал использоваться например изза ожидание резервный копия ожидание создание контрольный точка основа информация мочь определять база данные который слишком vlf другой проблема связывать использование файл журнал устранение проблема vlf ниже приводить пример sqlкода который призывать решать проблема слишком большой количество vlf sql server  уменьшать размер файл журнал транзакция вручную dbcc shrinkfilelogical file name of transaction log truncateonly  увеличивать размер файл журнал транзакция необходимый вручную alter database database name  modify file namelogical file name of transaction log  size  required size  выводить необходимость изменять параметр автоматический увеличение файл журнал транзакция alter database database name  modify file namelogical file name of transaction log  filegrowth  new growth size обращать внимание должный заменять logical file name of transaction log database name required size new growth size соответствующий значение ваш конкретный случай кроме упоминаться ранее выполнение любой этот операция убеждаться актуальный восстанавливать резервный копия хороший практика также стоить отмечать успевать сформировываться хороший практика управление vlf который должный следовать избегать проблема производительность среди этот практика выделять следующий размер файл журнал должный соответствовать ваш рабочий нагрузка избегать частый событие прирост устанавливать значение growth_increment меньший равный 64 мб уменьшать количество vlf создавать время рост журнал мониторить свой vlf регулярный основа использовать продемонстрировать sqlзапросы выявление проблема такой слишком большой количество vlf длительный время восстановление заключение сказать управление vlf  это критически важный аспект администрирование база данные sql server который значительно повлиять производительность база данные благодаря усовершенствование вносить sql server 2022 использование хороший практика администратор мочь оптимизировать разделение vlf сокращать количество приводить сокращение время запуск база данные ускорение операция резервный копирование восстановление повышение общий удобство конечный пользователь материал подготовить преддверие старт  онлайнкурс ms sql server developer",
    "tags": [
        "sq",
        "ms sql server",
        "vlf"
    ]
}