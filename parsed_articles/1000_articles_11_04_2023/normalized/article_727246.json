{
    "article_id": "727246",
    "article_name": "Чат-бот для mattermost",
    "content": "привет статья рассказывать  hhru  сделать удобный общение корпоративный wiki привычный формат коммуникация  написать чатбот поиск внутренний база знание тема оказываться довольно актуальный пригождаться основной средство коммуникация продуктовый команда   mattermost  качество база знание использовать  confluence  расширять поиск confluence иметь специфический интерфейс мы хотеться получать удобный быстрый способ расширенный поиск ускорение упрощение поиск наш обширный база знание принимать решение написать чатбот mattermost основной задача бот становиться вывод результат поиск личный чат пользователь бот писать python качество база решать использовать фреймворк mmpy_bot работа confluence использоваться confluenceapi короче mmpy_bot confluenceapi фреймворк mmpy_bot предоставлять возможность работа вызов api mattermost помощь собственный декоратор метод система подключать модуль реализовать логика бот  плагин также бот иметь встроенный вебхуксервер который помогать работа интерактив документация ознакомляться   собственно работа мы понадобиться декоратор   listen_to  отвечать обработка сообщение  listen_webhook  предназначать работа вебхук отправка сообщение драйвер бот метод create_post который создавать новый сообщение канал reply_to который отвечать отправка сообщение тред иметься сообщение быть использовать reply_to работа confluence быть использовать  фреймворк  который мы понадобиться метод confluencecql отвечать отправка обработка cql запрос сервер confluence запуск настройка бот начинать писать бот мы создавать токен mattermost confluence получение токен необходимо создавать 2 файл   mmbotpy  который запускать бот подключать наш плагин  pluginpy  описывать логика работа бот начинать наиболее простой  инициализация бот показывать код import json import sys  from mmpy_bot import bot settings from plugin import searchplugin  try  with openconfigjson r encodingutf8 as config settings  jsonloadsconfigreadwikisearchbot except ioerror as e printfunable to read config reason e sysexit1  bot  bot settingssettings mattermost_urlsettingsmattermost_host mattermost_portsettingsmattermost_port mattermost_api_pathapiv4 bot_tokensettingsmattermost_token bot_teamsettingsteam_name ssl_verifyfalse webhook_host_enabledtrue webhook_host_urlsettingswebhook_host webhook_host_portsettingswebhook_self_port  pluginssearchplugin  botrun давать разбираться происходить сам начало считывать настройка наш бот json конфига конфиг выглядеть следующий образ показывать код  mattermost_host httpsадрессервераматтермост mattermost_port портсервераматтермост mattermost_token токен_бот_mattermost team_name имя команда webhook_host httpадресхоста webhook_self_port 8579 webhook_external_port 8579 confluence_url httpsадресбазызнаний confluence_token токен_бот_confluence    далее создавать объект наш бот указывать параметр название параметр очевидно отвечать нужный дополнительно следовать отмечать блок параметр webhook_  предназначать работа встроенный вебхуксервер поздно инициализация объект происходить запуск бот вызов метод run бот запускать команда консоль  python mm_botpy  алгоритм работа бот итак инструмент выбирать бот настраивать работа продумывать логика взаимодействие бот алгоритм работа начинать простой общаться бот быть личный сообщение  путем отправка сообщение ключевой слово необходимо написать соответствующий обработчик наш плагин бот  файл  pluginpy  однако пользователь знать наличие ключевой слово поэтому нужно написать обработка любой сообщение который включать ключевой слово методобработка выводить небольшой информационный подсказка использование бот начинать наш метод размещать декоратор  listen_to  указывать бот слушать канал который добавлять появление сообщение указанный качество параметр декоратор текущий пример  этот регулярный выражение обрабатывать любой сообщение кроме находить количество параметр декоратор варьироваться зависимость количество capture group регулярка показывать код listen_toнайди reignorecase async def helloself message message status         blocks               section                 titlefприветствую                 textfя осуществлять поиск база знание wikiconfluence_url поиск осуществляться публичный страницампчтоба начинать поиск использовать слово находить ваш запрос пример находить цель план                                   mes_json  attachments blockasdict for block in blocks         selfdriverreply_tomessage  propsmes_json  необходимый пояснение самый метод происходить чтото непонятный самый дело лишь формироваться  интерактивный сообщение  удобство формирование такой сообщение создавать датаклассы показывать код dataclass class field title str value str short bool  true  dataclass class section title optionalstr  none text optionalstr  none fields optionallistfield  none  def asdictself res   if selffields resfields  asdictfield for field in selffields if selftitle restitle  strselftitle if selftext restext  strselftext  return res давать добавлять информационный сообщение данные настройка бот поиск умолчание показывать код listen_toнайди reignorecase async def helloself message message status         blocks               section                 titlefприветствую                 textfя осуществлять поиск база знание wikiconfluence_url поиск осуществляться публичный страницампчтоба начинать поиск использовать слово находить ваш запрос пример находить цель план                 fieldslistfilternone                      fieldtitleпоиск осуществляться предустановленный настройка value shortfalse                     fieldtitleпространства valueqa dev                     fieldtitleпериод valueпоследний год                     fieldtitleсодержимое valueстраница                                   mes_json  attachments blockasdict for block in blocks         selfdriverreply_tomessage  propsmes_json пользователь проинформировать реализовать поиск база знание написать обработчик ключевой слово находить показывать код     listen_toнайди  reignorecase     async def searchself message message text_to_search         search_result           loginfofзапрошен поиск text_to_search         search  searchsearch_texttext_to_search         query  searchquerysearch_texttext_to_search          label_response  search_by_labeltext_to_search         find_response  selfqueryquery          if label_response               label_search_result  label_response             for res in find_responseresults                 for label_res in label_search_resultresults                     if label_rescontentid  rescontentid                         search_resultappendres              for res in find_responseresults                 flag  false                 for label_res in label_search_resultresults                     if label_rescontentid  rescontentid                         flag  true                 if not flag                     search_resultappendres         else             search_result  find_responseresults          searchsearch_results  search_result         selfprint_search_resultmessage search метод осуществляться вызов два метод search_by_label selfquery показывать код def search_by_labellabel_text     confluence  confluenceurlconfluence_url tokenconfluence_token     cql  ftypepage and labellabel_text     try         response  confluencecqlcql start0 limit100 expandnone include_archived_spacesnone excerptnone         return response     except exception as e         logerrorfunable to parse cql query reason e cql cql     return  оба метод отвечать поиск база знание search_by_label формировать особый cqlзапрос отвечать поиск меткамлейбл labels статья нужный фраза искаться среди метка такой разделение обосновывать желание приоритезировать выдача статья подходящий метка ответ бот метод query осуществляться формирование cqlзапроса зависимость выбирать мы параметр вызов метод advanced_search_on_wiki осуществление поиск показывать код def queryself query searchquery         period_postfix           space_list           content_list           content_postfix    ",
    "tags": [
        "бот",
        "боты для мессенджеров"
    ]
}