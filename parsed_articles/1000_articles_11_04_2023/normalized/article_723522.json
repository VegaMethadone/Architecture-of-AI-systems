{
    "article_id": "723522",
    "article_name": "Исследование прошивки Mi Router 4A Giga Version. Получение интерфейса командной оболочки Linux",
    "content": "приветствовать дорогой читатель сегодня хотеть рассказывать получать интерфейс командный оболочка linux wifi роутер  mi router 4a giga version  рисунок 1  wifi роутер разбор роутер подключение ноутбук дляначало разбирать роутер определять какой порт чип итд располагать наего плата рисунок 2  материнский плата компонент wifi роутер интересный обнаруживать порт  uart   рисунок 3  uart порт чип 25q127csig  spi    рисунок 4  чип 25q127csig внимательный изучение плата подключать роутер ноутбук использовать uart порт определять информация он передаваться припаивать провод uart порт рисунок 5  припаивать провод uart порт конец подключать  pl2303  рисунок 6  подключение провод pl2303 затем устанавливать windows 7 драйвер  pl2303   putty   рисунок 7  драйвер putty далее подключаться wifi роутер помощь putty необходимо проделывать следующий шаг  включать wifi роутер подключать pl2303 ноутбук  рисунок 8  подключение pl2303 ноутбук выбирать параметр putty нажимать open рисунок 9  выбор параметр serial line  com3от компьютер компьютер отличаться com порт speed  115200 connection type  serial putty нажатие open нажатие кнопка open putty увидеть процесс загрузка прошивка wifi роутер проблема  возможность передавать информация помощь putty следствие мочь повлиять процесс загрузка прошивка выбирать пункт меню рисунок 10 также интерфейс командный оболочка завершение загрузка прошивка рисунок 11    рисунок 10 пункт меню рисунок 11 конец загрузка прошивка дамп прошивка решать проблема передача информация помощь putty последующий выбор один пункт меню сделать дамп прошивка изучать итак дамп прошивка подключать прищепкуконнектор чип 25q127csig spi изображать рисунок красный провод первый нога чип первый нога чип изображать круг чип 25q127csig spi рисунок 12  подключение прищепкеконнектор    конец прищепкиконнектор подключать программатор ezp2019 переходник рисунок 13  подключение другой конец прищепкиконнектор ezp2019 ezp2019 ноутбук  рисунок 14  подключение ezp2019 ноутбук далее устанавливать windows 7 драйвер  ezp2019   ezp2019exe    рисунок 15  драйвер ezp2019exe затем запускать ezp2019exe выбирать чип 25q127c список взять близкий он характеристика номер 25q128c  рисунок 16  выбор чип ezp2019exe нажимать кнопка read программа ezp2019exe дождаться прошивка считаться сохранять файл spibin исследование прошивка получение дамп прошивка приступать исследование начинать поиск место проверка вводить консоль число предположение пункт 3 boot system code via flash default иметь константный значение изза мочь выбирать любой пункт меню рисунок 17    рисунок 17  пункт меню открывать файл spibin помощь  binwalk  заинтересовывать строка uboot version string uboot 113 aug 18 2020  111029 рисунок 18 смещение 0x17da0 начало файл spibin этот строка указывать секция загрузчик прошивка uboot рисунок 18  открытие файл spibin помощь binwalk далее находить начало секция загрузчик uboot файл spibin информация узнавать посмотреть процесс загрузка прошивка wifi роутер putty момент загрузка прошивка wifi роутер увидеть uboot компания ralink версия 5000 ralink uboot version 5000 поискать интернет данный версия находить проект github  httpsgithubcomcidermoleralinkuboot  который описание начало секция загрузчик uboot сверять свой начало файл проект github приходить вывод совпадать рисунок 19 значит это  начало секция загрузчик uboot файл spibin смещение 0x00000000 рисунок 19  начало секция следом открывать файл spibin  ida pro  это сделать определять архитектура x86 x64 arm mips файл spibin это сделать взять любой бинарный файл файл spibin воспользоваться binwalk параметр me  m  рекурсивный сканирование извлекать файл   e  автоматический извлечение известный тип файл рисунок 20  binwalk выполнение команда binwalk me создаваться директория _spibinextracted который находить исполнять файл операционный система linux один который являться wpad  рисунок 21  wpad файл открывать помощь ida pro x86 посмотреть какой параметр выбирать ida pro рисунок 22  открытие wpad ida pro узнавать какой параметр выбирать ida pro момент открытие файл wpad мочь открывать файл spibin ida pro x86 такой параметр рисунок 23  рисунок 23  открытие spibin ida pro открывать файл spibin ida pro необходимо размечать преобразовывать байт код читабельный ассемблерный assembler код вопервых отсчитывать начало файл 0x1000 байт наткнуться служебный область вовторых выделять несколько тысяча байт например 0x1000 0x4000 это необходимый ida pro мочь автоматически преобразовывать байт код ассемблерный код рисунок 24   рисунок 24  начало конец выделять участок нажимать клавиатура c появляться диалоговый окно следом нажимать кнопка analyze рисунок 25  analyze результат получать ассемблерный код  рисунок 26  assembler code далеко необходимо понимать imagebase это базовый адрес загрузка программа ida pro мочь создавать перекрестный ссылка это информация код использоваться функция строка относиться строка функция это сделать посмотреть dword рисунок 27 посмотреть hexrays это функциональный возможность ida pro позволять конвертировать assembler code псевдокод наподобие язык программирование рисунок 28 переходить hexrays необходимо нажимать клавиатура f5 рисунок 27  поиск imagebase dword рисунок 28  поиск imagebase hexrays вышесказанный рисунок 27 рисунок 28 сделать вывод imagebase начинаться 0xbfc четвертый байт находить перебор 0 9 правильный байт определять посмотреть строка должный преобразовываться следующий вид иметь перекрестный ссылка рисунок 29  рисунок 29  корректный строка необходимо изменять imagebase ida pro переходить edit  segments  rebase program изменять imagebase 0xbfc10000    рисунок 30  rebase program далее приступать решение проблема передача информация помощь putty последующий выбор один пункт меню начинать поиск строка 3 boot system code via flash default файл spibin помощь ida pro    рисунок 31  находить строка ida pro затем нажимать adbootsystemcod рисунок 32 рисунок 32  нажатие adbootsystemcod следом нажимать клавиатура x затем появляться окно который увидеть использоваться данный строка рисунок 33  место использование строка boot system code via flash default нажимать строчка sub_bfc028c06c рисунок 33 проваливаться функция sub_bfc028c0 рисунок 34  функция sub_bfc028c0 далеко нажимать функция sub_bfc028c0 рисунок 34 затем клавиатура x посмотреть вести этот функция приводить место проверка вводить число рисунок 35 также документация uboot следовать  bootdelay   это количество секунда давать ввод число выбор один пункт описание boot_wait документация обнаруживать  рисунок 35  место проверка вводить число вернуться проблема описывать выше мочь передавать информация помощь putty выбирать пункт меню код константный значение рисунок 35  строка 259 возможность передача информация роутер помощь putty переменный v33 равный off рисунок 35  строка 239 исходить вариант изменять константный значение необходимый удалять off выбирать второй вариант позволять гибко выбирать пункт меню рисунок 10 удалять off файл spibin рисунок 36  удаление off файл spibin перепрошивка роутер получение командный оболочка linux следом перепрошивать wifi роутер получать дамп прошивка подключать прищепкуконнектор чип 25q127csig spi описывать выше затем запускать ezp2019exe выбирать чип 25q128c нажимать кнопка open выбирать файл spi_fixbin далее нажимать кнопка write дождаться прошивка загружаться рисунок 37  перепрошивка роутер загрузка прошивка подключаться wifi роутер помощь puttyexe выбирать пункт 4 entr boot command line interface рисунок 38 пункт 4 позволять зайти интерфейс командный оболочка загрузчик использовать командный оболочка загрузчик попадать интерфейс командный оболочка linux    рисунок 38  выбор пункт 4 необходимо разбираться командный оболочка uboot получать командный оболочка linux начинать чтение документация uboot поскольку описание переменная  bootargs  документация сказать содержимое переменная передаваться ядро linux качество параметр загрузка далее посмотреть ida pro использоваться этот переменная    рисунок 39  код заполнение bootar",
    "tags": [
        "информационная безопасность",
        "реверс инжиниринг",
        "роутер"
    ]
}