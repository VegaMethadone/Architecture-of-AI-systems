{
    "article_id": "725788",
    "article_name": "44 совета по Ansible: рекомендации и Best Practices",
    "content": "ansible  наиболее часто использовать программный инструмент открытый исходный код управление конфигурация предоставление программный обеспечение развертывание приложение облачный локальный среда статья поделиться practices настройка ansible предлагать интересный подход эффективный работа внутренний компонент продукт базовый best practices выбирать yaml вместо json  хотя ansible позволять использовать синтаксис json yaml читать файл проект гораздо легко использовать одинаковый пробел  красиво разделять объект улучшать читаемость оставлять пустой строка блок задача другой компонент использовать последовательный стратегия тегирование  тегирование  это мощный функция ansible поскольку позволять группировать задача детально они управлять тег давать мы возможность добавлять тонкий элемент управление выполнение задача добавлять комментарий  считать это необходимый стесняться использовать комментарий объяснять цель причина возникновение задача переменный далее использовать стратегия последовательный именование  прежде приступать настройка свой проект ansible подумать применение последовательный стратегия именование задача плейбук переменный роль модуль определять руководство стиль  следовать буква руководство  оно помогать последовательно выполнять задача искать вдохновение посмотреть этот руководство стиль  openshift  быть просто  ansible предоставлять множество опция расширенный возможность это значить должный использовать момент время находить тот инструмент ansible который подходить ваш случай попытаться максимально упрощать свой проект например начинать простой плейбук файл инвентаризация сложный инструмент рефакторинг добавлять поздно хранить свой проект система контроль версия vcs  сохранять файл ansible репозиторий код регулярно фиксировать новый изменение хранить конфиденциальный значение обычный текст  секрет конфиденциальный значение использовать ansible vault шифрование переменный файл защита любой конфиденциальный информация тестировать проект  использовать инструмент тип ansible lint добавлять этап тестирование конвейер cicd ваш репозиторий ansible тестирование роль ansible рекомендовать взглядывать  molecule  тестирование вводить данные проверка пользовательский выражение использовать модуль assert организовывать каталог посмотреть выглядеть организованный структура каталог ansible inventory     production                 inventory file for production servers     staging                    inventory file for staging environment     testing                    inventory file for testing environment   group_vars    group1yml              variables for particular groups    group2yml host_vars   host1yml                variables for particular systems   host2yml   library                   store here any custom modules optional module_utils              store here any custom module_utils to support modules optional filter_plugins            store here any filter plugins optional   masteryml                 master playbook webserversyml             playbook for webserver tier dbserversyml              playbook for dbserver tier   roles    example_role                this hierarchy represents a role        tasks                        mainyml         tasks file can include smaller files if warranted        handlers                     mainyml         handlers file        templates           files for use with the template resource            ntpconfj2      templates end in jinja2        files                        bartxt          files for use with the copy resource            foosh           script files for use with the script resource        vars                         mainyml         variables associated with this role        defaults                     mainyml         default lower priority variables for this role        meta                         mainyml         role dependencies        library           roles can also include custom modules        module_utils      roles can also include custom module_utils        lookup_plugins    or other types of plugins like lookup in this case      monitoring               same kind of structure as common was above done for the monitoring role best practices инвентаризация  best practices использовать группа инвентаризация  группировать узел основа общий атрибут который мочь разделять  расположение цель роль среда делать отдельный инвентаризация каждый среда  определять отдельный файл инвентаризация каждый среда  производственный промежуточный тестовый далее изолировать друг друг избегать ошибка связывать неправильный выбор среда проводить динамический инвентаризация  работа облачный провайдер быстро меняться среда ведение статический инвентаризация становиться сложный задача использовать динамический группировка время работа  мочь создавать динамический группа помощь модуль group_by основа заданный атрибут  пример основа операционный система  выполнять различный задача каждый определение такой группа инвентаризация  name gather facts from all hosts   hosts all   tasks      name classify hosts depending on their os distribution       group_by         key os_ ansible_factsdistribution     only for the ubuntu hosts  hosts os_ubuntu   tasks       tasks that only happen on ubuntu go here       only for the centos hosts  hosts os_centos   tasks       tasks that only happen on centos go here best practices плейбук сценарий указывать статус задача  сделать ваш задача понятный задавать параметр state это требоваться изза значение умолчание размещать каждый аргумент задача отдельный строка  это помогать сделать файл ansible удобный чтение рассматривать несколько пример это рабочий плохо читаемый вариант  name add the user  username    ansiblebuiltinuser name username  statepresent uid999999 generate_ssh_keyyes   become yes вместо мочь использовать данный синтаксис улучшать читабельность понятность задача аргумент  name add the user  username    ansiblebuiltinuser      name  username       state present      uid 999999      generate_ssh_key yes   become yes использовать плейбука верхний уровень оркестровка плейбук нижний уровень  мочь логически сгруппировывать задача сценарий роль низкоуровневый плейбука использовать плейбуки верхний уровень требовать оркестровка группировать задача помощь блочный синтаксис  задача который связывать друг друг иметь общий атрибут тег мочь сгруппировывать помощь функция blok один преимущество опция являться простой задача находиться один блок  name install configure and start an nginx web server   block      name update and upgrade apt       ansiblebuiltinapt         update_cache yes         cache_valid_time 3600         upgrade yes        name install nginx       ansiblebuiltinapt         name nginx         state present        name copy the nginx configuration file to the host       template         src templatesnginxconfj2         dest etcnginxsitesavailabledefault               name create link to the new config to enable it       file         dest etcnginxsitesenableddefault         src etcnginxsitesavailabledefault         state link        name create nginx directory       ansiblebuiltinfile         path homeubuntunginx         state directory        name copy indexhtml to the nginx directory       copy         src filesindexhtml         dest homeubuntunginxindexhtml       notify restart the nginx service   when ansible_factsdistribution  ubuntu   tags nginx   become true   become_user root использовать контроллер запущенный задача  контроллер позволять выполнять задача вносить изменение контроллер запускать происходить изменение файл  indexhtml  приводить высоко пример handlers    name restart the nginx service     service       name nginx       state restarted     become true     become_user root best practices переменная переменный позволять пользователь параметризовать различный компонент ansible хранить значение который мочь повторно использовать задавать значение умолчание ваш переменный  устанавливать значение умолчание группа  group_varsall  каждый роль устанавл",
    "tags": [
        "ansible",
        "ansible playbook",
        "ansible roles",
        "ansible lint",
        "администрирование",
        "devops",
        "it инфраструктура",
        "карьера it специалиста"
    ]
}