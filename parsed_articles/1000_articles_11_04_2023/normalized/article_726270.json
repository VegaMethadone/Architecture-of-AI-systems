{
    "article_id": "726270",
    "article_name": "Кража учетных данных без администратора или касания LSASS с помощью Kekeo путем злоупотребления CredSSP",
    "content": "скомпрометировать хост windows мочь хотеть делать дамп открывать пароль помощь традиционный метод например sekurlsalogonpasswords mimikatz дамп lsass следовать проверять настройка делегирование учетный данные  включать позволять получать пароль открытый вид затрагивать процесс lsass иметь право администратор ограниченно пароль текущий пользователь этот статья также позволять защитник владелец система просматривать настройка свой среда оценивать подверженный риск кража учетный данные помощь метод технический бэкграунд  rdp удаленный рабочий столтерминальный сервер совместимый sso  использовать устройство windows присоединять домен мочь удаленный подключаться сервер помощь rdp ваш текущий учетный запись пользователь ad повторный ввод пароль  должный знать открытие сеанс rdp преобразовываться интерактивный открытие сеанс сторона сервер  это важно это означать ваш пароль отправляться сервер защищать передача менее удаленный сервер конечный итог получать пароль открытый вид понимать что идти  потратить время угадывать пойти   догадываться мочь реализовывать злонамеренный сервер получать пароль правый фоновый режим этот функция rdp sso опираться компонент  credssptsssptspkg  который обеспечивать делегирование учетный данные  пурист обращать внимание аббревиатура находиться один уровень  ssp   поставщик поддержка безопасность  tsssp    ssp  служба терминал  tspkg   поставщик аутентификация реализовать sekurlsalogonpasswords mimikatz точно  секурлсацпкг бенджамин gentilkiwi дельпи напоминать мы твит 2016 год активация делегирование учетный данные приводить наличие пароль память windows 10  требоваться некоторый настройка умолчание настраивать означать включать этот функция работать подсказка  ваш среда вводить свой пароль подключение rdp ваш собственный текущий учетный запись это означать настройка вероятно включать это сложно например другой служба rdp например удаленный взаимодействие powershell служба виртуальный консоль microsoft удалять отладка visual studio т д использовать это включать вместо поэтому равный прочитывать остальное также обращать внимание rdp это работать сервер который включать nla  nla  это аутентификация уровень сеть который позволять проходить аутентификация открытие графический сеанс вводить учетный данные поле свой клиент использоваться nla  ваш rdpклиент открывать графический сеанс вводить свой пароль удаленный сервер nla использоваться соответствующий настройка сказать требоваться некоторый настройка какой мочь находить редактор групповой политика gpo раздел конфигурация компьютераадминистративный шаблонысистемаделегирование учетный данные некоторый являться настройка разрешать другой  запрещать  активный должный включать затем должный определять несколько авторизованный сервер например видеть похожий вариант разный тип учетный данные умолчание новый учетный данный сохранять учетный данные интересовать учетный данные умолчание поскольку являться текущий учетный данные аутентифицировать пользователь  принимать внимание правильно понимать свежий учетный данные  это например тот который вводить подключение удалять сервер помощь rdp сохранять учетный данные  это учетный данный который сохранять свой хранилище windows см команда mimikatz vault  многий учебник инструмент microsoft повидеть изменять настройка  поле авторизованный сервер разрешать подстановочный знак   обычно увидеть termsrv  termsrv domainexamplecom termsrv означать rdp самый префикс host   просто   самый дело пользовательский интерфейс упоминаться сервер поскольку использоваться нотация имя участникаслужба уместно говорить авторизованный служба поскольку служба размещать сервер авторизовать  имя участниковслужба мочь связанный учетный запись служба учетный запись компьютер параметр папка gpo преобразовываться значение реестр  hkey_local_machinesoftwarepoliciesmicrosoftwindowscredentialsdelegation  разрешать делегирование учетный данные умолчание сопоставляться allowdefaultcredentials разрешать делегирование учетный данные умолчание проверка подлинность сервер ntlm сопоставляться allowdefcredentialswhenntlmonly выглядеть реестр настройка gpo устанавливать выше очевидно сохраняться настройка включать авторизованный сервер замечать флажок объединять значение ос умолчание входной данные выше устанавливать умолчание  также сопоставляться ключ реестр этот значение ос умолчание храниться  hkey_local_machinesystemcurrentcontrolsetcontrollsacredssppolicydefaults  похоже эквивалент gpo  мой устройство казаться пустыминеопределенный например возможно будущий версия windows это изменяться   kekeo предлагать команда tsssplist красивый отображение содержимое этот раздел реестр определять заключение должный помнить параметр являться обязательный работа делегирование учетный данные включать настраивать умолчание настройка использоваться разный момент факт настройка использоваться вход система означать включение требоваться цикл выход система перезагрузка хотеть уверенный делегирование учетный данные включать ваш пароль сохранять память  конкретный опция включать какой авторизованный сервер зависеть какой техника использовать насколько сложно сбросить кража учетный данные наверняка замечать два похожий настройка разрешать делегирование учетный данные умолчание описание объект групповой политика указывать параметр политика применяться аутентификация сервер достигать использование доверенный сертификат x509 kerberos разрешать делегирование учетный данные умолчание проверка подлинность сервер ntlm описание объект групповой политика говориться параметр политика применяться проверка подлинность сервер достигать помощь ntlm первый параметр включать обращаться первый раздел ниже сервер kerberos  второй параметр включать обращаться ко второй раздел низко сервер ntlm сервер kerberos разрешать делегирование учетный данные умолчание  мочь замечать авторизованный сервер обозначаться помощь нотация spn servicehostfqdn это иметь смысл использование kerberos  самый дело должный говорить авторизовать служба вместо авторизованный сервер поскольку spn разрешать один служба хост использование credssptsssp kerberos использоваться обычный процесс проверка подлинность  следовательно spn указанный аргумент target kekeo должный существовать служба выдача билет мочь находить доставлять мы наш сервисный билет  kerberos позволять клиент проверять подлинность сервер который связываться такой образ дополнение то аргумент  target должный действительный должный действительный сервер который просить наш клиент kekeo подключаться  общий имя участниковслужба такой termsrv host связанный учетный запись компьютер учетный запись пользователь  поэтому наш сервер kekeo должный работать идентификатор целевой сервер самый простой способ  запускать nt authoritysystem сценарий заключаться скомпрометировать авторизовать сервер выполнение код system украсть пароль учетный запись компьютер украсть tgt учетный запись компьютер т д злоупотреблять получение пароль пользователь другой компьютер следующий пример наш клиентский компьютер являться clientlabtest слева использовать удаленный сервер adcslabtest справа  это сервер adcs сервер ad pki иметь значение это любой компьютер windows присоединять домен  оба присоединять ad hostadcslabtest авторизовать политика делегирование учетный данные клиентский компьютер  итак хотеть получать пароль текущий пользователь активный клиентский компьютер благодаря авторизованный сервер adcs который скомпрометировать  обязательно запускать сервер kekeo adcs system использовать psexec s многий другой метод подтверждение сторона сервер kerberos использоваться строка пакет получать сторона клиент kekeo учетный данные пользователь user который работать клиент kekeo четкий пароль тот кто интересно service ticket получать процесс клиентский компьютер интересно почему сервисный билет termsrvadcslabtest странно поскольку упоминать rdp sso почему вместо сервисный билет cifsadcslabtest попробовать объяснять поздно kekeo реализовать это сервер ntlm разрешать делегирование учетный данные умолчание аутентификаци",
    "tags": [
        "red team",
        "red teaming"
    ]
}