{
    "article_id": "727986",
    "article_name": "О чём все эти люди говорят, ChatGPT?",
    "content": "счет размечать большой массив текст помощь модель openai промт kandinsky 21 кот шок приходить очень текстовый сообщение письмо повсюду слово закопаться сообщение вокруг хаос лист текст компьютер чашка кофе стиль anime все привет продуктовый аналитик компания интерсвязь многие часто всплывать потребность раскладывать полочка куча разный текст например хотеть знать  вообще  отзыв маркет продукт письмо клиент разный тема хотеть систематизировать понадобиться проанализировать старый обращение пользователь техподдержка который размечать множество материал nlp часто джуна изучать часть мочь давать болееменее вменять результат кроме множество крупный компания вовсе иметь штат специалист data science делать слабо понимать такой nlp ресурс подымать крутой модель куча параметр роадмап nlpспециалистов компания расписывать год вперед место помощь приходить openai api открытый доступный рф момент написание статья это хотеться рассказывать работа понадобиться api ключ личный кабинет openai  начальный навык python надежный источник кофеин готовить данный  работа понадобиться среда python удобно уметь работать jupyter аналог понадобиться библиотека openai еще несколько работа данные установка библиотека pip install numpy1242 pandas200 tqdm4650 openai0274 tiktoken033 plotly5141 импортировать библиотека готовить окружение import openai import tiktoken import numpy as np import pandas as pd from os import environ from tqdm import tqdm from openaiembeddings_utils import get_embedding  openaiapi_key  environgetopenai_token tqdmpandas вместо  environgetopenai_token  просто вставлять строка ключ использовать переменный окружение безопасно загружать датасти заранее предразмеченный вручную класс столбец  class  это нужно сравнивать качество ручной правильный автоматический разметка ваш датасет содержать столбец  class  датасет пример содержать 118 обращение чат медицинский организация df  pdread_csvdataappealscsv  df заодно глянуть баланс предразмеченный класс dfclassvalue_counts   результат анализ         36  изменение время прием    25  пластический хирургия       25  запись прием             18  справка                     14 далее мы потребоваться эмбеддинг сообщение это такой представление текст вид вектор число получать mlмодели идея закодировать слово вручную качество числовой представление сильно влиять итоговый результат нынешний mlмодели неплохо определять скрытый зависимость слово текст  выбирать модель openai мы нужный получение эмбеддинг решать быть закодировать исходить  рекомендация  openai подходить  textembeddingada002   cl100k_base  embedding_model  textembeddingada002 embedding_encoding  cl100k_base далее почистить наш датасет убирать слишком длинный сообщение пункт спокойно пропускать жалко ваш баланс openai max_tokens  100   задавать максимальный длина токен сообщение  encoding  tiktokenget_encodingembedding_encoding   рассчитывать длина сообщение токен dfn_tokens  dfmessageapplylambda x lenencodingencodex заодно узнавать сколько потратить остаток баланс printfпотратим dfn_tokenssum  00004  1000  потратить 00011896 убирать слишком длинный сообщение потратить слишком токен df  dfdfn_tokens  max_tokens получать эмбеддинг обычно это занимать около минута сотня сообщение советовать использовать  progress_apply  tqdm понимать долго ждать dfembedding  dfmessageprogress_applylambda x get_embeddingx engineembedding_model  100 118118 01040000  182its сохранять эмбеддинг отдельно matrix  npvstackdfembeddingvalues  matrixshape  118 1536 итак текст числовой представление пора разбивать кучка кучка мало помощь кластерный анализ поиск кластер использование kmeans from sklearncluster import kmeans  n_clusters  5  колво кластер менять усмотрение  kmeans  kmeansn_clustersn_clusters initkmeans random_state42 kmeansfitmatrix labels  kmeanslabels_ dfсluster  labels kmeans  наиболее популярный способ размечать пример кластер данный этап количество кластер подбирать визуально знать примерно количество который встречать ваш датасет вообще подбор оптимальный количество кластер это тема который нужно рассматривать отдельно получать кластер отображать 2d 3d это нужно визуально понимать сильно кластер разделяться подходить tsne from sklearnmanifold import tsne import matplotlib import matplotlibpyplot as plt  tsne  tsnen_components2 perplexity15 random_state42 initrandom learning_rate200 vis_dims2  tsnefit_transformmatrix  x  x for x y in vis_dims2 y  y for x y in vis_dims2  for category color in enumeratepurple green red blue yellow     xs  nparrayxdfсluster  category     ys  nparrayydfсluster  category     pltscatterxs ys colorcolor alpha03      avg_x  xsmean     avg_y  ysmean      pltscatteravg_x avg_y markerx colorcolor s100      plttitleотображение кластер 2d использовать tsne видеть четыре пять кластер располагаться относительно рядом это говорить приблизительно схожий тематика кластер снизу слева находиться далеко остальной получать название кластер примерно понимать суть кластер подбирать название взять пять случайный сообщение каждый кластер попросить модель  gpt35turbo  chatgpt описывать общий  ради хайповый заголовок  это один самый качественный модель суммаризация openai время модель  textdavinci003  отлично подходить стоить 10 дорого стоить обращать внимание стоимость генерация выходить дорого получение эмбеддинг стоимость ограничивать контролировать размер переменная  promt  это затравка который передаваться модель получение ответ она контролировать размер получать ответ изменять параметр  max_tokens  msg_per_cluster  5  количество сообщение кластер  for i in rangen_clusters     joined_messages  njoin         dfdfсluster  i         message         samplemsg_per_cluster random_state42         values          promt  fчто общий этот обращенийnnобращенияnnjoined_messagesnnnтема     response  openaichatcompletioncreate         modelgpt35turbo         messages                              role user                  content promt                               temperature0          max_tokens128  параметр изменять подробный короткий описание         top_p1         frequency_penalty0         presence_penalty0          printfтема кластер i  responsechoices0messagecontentreplacen  n     printjoined_messages     printnn   тема кластер 0  изменение время прием врач    отменять изменение время прием  ограничение количество изменять время прием  мочь изменять время прием интернет  какой данные нужно предоставлять изменение время прием  мочь выбирать время прием врач     тема кластер 1  медицинский справка получение    какой медицинский справка нужный трудоустройство  какой медицинский справка нужный получение водительский удостоверение  получать медицинский справка  какой медицинский справка нужный выезд граница  мочь получать медицинский справка почта электронный почта     тема кластер 2  пластический хирургия    добрый день хотеть сделать операция подтяжка лицо долго идти восстановление операция  добрый день хотеть узнавать возможность пластический операция удаление рубцов  здравствовать хотеть узнавать какой процедура сделать коррекция форма бровь  добрый день нравиться форма мой живот какой вариант пластический коррекция  здравствовать хотеть сделать операция изменение форма ухо какой ограничение быть операция     тема кластер 3  результат анализ    какой услуга мочь оказывать основа результат анализ  получать результат анализ  какой данные нужно предоставлять получение результат анализ  понимать означать результат анализ  мочь получать результат анализ лечить врач     тема кластер 4  запись прием врач    записываться прием врач  какой документ нужный запись прием  отменять запись прием  какой данные нужно указывать онлайнзапись  мочь записываться прием интернет кластер 2 который отдаляться график tsne действительно тематически далекий другой датасет проверочный работа описание кластер  gpt35turbo  название сопоставлять размечать сообщение начало dfcluster_name  dfсlusterreplace              0 изменение время прием         1 справка         2 пластический хирургия         3 р",
    "tags": [
        "обработка текстов",
        "анализ текстов",
        "openai",
        "nlp",
        "nlp (natural language processing)",
        "кластеризация",
        "kandinsky art"
    ]
}