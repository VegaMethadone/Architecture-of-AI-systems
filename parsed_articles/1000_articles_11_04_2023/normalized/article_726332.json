{
    "article_id": "726332",
    "article_name": "Создаем читабельный e2e тест для микросервисов на Spring Boot с помощью Cucumber 7 и Wiremock",
    "content": "дорогой читатель это первый туториал чтото упускать илинеобъяснять хотя стоилоб написать пожалуйста комментарий обновлять статья tldr весь код микросервис e2e тесто  рекомендовать быстро пробежаться код прочтение статья т самый статья объяснять неочевидный момент реализация e2e тестирование проблема нужно организовывать сквозноеe2e endtoend тестирование далее быть использовать термин e2e приложение который состоять несколько микросервис микросервис использовать сторонний апи знакомиться c проект качество пример социальный сеть пользователь мочь создавать аккаунт публиковать пост аккаунт создавать ты 18 год пост использовать матный слово находить матный слово  пост создавать разный деталь проект проект использоваться монорепозиторий технология maven spring boot hibernate h2 feign client spring cloud цель упрощение туториал использовать никакой либ миграция база liquibase flyway создавать таблица помощь hibernate цель упрощение качество база использовать inmemory база h2 пример использоваться приложение двумь микросервис e2e тест лежать отдельный модуль название e2etests запуск сервис e2e тестирование быть использовать spring профиль название e2e сервис обязанность наш социальный сеть микросервис микросервис пользоваться сторонний апи ниже диаграмма описание приложение userservice  отвечать связанный пользователь postservice  отвечать связанный пост age api  сторонний сервис который помогать наш соцсеть узнавать реальный возраст пользователь word api  сервис который помогать понимать текст матный слово краткий описание технология e2e тестирование создание e2e тест быть использовать следующий либ junit 5 wiremock 2 cucumber 7 awaitility 4 wiremock  мокированияимитация http ответ наш случай использовать wiremock мокирование ответ сторонний api короткий пример создавать мокнуть get запрос получение пользователь id 1 wiremockserverstubforgetapiusers1willreturnaresponse         withstatus200         withheadercontenttype applicationjson         withbodyjsonhelperfromobjecttostringuser   cucumber  создание удобный чтение e2e тесто короткий пример функция снятие деньги счет     сценарий успешный снятие деньги счет     давать счет пользователь иметься 1200 рубль     пользователь снимать счет 200 рубль     счет пользователь иметься 1000 рубль awaitility  создание проверка наш e2e тесто условие который мочь выполняться сразу какоето время короткий пример  сделать чтото кастомер somecustomerservicedosomething   ждать 5 секунда проверять обновляться статус кастомер awaitatmost5 secondsuntilcustomerstatusisupdated    мочь проверять обновляться статус кастомер каждый  2 секунда течение 10 секунда awaitilityawaitatmost10 timeunitseconds                 pollinterval2 timeunitseconds                 untilcustomerstatusisupdated проговаривать логика e2e тесто цель протестировать весь жизненный цикл пользователь наш социальный сеть напоминать соцсеть создавать акка ты мало 18 год использовать мат пост логика тест пользователь создавать аккаунт соцсеть попробовать создавать аккаунт два человек один 18 год другой вести какуюто активность создавать пара пост мат итог решать удалять свой аккаунт нужно сделать успешный выполнение e2e тесто проводить e2e тестирование мы нужно замокать сторонний сервис мы помогать wiremock наш сервис быть работать подозревать сторонний api настоящий диаграмма ниже увидеть сервис соцсеть обращаться wiremock реальный апи подготавливать сервис e2e тестирование ускорение выполнение e2e тест использовать inmemory база данные наш пример делать  использовать h2 база данные вместо например mysql нужно http клиент который использоваться общение сторонний api перенаправлять wiremock нужно изменять хост порт сторонний api хотеться использоваться самый клиент прод наш пример это сделать спринговый проперти проект наш социальный сеть создание клиент использоваться feignclient spring cloud другой либ создание клиент логика такой клиент проперти аппликейшен файл e2e профиль указание хост порт wiremocka читать готовый e2e тест разбираться писать свой наш цель создавать легкочитаемый e2e тест использовать либ cucumber читабельный описание наш тест храниться файл расширение feature ниже готовый файл шаг наш e2e тест наш файл feature содержать ключевой слово функция  обычно писать описание тестировать функционал наш случай тест  который тестит вообще весь приложение поэтому использовать подходящий описание сценарий  название краткий описание наш e2e тест давать  это ключевой слово который использовать описание шаг тесто доступный такой ключевой слово допускать затем иначе ктомуж пусть также напоминать ключевой слово это синтаксический сахар плагин файл feature удобный редактирование файл тип feature нужно устанавливать плагин intellij idea подсказывать устанавливать открывать файл тип feature писать фич файл русский язык название шаг русский писать какихлибо дополнительный настройка использовать русский ключевой слово нужно начало feature файл добавлять это  language ru пример увидеть скриншот высоко создавать новый шаг фич файл шаг который код который выполняться подсвечиваться желтый цвет наводить курс шаг прожимать altenter курсор стоять строка увидеть такой меню идея предлагать создавать называть step definition метод который содержать код который выполнять шаг время тесто кликнуть create step definition появляться такой меню выбирать существовать файл thirdpartyservicesstepsdefinitions такой пока выбирать первый вариант класс создавать метод аннотация давать также название метод русский знать писать java использовать русский язык  метод нужно помещать код шаг давать посмотреть полагать метод происходить написать название шаг код должный замокать ответ age api это сделать создаваться мокнуть post запрос урл ispersonadult также добавлять условие тело запрос должный определенный джисон проверять помощь awaitility условие который выполняться сразу давать рассматривать шаг использоваться библиотека awaitility напоминать awaitility мы нужный случай нужно проверять условие который выполняться сразу какоето время наш e2e тесто awaitility использоваться шаг проверка пользователь пост соцсеть мы нужный awaitility т наш соцсеть удаление пользователь пост занимать время метод запускать проверка пользователь нету пост каждый 2 секунда протяжение 10 секунда awaitility выполнять код метод until течение 10 секунда лямбда until вернуть true вылетать эксепшен тест заваливаться реализация остальной шаг наш feature файл объяснять быть т содержать либо  простой код либо код похожий объяснять выше смотреть вспомогательный код e2e тест код реализация логика шаг фич файл пакет srcmainjavaorgexample увидеть класс c код запуск spring boot приложение немой выключать сервлет запускаться spring контекст класс нужный мы т получаться запускать e2e тест spring контекст значит получаться удобно красиво инжектировать бина класс пакет srctestjavaorgexamplecommonclient клиент сервис проведение crud операция пост пользователь srctestjavaorgexamplecommonconfig  пакет конфига ниже класс jsonhelper это обертка objectmapper работа джисон класс testcontext это класс удобный хранение передача данный шаг тесто который суть свой обычный мап класс abstractstepsdefinitions  содержать код который использовать весь остальной stepsdefinitions класс конфига запуск e2e тесто beanconfig  особенный содержать метод создание spring бинов класс создавать инстанс wiremock сервер cucumberspringconfiguration  класс конфигурация application context наш случай это spring контекст который подниматься запуск feature файл endtoendcucumbertestconfiguration  класс содержаться настройка запуск feature файл помощь junit 5 давать проходиться аннотация класс т мочь вводить замешательство suite  это аннотация junit 5 создание классазапускатор тест includeenginescucumber  этот аннотация добавление cucumber engine движок запуск тест создавать использование cucumber configurationparameterkey  glue_property_name value  orgexample  указывать местоположение джава класс stepsdefinitions также пакет должный класс аннотация cucumbercon",
    "tags": [
        "java",
        "e2e",
        "e2e тесты",
        "cucumber",
        "wiremock",
        "junit5",
        "сквозное тестирование",
        "awaitility",
        "микросервисы",
        "апи"
    ]
}