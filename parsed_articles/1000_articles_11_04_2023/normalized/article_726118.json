{
    "article_id": "726118",
    "article_name": "Прости, Rosetta, мы должны расстаться",
    "content": "все привет звать антон ios разработчик платформенный команда циан релиз xcode 143 apple убирать поддержка rosetta прямой текст говорить разработчик откладывать адаптация свой проект apple silicon далеко некуда сегодня поделиться история какой сложность сталкиваться наш основный приложение циан какой сторонний решение помогать мы избавляться rosetta быть данный график результат который получать процесс работа общий все любить поехать такой rosetta начало давать короче вспомнить такой rosetta компания apple история несколько менять архитектура процессор свой компьютер это 1994 год apple переходить процессор motorola riscархитектуру powerpc далее это 2006 год apple переходить использование powerpc архитектура intel x86 это случаться 2020 год представлять процессор apple silicon начинаться переход intel x86 архитектура arm этот архитектура собственный набор процессорный команда который отличаться себя разработчик вы легко жить эпоха перемена apple выпускать транслятор который позволять переводить набор команда один архитектура набор команда архитектура время работа приложение транслятор называть rosetta один сторона rosetta нести несомненно польза пока адаптировать свой проект новый архитектура сторона транслирование команда один архитектура другой тратиться ресурс время сборка запуск проект лишать возможность переходить xcode 143 использование который спустя некоторый время становиться обязательный условие публикация appstore понимать использоваться rosetta давать разбираться вообще понимать запуск ваш приложение машина процессор apple silicon использоваться rosetta это сделать несколько способ самый простой  воспользоваться системный утилита activity monitor который идти состав macos вкладка cpu увидеть список запущенный процесс среди ваш приложение который запускать симулятор колонка kind architecture ранний версия macos один два значение  intel apple процесс ваш приложение указывать apple поздравлять  использовать rosetta значение intel говорить соответственно обратный еще способ узнавать информация консоль ps p fuser usrlibexecrosettaruntime  sed e s   sed e s g результат быть выводить запущенный процесс приложение который взаимодействовать rosetta usrlibexecrosettaruntime   pid tty       time cmd  7240      44947 applicationsxcodeappcontentsmacosxcode циан разбираться такой rosetta определять использовать транслятор ваш приложение рассказывать циан недавно 2022 год начинать активно обновлять парк рабочий машина заменять intel apple silicon немного статистика проект 20 разработчик 680 тысяча строка код 500 тысяча swift 180 тысяча objc 55 сторонний зависимость работа проект мы хотеться использовать мощность новый машина полный первый получать такой машина очевидно смочь первый раз собирать проект сделать хак включать опция  open using rosetta  xcode ios simulator время холодный сборка проект машина m1 pro 16gb ram момент составлять симулятор 620 секунда реальный устройство 600 секунда делать обновлять сторонний зависимость который появляться поддержка apple silicon мы приходиться подправлять немного код тот место инициализировать различный компонент например использоваться карта яндекс корректный работа симулятор мы приходиться добавлять следующий обертка if target_iphone_simulator  target_cpu_arm64     let mapview  ymkmapviewframe zero vulkanpreferred true else     let mapview  ymkmapview endif обращать внимание опция  vulkanpreferred  пример разработчик адаптировать свой библиотека apple silicon еще выключать опция  open using rosetta  добавлять настройка  excluded_archssdkiphonesimulator  arm64  проект подумать это избавлять rosetta полностью хотя сэкономить время сборка разработчик отлаживаться реальный устройство  понимать выключать опция  open using rosetta  добавлять опция исключение arm64 архитектура симулятор rosetta все равный использоваться activity monitor быть видеть значение intel этот изменение время сборка девайса составлять 414 секунда спустя некоторый время попытаться избавляться ранее добавлять опция исключение arm64 поддерживать архитектура симулятор ждать главный приключение история помнить рассказывать обновлять зависимость который добавлять поддержка apple silicon самый дело немного обманывать один зависимость обновлять смочь среди прочий сторонний библиотека frameworkов образовываться следующий любовный треугольник один сторона приложение использоваться yookassapayments проведение оплата различный банковский карта apple pay сторона помощь yandexmobileads показывать различный реклама оба зависимость требовать свой работа yandexmobilemetrica зависимость поддерживать apple silicon свой актуальный версия чем загвоздка загвоздка работа yookassapayments требоваться динамический версия yandexmobilemetrica работа yandexmobileads актуальный версия 5x который добавлять поддержка apple silicon требоваться статический версия yandexmobilemetrica проект использоваться yandexmobileads версия 4x который возможность работа динамический версия yandexmobilemetrica поддержка apple silicon поставляться вид обычный frameworkа новый формат xcframework соответственно убирать опция  excluded_archssdkiphonesimulator  arm64  симулятор компилятор сообщать yandexmobileads поддерживать запуск apple silicon заводить  issue github  описание проблема актуальный версия yandexmobileads становиться думать делать проблема вариант исключать код который отвечать показ реклама симулятор получаться разработка отладка некоторый фич мы никак обходиться девайса такой большой проблема все нужно держать голова часть функционал приложение доступный симулятор решать поискать еще альтернативный путь решение проблема натолкнуться open source утилита название  arm64tosim  она суть какойлибо бинарник поддерживать архитектура arm64 работать девайса помощь данный утилита сделать версия бинарник который подходить запуск симулятор машина apple silicon черный магия спрашивать самый дело никакой магия нужно немного сделать шаг сторона погружаться устраивать бинарный файл формат macho который применяться операционный система apple быть сильно грузить теория весь нюанс формат наглядность картинка ниже показывать упрощенный схема самый интересный  секция команда загрузка load commands время сборка проект один этап являться линковка библиотека frameworkов который нужный работа ваш приложение это отвечать утилита ld другой слово linker линкер читать каждый бинарный файл выполнять очередь команда загрузка который объявлять заголовок наш бинарный файл оказываться разница бинарный файл который работать симулятор машина apple silicon бинарный файл который работать обычный arm64девайсе ровно один загрузочный команда заголовок оба команда ссылаться один тот сегмент данные возвращаться работа утилита уметь искать нужный загрузочный команда передавать файл подменивать она нужный команда запуск симулятор apple silicon интересно погружаться тема разработчик утилита написать два крутой статья     который все подробно написать особенность работа статический динамический frameworkами давать вернуться наш любовный треугольник сторонний зависимость итог воспользоваться  arm64tosim  перепаковывать обычный framework yandexmobileads настоящий xcframework поддержка apple silicon приложение становиться запускаться симулятор наш приключение заканчиваться переход любой экран отображаться карта приложение начинать падать помнить говорить мы приходиться добавлять обертка яндекс карта который использоваться макрос  target_iphone_simulator   target_cpu_arm64  оказываться  target_iphone_simulator  давно отмечать deprecated оказываться немного старовер упускать момент работать ровно момент пока использовать rosetta сборка проект симулятор apple silicon rosetta макрос  target_iphone_simulator  выдавать  false  решение достаточно очевидный достаточно переходить актуальный способ проверка окружение помощь targetenvironment  if targetenvironmentsimulator запуск проект xcode 13 приложение падать казаться это победа  внезапно подкрадываться xcode 14 который успевать устанавливать некоторый разработчик команда проблема п",
    "tags": [
        "ios",
        "rosetta",
        "swift",
        "циан"
    ]
}