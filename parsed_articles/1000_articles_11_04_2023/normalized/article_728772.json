{
    "article_id": "728772",
    "article_name": "Интеграция Yandex MapKit в SwiftUI проект. Часть 1",
    "content": "приветствовать  недавно поступать задача заменять стандартный карта apple яндекс карта ниже немного yandex mapkit yandex mapkit  это кроссплатформенный библиотека который позволять использовать возможность яндекскарт мобильный приложение ios android основной проблема заключаться библиотека yandex mapkit создавать uikit наш цель поставлять этот дело swiftui поэтому прибегать старый добрый пикча быть считать получать ключ яндекс устанавливать библиотека проект ознакомление установка прикреплять  ссылка   первый дело создавать класс appdelegate подробно реализовать класс swiftui проект   затем идти таргет проект  info прописывать privacy класс appdelegate импортировать библиотека яндекс устанавливать ваш api ключ кабинет разработчик яндекс func application_ application uiapplication didfinishlaunchingwithoptions launchoptions uiapplicationlaunchoptionskey any  bool      ymkmapkitsetapikeyваш apiключ     ymkmapkitsharedinstance  создавать класс locationmanager который импортировать следующий  import foundation import corelocation import yandexmapsmobile import combine locationmanager отвечать логика взаимодействие карта объявлять он сам карта приватный переменный manager который наследоваться класс cllocationmanager работа местоположение пользователь class locationmanager nsobject      lazy var map  ymkmap           return mapviewmapwindowmap           private let manager  cllocationmanager      let mapview  ymkmapviewframe cgrectzero     override init         superinit       унаследовать класс протокол cllocationmanagerdelegate init подписывать делегат объявлять менеджер вызывать функция нахождение геопозиция  class locationmanager nsobject cllocationmanagerdelegate  override init         superinit         managerdelegate  self         managerstartupdatinglocation      реализовывать класс locationmanager функция делегат проверка статус начало использование геопозиция func locationmanager_ manager cllocationmanager didchangeauthorization status clauthorizationstatus          if status  authorizedwheninuse              selfmanagerstartupdatinglocation               затем создавать переменный который быть записывать последний местоположение пользователь published var lastuserlocation cllocation  nil реализовывать функция протокол слушать изменение локация пользователь записывать переменный    func locationmanager_ manager cllocationmanager didupdatelocations locations cllocation        selflastuserlocation  locationslast   приступать написание ui часть создавать swiftuiview название mapview оборачивать zstack объявлять экземпляр класс locationmanager   observedobject var locationmanager  locationmanager yandex mapkit работать uikit создавать структура yandexmapview наследоваться протокол uiviewrepresentable  объявлять enviromentobject переменная класс locationmanager реализовывать функция makeuiview который вернуть view ранее создавать mapview класс locationmanager import swiftui import yandexmapsmobile import combine  struct yandexmapview uiviewrepresentable      environmentobject var locationmanager  yalocationmanager     func makeuiviewcontext context  ymkmapview          return locationmanagermapview            func updateuiview_ mapview ymkmapview context context    вернуться locationmanager создавать приватный функция centermaplocation который вход принимать параметр target который быть подавать долгота широта параметр map который принимать яндекс карта   func centermaplocationtarget location ymkpoint map ymkmapview           guard let location  location else  printfailed to get user location return           mapmapwindowmapmove              with ymkcamerapositiontarget location zoom 18 azimuth 0 tilt 0              animationtype ymkanimationtype ymkanimationtypesmooth duration 05                 реализовывать функция показ текущий геопозиция пользователь брать lastuserlocation передавать метод centermaplocation описывать выше  func currentuserlocation         if let mylocation  lastknownlocation               centermaplocationtarget ymkpointlatitude mylocationcoordinatelatitude longitude mylocationcoordinatelongitude map mapview          объявлять zstack yandexmapview передавать объявлять класс  zstack     yandexmapview     edgesignoringsafeareaall     environmentobjectlocationmanager  оставаться лишь onappear вызывать метод currentuserlocation onappear         locationmanagercurrentuserlocation  результат получать работать яндекс карта ваш swiftui проект результат ниже прикреплять код класс  locationmanager class locationmanager nsobject cllocationmanagerdelegate observableobject          private let manager  cllocationmanager     let mapview  ymkmapviewframe cgrectzero     published var lastuserlocation cllocation  nil     lazy var map  ymkmap           return mapviewmapwindowmap               override init          superinit         selfmanagerdelegate  self               func currentuserlocation         if let mylocation  lastuserlocation              centermaplocationtarget ymkpointlatitude mylocationcoordinatelatitude longitude mylocationcoordinatelongitude map mapview                         func centermaplocationtarget location ymkpoint map ymkmapview                   guard let location  location else  printfailed to get user location return                   mapmapwindowmapmove             with ymkcamerapositiontarget location zoom 18 azimuth 0 tilt 0             animationtype ymkanimationtype ymkanimationtypesmooth duration 05                        func locationmanager_ manager cllocationmanager didchangeauthorization status clauthorizationstatus          if status  authorizedwheninuse              selfmanagerstartupdatinglocation                        func locationmanager_ manager cllocationmanager didupdatelocations locations cllocation           notify listeners that the user has a new location         selflastuserlocation  locationslast         mapview struct mapview view      observedobject var locationmanager  locationmanager     var body some view          zstack             yandexmapsviewedgesignoringsafeareaallenvironmentobjectlocationmanager         onappear             locationmanagercurrentuserlocation                 yandexmapview struct yandexmapview uiviewrepresentable      environmentobject var locationmanager  yalocationmanager     func makeuiviewcontext context  ymkmapview          return locationmanagermapview                    func updateuiview_ mapview ymkmapview context context   следующий часть реализовывать поиск адрес позиция карта выбирать адрес обновление адрес координата центр камера весь спасибо внимание",
    "tags": [
        "яндекс карты",
        "swiftui",
        "swift",
        "yandex map",
        "yandex map kit",
        "xcode",
        "ios"
    ]
}