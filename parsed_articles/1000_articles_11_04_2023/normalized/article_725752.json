{
    "article_id": "725752",
    "article_name": "Слушаем ZX Spectrum музыку с MIDI-плеера",
    "content": "както долгий год назад уменя умирать спектрум невспомнить чтосним случаться новозиться сремонтомжелание небыть ибо назамена давно хотеться новенький zx evolution  болееменее полезный выглядеть целый деталибывать снимать втом число музыкальный сопроцессор ym2149f какраз внужный момент попадаться статья  z80a  осборка  плеер набаз arduino  попытка собирать намакетка приводить ккакофония поэтому сдруг собираться заночь подпиво запиливать плата аж припомощь фоторезист точно пилить какуюто ая поэтому выходить такой рукожопый   сказать препод схемотехника изымать прибор время испытание задний ряд цап эрзац сборка сильно начало хороший стеха пора проект законченный назватьбыло сложный усилитель длянаушниковбыл безжалостно выбрасывать тк изза неправильный включение слишком сильно шуметь дая устройство получаться неособо компактный носить ссобый докорпуса кнопка переключение дорожка рука недоходить валяться плата скучий провод настойка саудиотехника подключать влинейный выход наслучай захотеться послушать спектрумный поппури однако недавно набарахолка попадаться такой вундервафля casio fd1 спереди кнопка воспроизведение справа дисковод сзади midiвыход ее увидеть голова сразу чтото щелкнуть дисковод  сборник составлять кнопка выбор трек пианино мигать панель прикольный куча использовать другой midiсинтезаторами который некоторый труд плата ауплеер выкапывать барахло родственник отправлять мой сторона счастие доезжать целый  попробовать понимать изначально весь кривой  роадмап проект намечать максимально короткий откладывать долгий ящик  придумывать протокол писать новый прошивка поверх навес макетка наворачивать midiинтерфейс все это коробочка стойка понятно современный эмулятор отличать слух реальный чип весьма сложно вообще возможно просто греть душа факт оно исполняться реальный железо срукожопеть самолично плюс дисплей стойка прикольно моргать  эдакий извращенный аудиофилия эволюционировать разумный форма жизнь плюс шанс рука занимать вечер главное забывать прослушивание саундтрек lyra ii чип пиво натирать межблочник компрессор продувать звук воздушный становиться протокол играть музыка нота нужно поддерживать различный midiсобытия тип note onnote off однако случай ay это несколько сложно  создание красивый тембр трекер манипулировать регистр несколько секунда это писать суть свой драйвер тембр таблица нота который сей день возникать холивар весь это проект хотеться чисто слушать готовый музыка демка игра мочь ограничиваться два действие  выставление тактовый частота запись регистр музыкальный сопроцессор посылать быть system exclusive sysex  сообщение являться суть сырой поток данный midiшине  мы попадаться первый подводный камень  midi байт являться статус тот тот note onoff иже они должный нулевой старший битый  начинать посмотреть  даташить  музыкальный сопроцессор убеждаться 4 бит мы хватить номер регистр  порт ab приспособлять чтонибудь еще вообще перехватывать запись чип использовать настройка прошивка  команда пока два взять бит запас оставаться бит  запихать старший бит значение регистр итог вписывать команда запись регистр байт  msb 6 5 4 3 2 1 lsb 0 запрещать  команда write pair 0b10  регистр msb значение 1 остальной бит значение например хотеть записывать регистр 1 значение fc пакет выглядеть f0  маркер начинать sysexсообщения a7  маркер это пакет наш формат стандарт midi указывать зарезервировать 43  0b10  5  0x1  1  0xfc  7                                   значение регистр старший бит                      номер регистр         константа команда write_pair 7c  оставаться бит значение регистр 0xfc  0x7f f7  маркер конец sysexсообщения очень удачно формат первый байт ложиться команда выставление частота тактовка сопроцессор msb 6 5 4 3 2 1 lsb 0 запрещать  команда set clock 0b11 msb байт 1 msb байт 2 msb байт 3 msb байт 4 признак acbstereo 1 первый байт частота uint32le msb 2 второй байт частота uint32le msb 3 третий байт частота uint32le msb 4 четвертый байт частота uint32le msb свободный бит добавлять флаг выбор альтернативный стереораскладка мой коллекция композиция abc acbстерео канал сопроцессор абсолютно идентичный менять место программный прошивка фидошный время песнето свыкаться мощный машина отвыкать всякий риск  взять легкий рука наваять все поначалу freertos мьютекс приоритет совершенно подумать 2048 байт оперативный память лежать основа платформа atmega328p такой вертеться слон посудный лавка  смотритсято красивомодномолодежный лишь легкий недостаток  работать  вдоволь насмотреться быстро мигать светодиод stack overflow медленно мигать out of memory решать все сделать простой тот портянка скрин выше становиться лаконичный void status_regi_notifyuint8_t regi uint8_t valu      ifregi  0xf return     register_dumpregi  valu   uint8_t status_regi_get_blockinguint8_t regi      uint8_t val   register_dumpregi     return val  рисовать остаток сова  писать остальной код заливать  работать делать балда midiфайл который зацикленно играть арпеджио три нота выводить комп  работать лагать безбожно частота обновление экран готовить салат асинхронный  потребоваться помиогурдор цымайон ез библиотека работа midi написать весьма сносно работа дисплей  хороший традиция ардуин библиотека сделать угодно один вещь выясняться библиотека liquidcrystal_i2c который изначально взять управление экран содержать куча задержка оставаться ее предок параллельный интерфейс убирать дисплей становиться инициализироваться нестабильный тормоз никуда уходить  разбирать родной библиотека wire часть внутри  провод  задержка поиск приводить библиотека  asynci2cmaster cskarai  который позволять асинхронно управлять i2cшиной однако просто заменять wire она сам библиотека liquidcrystal_i2c забивать очередь весьма быстро никакой средство контроль тайминг надеяться медленность свой код  подход особо хороший  поэтому делать эрзацкооперативный многозадачность поверх иметься код реализация простой  добавлять функция который цикл дергаться основной программа рядом функция опрос midiинтерфейса проверять флаг занятый выставлять брать следовать элемент очередь формат элемент очередь делать максимально компактный перерисовка экран заканчиваться память операция u8 send посыл байт либо wait задержка атрибут u16 минимальный время задержка мкс либо u8 байт отправка дисплей u8 режим отправка допы битовый маска библиотека liquidcrystal очередь вытаскивать элемент тип wait функция выставлять флаг занятый записывать текущий системный время переменный последующий дергание проверять превышать разница запрашивать время задержка оказываться элемент тип send запускать следующий конечный автомат который дергаться основной программа аналогичный образ делать далеко will_set_bus записывать полубайт i2cрегистр дисплей did_set_bus did_set_bus записывать самый значение включать битый en говорить дисплей считать шина did_en_high did_en_high сохранять значение системный таймер wait_en_low wait_en_low момент сохранение системный таймер проходить 2мкс отключать бит en отправлять значение i2cрегистр did_en_low did_en_low i2cрегистр обрабатывать наш запрос сохранять таймер wait_settle wait_settle условие проходить 50мкс время нужный дисплей обработка команда целиком  заканчивать отправлять первый полубайт флаг идти инициализация дисплей выключать поменять место половина байт очередь переходить снова  will_set_bus  противный случай отключать флаг ожидание следующий дерг основной функция мочь продолжать обрабатывать очередь пробовать  вуаль все шустро быстро куча выясняться конкретно мой дисплей шаг  will_set_bus  особо нужный разгон шина i2c 100 кгц 850 кгц переживать спокойно высоко   скоро слово этот описание понимать сложный поэтому   посмотреть код конвертер работать плеер  это толк музыка поэтому  написать модуль  который скармливать попарно запись регистр ay взамен выдавать описывать мы протокол sysexы куча note onoff 4 канал панель fd1 мигать клавиша пианино  поверх собирать два программа собственно конвертирование  формат psg записывать  zxtune  формат  vgm   появляться еще подводный камень  midi таймин",
    "tags": [
        "zx spectrum",
        "ay 3 8910",
        "ym2149f",
        "midi"
    ]
}